/*! For license information please see 99.js.LICENSE.txt */
(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[99],{2431:(e,t,n)=>{!function(){var e="undefined"!=typeof window?window:n.g,a={};for(var i in function(e,t,n){var a;function i(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},o=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof e&&e,"object"==typeof self&&self,"object"==typeof t&&t];for(var a=0;a<n.length;++a){var i=n[a];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var n=o;e=e.split(".");for(var a=0;a<e.length-1;a++){var i=e[a];if(!(i in n))break e;n=n[i]}(t=t(a=n[e=e[e.length-1]]))!=a&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function c(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function d(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:i(e)}}function l(e){if(!(e instanceof Array)){e=d(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}s("Symbol",function(e){function t(e,t){this.g=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+a++,i)}}),s("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var a=o[t[n]];"function"==typeof a&&"function"!=typeof a.prototype[e]&&r(a.prototype,e,{configurable:!0,writable:!0,value:function(){return c(i(this))}})}return e});var u,f="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var p;e:{var m={};try{m.__proto__={a:!0},p=m.a;break e}catch(e){}p=!1}u=p?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var _=u;function h(e,t){if(e.prototype=f(t.prototype),e.prototype.constructor=e,_)_(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var a=Object.getOwnPropertyDescriptor(t,n);a&&Object.defineProperty(e,n,a)}else e[n]=t[n];e.yh=t.prototype}function b(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.u=this.i=null}function g(e){if(e.o)throw new TypeError("Generator is already running");e.o=!0}function v(e,t){e.i={Ce:t,Je:!0},e.g=e.m||e.j}function y(e,t,n){return e.g=n,{value:t}}function S(e){e.g=0}function D(e,t,n){e.m=t,null!=n&&(e.j=n)}function I(e){e.m=0,e.j=2}function x(e,t){e.g=t,e.m=0}function C(e){e.m=0;var t=e.i.Ce;return e.i=null,t}function O(e){e.u=[e.i],e.m=0,e.j=0}function w(e,t){var n=e.u.splice(0)[0];(n=e.i=e.i||n)?n.Je?e.g=e.m||e.j:null!=n.A&&e.j<n.A?(e.g=n.A,e.i=null):e.g=e.j:e.g=t}function E(e){this.g=new b,this.h=e}function A(e,t,n,a){try{var i=t.call(e.g.l,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.o=!1,i;var r=i.value}catch(t){return e.g.l=null,v(e.g,t),L(e)}return e.g.l=null,a.call(e.g,r),L(e)}function L(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.o=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,v(e.g,t)}if(e.g.o=!1,e.g.i){if(t=e.g.i,e.g.i=null,t.Je)throw t.Ce;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function k(e){this.next=function(t){return g(e.g),e.g.l?t=A(e,e.g.l.next,t,e.g.s):(e.g.s(t),t=L(e)),t},this.throw=function(t){return g(e.g),e.g.l?t=A(e,e.g.l.throw,t,e.g.s):(v(e.g,t),t=L(e)),t},this.return=function(t){return function(e,t){g(e.g);var n=e.g.l;return n?A(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),L(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function M(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(a,i){!function e(r){r.done?a(r.value):Promise.resolve(r.value).then(t,n).then(e,i)}(e.next())})}(new k(new E(e)))}function P(){for(var e=Number(this),t=[],n=e;n<arguments.length;n++)t[n-e]=arguments[n];return t}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e,t,n){e instanceof String&&(e=String(e));for(var a=e.length,i=0;i<a;i++){var r=e[i];if(t.call(n,r,i,e))return{He:i,v:r}}return{He:-1,v:void 0}}function F(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}function H(e,t){e instanceof String&&(e+="");var n=0,a=!1,i={next:function(){if(!a&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return a=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}b.prototype.s=function(e){this.h=e},b.prototype.return=function(e){this.i={return:e},this.g=this.j},b.prototype.A=function(e){this.g=e},s("Promise",function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function a(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i(function(){t.l()})}this.g.push(e)};var i=o.setTimeout;n.prototype.i=function(e){i(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i(function(){throw e})},t.prototype.j=function(){function e(e){return function(a){n||(n=!0,e.call(t,a))}}var t=this,n=!1;return{resolve:e(this.F),reject:e(this.l)}},t.prototype.F=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.H(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.D(e):this.m(e)}},t.prototype.D=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.J(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.G(),this.u()},t.prototype.G=function(){var e=this;i(function(){if(e.B()){var t=o.console;void 0!==t&&t.error(e.i)}},1)},t.prototype.B=function(){if(this.o)return!1;var e=o.CustomEvent,t=o.Event,n=o.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)r.h(this.g[e]);this.g=null}};var r=new n;return t.prototype.H=function(e){var t=this.j();e.Lc(t.resolve,t.reject)},t.prototype.J=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function a(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){r(e)}}:t}var i,r,o=new t(function(e,t){i=e,r=t});return this.Lc(a(e,i),a(n,r)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Lc=function(e,t){function n(){switch(a.h){case 1:e(a.i);break;case 2:t(a.i);break;default:throw Error("Unexpected state: "+a.h)}}var a=this;null==this.g?r.h(n):this.g.push(n),this.o=!0},t.resolve=a,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var i=d(e),r=i.next();!r.done;r=i.next())a(r.value).Lc(t,n)})},t.all=function(e){var n=d(e),i=n.next();return i.done?a([]):new t(function(e,t){function r(t){return function(n){o[t]=n,0==--s&&e(o)}}var o=[],s=0;do{o.push(void 0),s++,a(i.value).Lc(r(o.length-1),t),i=n.next()}while(!i.done)})},t}),s("WeakMap",function(e){function t(e){if(this.g=(c+=Math.random()+1).toString(),e){e=d(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function a(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function i(e){if(!T(e,s)){var t=new n;r(e,s,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&i(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),a=new e([[t,2],[n,3]]);return 2==a.get(t)&&3==a.get(n)&&(a.delete(t),a.set(n,4),!a.has(t)&&4==a.get(n))}catch(e){return!1}}())return e;var s="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var c=0;return t.prototype.set=function(e,t){if(!a(e))throw Error("Invalid WeakMap key");if(i(e),!T(e,s))throw Error("WeakMap key fail: "+e);return e[s][this.g]=t,this},t.prototype.get=function(e){return a(e)&&T(e,s)?e[s][this.g]:void 0},t.prototype.has=function(e){return a(e)&&T(e,s)&&T(e[s],this.g)},t.prototype.delete=function(e){return!!(a(e)&&T(e,s)&&T(e[s],this.g))&&delete e[s][this.g]},t}),s("Map",function(e){function t(){var e={};return e.Qa=e.next=e.head=e}function n(e,t){var n=e.g;return c(function(){if(n){for(;n.head!=e.g;)n=n.Qa;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}})}function a(e,t){var n=t&&typeof t;"object"==n||"function"==n?r.has(t)?n=r.get(t):(n=""+ ++o,r.set(t,n)):n="p_"+t;var a=e.h[n];if(a&&T(e.h,n))for(e=0;e<a.length;e++){var i=a[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:a,index:e,fa:i}}return{id:n,list:a,index:-1,fa:void 0}}function i(e){if(this.h={},this.g=t(),this.size=0,e){e=d(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var a=n.entries(),i=a.next();return!i.done&&i.value[0]==t&&"s"==i.value[1]&&!((i=a.next()).done||4!=i.value[0].x||"t"!=i.value[1]||!a.next().done)}catch(e){return!1}}())return e;var r=new WeakMap;i.prototype.set=function(e,t){var n=a(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.fa?n.fa.value=t:(n.fa={next:this.g,Qa:this.g.Qa,head:this.g,key:e,value:t},n.list.push(n.fa),this.g.Qa.next=n.fa,this.g.Qa=n.fa,this.size++),this},i.prototype.delete=function(e){return!(!(e=a(this,e)).fa||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.fa.Qa.next=e.fa.next,e.fa.next.Qa=e.fa.Qa,e.fa.head=null,this.size--,0))},i.prototype.clear=function(){this.h={},this.g=this.g.Qa=t(),this.size=0},i.prototype.has=function(e){return!!a(this,e).fa},i.prototype.get=function(e){return(e=a(this,e).fa)&&e.value},i.prototype.entries=function(){return n(this,function(e){return[e.key,e.value]})},i.prototype.keys=function(){return n(this,function(e){return e.key})},i.prototype.values=function(){return n(this,function(e){return e.value})},i.prototype.forEach=function(e,t){for(var n,a=this.entries();!(n=a.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},i.prototype[Symbol.iterator]=i.prototype.entries;var o=0;return i}),s("Set",function(e){function t(e){if(this.g=new Map,e){e=d(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(d([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var a=n.entries(),i=a.next();return!i.done&&i.value[0]==t&&i.value[1]==t&&!(i=a.next()).done&&i.value[0]!=t&&4==i.value[0].x&&i.value[1]==i.value[0]&&a.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach(function(a){return e.call(t,a,a,n)})},t)}),s("Array.prototype.findIndex",function(e){return e||function(e,t){return U(this,e,t).He}}),s("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),s("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var a=n.length;for(0>(t=t||0)&&(t=Math.max(t+a,0));t<a;t++){var i=n[t];if(i===e||Object.is(i,e))return!0}return!1}}),s("String.prototype.includes",function(e){return e||function(e,t){return-1!==F(this,e,"includes").indexOf(e,t||0)}}),s("Array.prototype.find",function(e){return e||function(e,t){return U(this,e,t).v}}),s("String.prototype.startsWith",function(e){return e||function(e,t){var n=F(this,e,"startsWith"),a=n.length,i=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var r=0;r<i&&t<a;)if(n[t++]!=e[r++])return!1;return r>=i}}),s("Array.prototype.keys",function(e){return e||function(){return H(this,function(e){return e})}});var R="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var a=arguments[n];if(a)for(var i in a)T(a,i)&&(e[i]=a[i])}return e};s("Object.assign",function(e){return e||R}),s("Array.from",function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var a=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var r=0;!(i=e.next()).done;)a.push(t.call(n,i.value,r++))}else for(i=e.length,r=0;r<i;r++)a.push(t.call(n,e[r],r));return a}}),s("Array.prototype.values",function(e){return e||function(){return H(this,function(e,t){return t})}}),s("Promise.prototype.finally",function(e){return e||function(e){return this.then(function(t){return Promise.resolve(e()).then(function(){return t})},function(t){return Promise.resolve(e()).then(function(){throw t})})}}),s("Array.prototype.entries",function(e){return e||function(){return H(this,function(e,t){return[e,t]})}}),s("String.prototype.repeat",function(e){return e||function(e){var t=F(this,null,"repeat");if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)1&e&&(n+=t),(e>>>=1)&&(t+=t);return n}}),s("Number.isNaN",function(e){return e||function(e){return"number"==typeof e&&isNaN(e)}}),s("Object.values",function(e){return e||function(e){var t,n=[];for(t in e)T(e,t)&&n.push(e[t]);return n}}),s("Math.log2",function(e){return e||function(e){return Math.log(e)/Math.LN2}}),s("Math.trunc",function(e){return e||function(e){if(e=Number(e),isNaN(e)||1/0===e||-1/0===e||0===e)return e;var t=Math.floor(Math.abs(e));return 0>e?-t:t}}),s("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)T(e,t)&&n.push([t,e[t]]);return n}});var N=this||self;function B(e,t){e=e.split(".");var n,a=N;e[0]in a||void 0===a.execScript||a.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?a=a[n]&&a[n]!==Object.prototype[n]?a[n]:a[n]={}:a[n]=t}function j(e){this.g=Math.exp(Math.log(.5)/e),this.i=this.h=0}function V(e){return e.h/(1-Math.pow(e.g,e.i))}function z(){this.h=new j(2),this.j=new j(5),this.g=0,this.i=128e3,this.l=16e3}function G(){}function K(){}function W(){}function q(e){var t=P.apply(1,arguments);Y.has(e)||(Y.add(e),W.apply(G,l(t)))}function Q(){}j.prototype.sample=function(e,t){var n=Math.pow(this.g,e);t=t*(1-n)+n*this.h,isNaN(t)||(this.h=t,this.i+=e)},z.prototype.configure=function(e){this.i=e.minTotalBytes,this.l=e.minBytes,this.h.g=Math.exp(Math.log(.5)/e.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/e.slowHalfLife)},z.prototype.sample=function(e,t){if(!(t<this.l)){var n=8e3*t/e;e/=1e3,this.g+=t,this.h.sample(e,n),this.j.sample(e,n)}},z.prototype.getBandwidthEstimate=function(e){return this.g<this.i?e:Math.min(V(this.h),V(this.j))};var Y=new Set;if(e.console&&e.console.log.bind){var J={},X=(J[1]=console.error.bind(console),J[2]=console.warn.bind(console),J[3]=console.info.bind(console),J[4]=console.log.bind(console),J[5]=console.debug.bind(console),J[6]=console.debug.bind(console),J);W=X[2],K=X[1]}function Z(e){if($.has(e))return $.get(e);var t=MediaSource.isTypeSupported(e);return $.set(e,t),t}var $=new Map;function ee(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function te(e,t){-1<(t=e.indexOf(t))&&e.splice(t,1)}function ne(e,t,n){if(n||(n=ee),e.length!=t.length)return!1;t=t.slice();for(var a={},i=(e=d(e)).next();!i.done;a={nd:a.nd},i=e.next()){if(a.nd=i.value,-1==(i=t.findIndex(function(e){return function(t){return n(e.nd,t)}}(a))))return!1;t[i]=t[t.length-1],t.pop()}return 0==t.length}function ae(e,t,n){if(n||(n=ee),e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(!n(e[a],t[a]))return!1;return!0}function ie(e,t,n){this.startTime=e,this.direction=ue,this.endTime=t,this.payload=n,this.region=new Se,this.position=null,this.positionAlign=oe,this.size=0,this.textAlign=se,this.writingMode=fe,this.lineInterpretation=pe,this.line=null,this.lineHeight="",this.lineAlign=me,this.displayAlign=de,this.fontSize=this.textStrokeWidth=this.textStrokeColor=this.textShadow=this.border=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=ge,this.fontStyle=ve,this.linePadding=this.letterSpacing=this.fontFamily="",this.opacity=1,this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.lineBreak=this.isContainer=!1,this.cellResolution={columns:32,rows:15}}function re(e,t){if(e.startTime!=t.startTime||e.endTime!=t.endTime||e.payload!=t.payload)return!1;for(var n in e)if("startTime"!=n&&"endTime"!=n&&"payload"!=n)if("nestedCues"==n){if(!ae(e.nestedCues,t.nestedCues,re))return!1}else if("region"==n||"cellResolution"==n){for(var a in e[n])if(e[n][a]!=t[n][a])return!1}else if(Array.isArray(e[n])){if(!ae(e[n],t[n]))return!1}else if(e[n]!=t[n])return!1;return!0}ie.prototype.clone=function(){var e,t=new ie(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t},B("shaka.text.Cue",ie);var oe="auto";ie.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:oe};var se="center",ce={LEFT:"left",RIGHT:"right",CENTER:se,START:"start",END:"end"};ie.textAlign=ce;var de="after",le={BEFORE:"before",CENTER:"center",AFTER:de};ie.displayAlign=le;var ue="ltr";ie.direction={HORIZONTAL_LEFT_TO_RIGHT:ue,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var fe="horizontal-tb";ie.writingMode={HORIZONTAL_TOP_TO_BOTTOM:fe,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var pe=0;ie.lineInterpretation={LINE_NUMBER:pe,PERCENTAGE:1};var me="start",_e={CENTER:"center",START:me,END:"end"};ie.lineAlign=_e;var he={white:"#FFF",lime:"#0F0",cyan:"#0FF",red:"#F00",yellow:"#FF0",magenta:"#F0F",blue:"#00F",black:"#000"};ie.defaultTextColor=he;var be={bg_white:"#FFF",bg_lime:"#0F0",bg_cyan:"#0FF",bg_red:"#F00",bg_yellow:"#FF0",bg_magenta:"#F0F",bg_blue:"#00F",bg_black:"#000"};ie.defaultTextBackgroundColor=be;var ge=400;ie.fontWeight={NORMAL:ge,BOLD:700};var ve="normal",ye={NORMAL:ve,ITALIC:"italic",OBLIQUE:"oblique"};function Se(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=De,this.scroll=Ie}ie.fontStyle=ye,ie.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},B("shaka.text.CueRegion",Se);var De=1;Se.units={PX:0,PERCENTAGE:De,LINES:2};var Ie="";function xe(){}function Ce(e,t){if(!e&&!t)return!0;if(!e||!t||e.byteLength!=t.byteLength)return!1;if(Oe(e)==Oe(t)&&(e.byteOffset||0)==(t.byteOffset||0))return!0;var n=Ee(e);t=Ee(t);for(var a=0;a<e.byteLength;a++)if(n[a]!=t[a])return!1;return!0}function Oe(e){return e instanceof ArrayBuffer?e:e.buffer}function we(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}function Ee(e,t,n){return Le(e,void 0===t?0:t,n=void 0===n?1/0:n,Uint8Array)}function Ae(e,t,n){return Le(e,void 0===t?0:t,n=void 0===n?1/0:n,DataView)}function Le(e,t,n,a){var i=(e.byteOffset||0)+e.byteLength;return t=Math.max(0,Math.min((e.byteOffset||0)+t,i)),new a(Oe(e),t,Math.min(t+Math.max(n,0),i)-t)}function ke(e,t,n){var a=P.apply(3,arguments);this.severity=e,this.category=t,this.code=n,this.data=a,this.handled=!1}Se.scrollMode={NONE:Ie,UP:"up"},B("shaka.util.BufferUtils",xe),xe.toDataView=Ae,xe.toUint8=Ee,xe.toArrayBuffer=we,xe.equal=Ce,ke.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},B("shaka.util.Error",ke),ke.Severity={RECOVERABLE:1,CRITICAL:2},ke.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},ke.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_SRC_EQUALS:2016,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,HLS_AES_128_INVALID_IV_LENGTH:4043,HLS_AES_128_INVALID_KEY_LENGTH:4044,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004};var Me=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function Pe(e){var t;e instanceof Pe?(Te(this,e.Ea),this.rb=e.rb,this.Ga=e.Ga,Ue(this,e.Kb),this.ra=e.ra,Fe(this,e.g.clone()),this.gb=e.gb):e&&(t=String(e).match(Me))?(Te(this,t[1]||"",!0),this.rb=He(t[2]||""),this.Ga=He(t[3]||"",!0),Ue(this,t[4]),this.ra=He(t[5]||"",!0),Fe(this,t[6]||"",!0),this.gb=He(t[7]||"")):this.g=new Ke(null)}function Te(e,t,n){e.Ea=n?He(t,!0):t,e.Ea&&(e.Ea=e.Ea.replace(/:$/,""))}function Ue(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Kb=t}else e.Kb=null}function Fe(e,t,n){t instanceof Ke?e.g=t:(n||(t=Re(t,ze)),e.g=new Ke(t))}function He(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function Re(e,t,n){return null!=e?(e=encodeURI(e).replace(t,Ne),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ne(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(a=Pe.prototype).Ea="",a.rb="",a.Ga="",a.Kb=null,a.ra="",a.gb="",a.toString=function(){var e=[],t=this.Ea;if(t&&e.push(Re(t,Be,!0),":"),t=this.Ga){e.push("//");var n=this.rb;n&&e.push(Re(n,Be,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Kb)&&e.push(":",String(t))}return(t=this.ra)&&(this.Ga&&"/"!=t.charAt(0)&&e.push("/"),e.push(Re(t,"/"==t.charAt(0)?Ve:je,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.gb)&&e.push("#",Re(t,Ge)),e.join("")},a.resolve=function(e){var t=this.clone();"data"===t.Ea&&(t=new Pe);var n=!!e.Ea;n?Te(t,e.Ea):n=!!e.rb,n?t.rb=e.rb:n=!!e.Ga,n?t.Ga=e.Ga:n=null!=e.Kb;var a=e.ra;if(n)Ue(t,e.Kb);else if(n=!!e.ra){if("/"!=a.charAt(0))if(this.Ga&&!this.ra)a="/"+a;else{var i=t.ra.lastIndexOf("/");-1!=i&&(a=t.ra.substr(0,i+1)+a)}if(".."==a||"."==a)a="";else if(-1!=a.indexOf("./")||-1!=a.indexOf("/.")){i=0==a.lastIndexOf("/",0),a=a.split("/");for(var r=[],o=0;o<a.length;){var s=a[o++];"."==s?i&&o==a.length&&r.push(""):".."==s?((1<r.length||1==r.length&&""!=r[0])&&r.pop(),i&&o==a.length&&r.push("")):(r.push(s),i=!0)}a=r.join("/")}}return n?t.ra=a:n=""!==e.g.toString(),n?Fe(t,e.g.clone()):n=!!e.gb,n&&(t.gb=e.gb),t},a.clone=function(){return new Pe(this)};var Be=/[#\/\?@]/g,je=/[#\?:]/g,Ve=/[#\?]/g,ze=/[#\?@]/g,Ge=/#/g;function Ke(e){this.g=e||null}function We(e){if(!e.la&&(e.la={},e.Oc=0,e.g))for(var t=e.g.split("&"),n=0;n<t.length;n++){var a=t[n].indexOf("="),i=null;if(0<=a){var r=t[n].substring(0,a);i=t[n].substring(a+1)}else r=t[n];r=decodeURIComponent(r.replace(/\+/g," ")),i=i||"",e.add(r,decodeURIComponent(i.replace(/\+/g," ")))}}function qe(e,t){return e.concat(t)}function Qe(){}function Ye(e){return null!=e}function Je(e,t){if(0==t.length)return e;var n=t.map(function(e){return new Pe(e)});return e.map(function(e){return new Pe(e)}).map(function(e){return n.map(function(t){return e.resolve(t)})}).reduce(qe,[]).map(function(e){return e.toString()})}function Xe(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:t||[],keyIds:new Set}}function Ze(e,t){if(1==t.length)return t[0];if(null!=(e=$e(e,t)))return e;throw new ke(2,4,4025,t)}function $e(e,t){for(var n=d(nt[e]),a=n.next();!a.done;a=n.next()){a=a.value;for(var i=d(t),r=i.next();!r.done;r=i.next())if(r=r.value,a.test(r.trim()))return r.trim()}return e==et?"":null}(a=Ke.prototype).la=null,a.Oc=null,a.add=function(e,t){We(this),this.g=null;var n=this.la.hasOwnProperty(e)?this.la[e]:null;return n||(this.la[e]=n=[]),n.push(t),this.Oc++,this},a.set=function(e,t){return We(this),this.g=null,this.la.hasOwnProperty(e)?this.la[e]=[t]:this.add(e,t),this},a.toString=function(){if(this.g)return this.g;if(!this.la)return"";var e,t=[];for(e in this.la)for(var n=encodeURIComponent(e),a=this.la[e],i=0;i<a.length;i++){var r=n;""!==a[i]&&(r+="="+encodeURIComponent(a[i])),t.push(r)}return this.g=t.join("&")},a.clone=function(){var e=new Ke;if(e.g=this.g,this.la){var t,n={};for(t in this.la)n[t]=this.la[t].concat();e.la=n,e.Oc=this.Oc}return e};var et="text",tt={wa:"video",Hc:"audio",Z:et,Wb:"image",Fg:"application"},nt={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cx]$/,/^[du]dts$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av01/,/^dvhe/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function at(){var e,t,n=new Promise(function(n,a){e=n,t=a});return n.resolve=e,n.reject=t,n}function it(e){this.h=e,this.g=void 0}function rt(e){this.h=e,this.g=null}function ot(e){this.h=e,this.g=null}function st(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function ct(e){return""!=ht().canPlayType(e)}function dt(){return _t("Xbox One")}function lt(){return _t("Tizen")}function ut(){return _t("Web0S")&&_t("Chrome/38.0.2125.122 Safari/537.36")}function ft(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!lt()&&!_t("PC=EOS")&&!_t("VirginMedia")&&!pt()&&!_t("AFT")}function pt(){return _t("PlayStation 4")}function mt(){if(!ft())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function _t(e){return(navigator.userAgent||"").includes(e)}function ht(){return gt||(bt||(bt=new ot(function(){gt=null})),(gt=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(gt=document.createElement("video")),bt.N(1),gt)}at.prototype.resolve=function(){},at.prototype.reject=function(){},it.prototype.value=function(){return null==this.g&&(this.g=this.h()),this.g},rt.prototype.N=function(t){var n=this;this.stop();var a=!0,i=null;return this.g=function(){e.clearTimeout(i),a=!1},i=e.setTimeout(function(){a&&n.h()},1e3*t),this},rt.prototype.stop=function(){this.g&&(this.g(),this.g=null)},ot.prototype.Mb=function(){return this.stop(),this.h(),this},ot.prototype.N=function(e){var t=this;return this.stop(),this.g=new rt(function(){t.h()}).N(e),this},ot.prototype.Ca=function(e){var t=this;return this.stop(),this.g=new rt(function(){t.g.N(e),t.h()}).N(e),this},ot.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},B("shaka.util.Timer",ot),ot.prototype.stop=ot.prototype.stop,ot.prototype.tickEvery=ot.prototype.Ca,ot.prototype.tickAfter=ot.prototype.N,ot.prototype.tickNow=ot.prototype.Mb;var bt=null,gt=null;function vt(){}function yt(t){if(!t)return"";if(239==(t=Ee(t))[0]&&187==t[1]&&191==t[2]&&(t=t.subarray(3)),e.TextDecoder&&!pt())return(t=(new TextDecoder).decode(t)).includes("�")&&K('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),t;for(var n="",a=0;a<t.length;++a){var i=65533;if(0==(128&t[a])?i=t[a]:t.length>=a+2&&192==(224&t[a])&&128==(192&t[a+1])?(i=(31&t[a])<<6|63&t[a+1],a+=1):t.length>=a+3&&224==(240&t[a])&&128==(192&t[a+1])&&128==(192&t[a+2])?(i=(15&t[a])<<12|(63&t[a+1])<<6|63&t[a+2],a+=2):t.length>=a+4&&240==(241&t[a])&&128==(192&t[a+1])&&128==(192&t[a+2])&&128==(192&t[a+3])&&(i=(7&t[a])<<18|(63&t[a+1])<<12|(63&t[a+2])<<6|63&t[a+3],a+=3),65535>=i)n+=String.fromCharCode(i);else{var r=1023&(i-=65536);n+=String.fromCharCode(55296+(i>>10)),n+=String.fromCharCode(56320+r)}}return n}function St(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw new ke(2,2,2004);n=Math.floor(e.byteLength/2);var a=new Uint16Array(n);e=Ae(e);for(var i=0;i<n;i++)a[i]=e.getUint16(2*i,t);return Ct.value()(a)}function Dt(e){function t(e){return n.byteLength<=e||32<=n[e]&&126>=n[e]}if(!e)return"";var n=Ee(e);if(239==n[0]&&187==n[1]&&191==n[2])return yt(n);if(254==n[0]&&255==n[1])return St(n.subarray(2),!1);if(255==n[0]&&254==n[1])return St(n.subarray(2),!0);if(0==n[0]&&0==n[2])return St(e,!1);if(0==n[1]&&0==n[3])return St(e,!0);if(t(0)&&t(1)&&t(2)&&t(3))return yt(e);throw new ke(2,2,2003)}function It(t){if(e.TextEncoder&&!pt()){var n=new TextEncoder;return we(n.encode(t))}t=encodeURIComponent(t),t=unescape(t),n=new Uint8Array(t.length);for(var a=0;a<t.length;a++)n[a]=t[a].charCodeAt(0);return we(n)}function xt(e,t){for(var n=new ArrayBuffer(2*e.length),a=new DataView(n),i=0;i<e.length;++i)a.setUint16(2*i,e.charCodeAt(i),t);return n}B("shaka.util.StringUtils",vt),vt.resetFromCharCode=function(){Ct.g=void 0},vt.toUTF16=xt,vt.toUTF8=It,vt.fromBytesAutoDetect=Dt,vt.fromUTF16=St,vt.fromUTF8=yt;var Ct=new it(function(){function e(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}}for(var t={Ua:65536};0<t.Ua;(t={Ua:t.Ua}).Ua/=2)if(e(t.Ua))return function(e){return function(t){for(var n="",a=0;a<t.length;a+=e.Ua)n+=String.fromCharCode.apply(null,t.subarray(a,a+e.Ua));return n}}(t);return null});function Ot(){}function wt(e){return e=Ee(e),e=Ct.value()(e),btoa(e)}function Et(e,t){return t=t??!0,e=wt(e).replace(/\+/g,"-").replace(/\//g,"_"),t?e:e.replace(/[=]*$/,"")}function At(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),a=0;a<t.length;++a)n[a]=t.charCodeAt(a);return n}function Lt(t){for(var n=t.length/2,a=new Uint8Array(n),i=0;i<n;i++)a[i]=e.parseInt(t.substr(2*i,2),16);return a}function kt(e){var t=Ee(e);e="";for(var n=(t=d(t)).next();!n.done;n=t.next())1==(n=(n=n.value).toString(16)).length&&(n="0"+n),e+=n;return e}function Mt(){for(var e=P.apply(0,arguments),t=0,n=d(e),a=n.next();!a.done;a=n.next())t+=a.value.byteLength;for(t=new Uint8Array(t),n=0,a=(e=d(e)).next();!a.done;a=e.next())a=a.value,t.set(Ee(a),n),n+=a.byteLength;return t}function Pt(){}B("shaka.util.Uint8ArrayUtils",Ot),Ot.concat=Mt,Ot.toHex=kt,Ot.fromHex=Lt,Ot.fromBase64=At,Ot.toBase64=Et,Ot.toStandardBase64=wt,B("shaka.dependencies",Pt),Pt.has=function(e){return Ut.has(e)},Pt.add=function(e,t){if(!Tt[e])throw Error(e+" is not supported");Ut.set(e,function(){return t})};var Tt={muxjs:"muxjs"};Pt.Allowed=Tt;var Ut=new Map([["muxjs",function(){return e.muxjs}]]);function Ft(e){var t=this;this.o=e,this.m=Ut.get("muxjs")(),this.g=new this.m.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.h=null,this.l=[],this.i=[],this.j=!1,this.g.on("data",function(e){t.i=e.captions,t.l.push(Mt(e.initSegment,e.data))}),this.g.on("done",function(){var e={data:Mt.apply(Ot,l(t.l)),captions:t.i};t.h.resolve(e),t.j=!1})}function Ht(e,t){var n=Rt(e),a="audio/aac"==e.toLowerCase().split(";")[0];return!(!Ut.get("muxjs")()||!n&&!a)&&(a?Z('audio/mp4; codecs="mp4a.40.2"'):t?Z(Bt(t,e)):(t=Bt("audio",e),e=Bt("video",e),Z(t)||Z(e)))}function Rt(e){return"mp2t"==e.toLowerCase().split(";")[0].split("/")[1]}function Nt(e,t){return"audio/aac"==t.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp4a.40.2"':Rt(t)?Bt(e,t):t}function Bt(e,t){if(t=t.replace(/mp2t/i,"mp4"),"audio"==e&&(t=t.replace("video","audio")),e=/avc1\.(66|77|100)\.(\d+)/.exec(t)){var n="avc1.",a=e[1],i=Number(e[2]);n=("66"==a?n+"4200":"77"==a?n+"4d00":n+"6400")+(i>>4).toString(16),n+=(15&i).toString(16),t=t.replace(e[0],n)}return t}function jt(){}function Vt(e,t){return t&&(e+='; codecs="'+t+'"'),e}function zt(e,t,n){return Ht(e=Vt(e,t),n)?Nt(n,e):"audio"==n?e.replace("video","audio"):e}function Gt(e){var t=Wt(e);switch(e=t[0],t=t[1].toLowerCase(),!0){case"mp4a"===e&&"69"===t:case"mp4a"===e&&"6b"===t:return"mp3";case"mp4a"===e&&"66"===t:case"mp4a"===e&&"67"===t:case"mp4a"===e&&"68"===t:case"mp4a"===e&&"40.2"===t:case"mp4a"===e&&"40.02"===t:case"mp4a"===e&&"40.5"===t:case"mp4a"===e&&"40.05"===t:case"mp4a"===e&&"40.29"===t:case"mp4a"===e&&"40.42"===t:return"aac";case"mp4a"===e&&"a5"===t:return"ac-3";case"mp4a"===e&&"a6"===t:return"ec-3";case"mp4a"===e&&"b2"===t:return"dtsx";case"mp4a"===e&&"a9"===t:return"dtsc";case"avc1"===e:case"avc3"===e:return"avc";case"hvc1"===e:case"hev1"===e:return"hevc";case"dvh1"===e:case"dvhe"===e:return"dovi"}return e}function Kt(e){return(e=e.split(/ *; */)).shift(),(e=e.find(function(e){return e.startsWith("codecs=")}))?e.split("=")[1].replace(/^"|"$/g,""):""}function Wt(e){var t=(e=e.split("."))[0];return e.shift(),[t,e.join(".")]}function qt(e){this.j=null,this.i=e,this.u=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.B="",this.o=new Map}function Qt(e){return!(!Zt[e]&&"application/cea-608"!=e&&"application/cea-708"!=e)}function Yt(e,t,n){if(e.B=t,t=e.o.get(t))for(var a=d(t.keys()),i=a.next();!i.done;i=a.next())(i=t.get(i.value).filter(function(e){return e.endTime<=n}))&&e.i.append(i)}function Jt(e,t,n){t.startTime+=n,t.endTime+=n;for(var a=(t=d(t.nestedCues)).next();!a.done;a=t.next())Jt(e,a.value,n)}function Xt(e,t,n,a,i){for(var r=n+" "+a,o=new Map,s=(t=d(t)).next();!s.done;s=t.next()){var c=s.value;s=c.stream,c=c.cue,o.has(s)||o.set(s,new Map),o.get(s).has(r)||o.get(s).set(r,[]),Jt(e,c,i),c.startTime>=e.l&&c.startTime<e.m&&(o.get(s).get(r).push(c),s==e.B&&e.i.append([c]))}for(r=(i=d(o.keys())).next();!r.done;r=i.next())for(r=r.value,e.o.has(r)||e.o.set(r,new Map),s=(t=d(o.get(r).keys())).next();!s.done;s=t.next())s=s.value,c=o.get(r).get(s),e.o.get(r).set(s,c);e.g=null==e.g?Math.max(n,e.l):Math.min(e.g,Math.max(n,e.l)),e.h=Math.max(e.h,Math.min(a,e.m))}Ft.prototype.destroy=function(){return this.g.dispose(),this.g=null,Promise.resolve()},B("shaka.util.MimeUtils",jt),jt.getFullType=Vt,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels"),qt.prototype.destroy=function(){return this.i=this.j=null,this.o.clear(),Promise.resolve()},qt.prototype.remove=function(e,t){var n=this;return M(function(a){if(1==a.g)return y(a,Promise.resolve(),2);!n.i||!n.i.remove(e,t)||null==n.g||t<=n.g||e>=n.h||(e<=n.g&&t>=n.h?n.g=n.h=null:e<=n.g&&t<n.h?n.g=t:e>n.g&&t>=n.h&&(n.h=e)),S(a)})},B("shaka.text.TextEngine",qt),qt.prototype.destroy=qt.prototype.destroy,qt.findParser=function(e){return Zt[e]},qt.unregisterParser=function(e){delete Zt[e]},qt.registerParser=function(e,t){Zt[e]=t};var Zt={};function $t(){}function en(e,t){return e=an(e),t=an(t),e.split("-")[0]==t.split("-")[0]}function tn(e,t){return e=an(e),t=an(t),e=e.split("-"),t=t.split("-"),e[0]==t[0]&&1==e.length&&2==t.length}function nn(e,t){return e=an(e),t=an(t),e=e.split("-"),t=t.split("-"),2==e.length&&2==t.length&&e[0]==t[0]}function an(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=dn.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function rn(e,t){return e=an(e),(t=an(t))==e?4:tn(t,e)?3:nn(t,e)?2:tn(e,t)?1:0}function on(e){var t=e.indexOf("-");return e=(e=0<=t?e.substring(0,t):e).toLowerCase(),dn.get(e)||e}function sn(e){return e.language?an(e.language):e.audio&&e.audio.language?an(e.audio.language):e.video&&e.video.language?an(e.video.language):"und"}function cn(e,t){e=an(e);var n=new Set,a=d(t);for(t=a.next();!t.done;t=a.next())n.add(an(t.value));for(t=(a=d(n)).next();!t.done;t=a.next())if((t=t.value)==e)return t;for(t=(a=d(n)).next();!t.done;t=a.next())if(tn(t=t.value,e))return t;for(t=(a=d(n)).next();!t.done;t=a.next())if(nn(t=t.value,e))return t;for(t=(n=d(n)).next();!t.done;t=n.next())if(tn(e,t=t.value))return t;return null}B("shaka.util.LanguageUtils",$t),$t.findClosestLocale=cn,$t.getLocaleForVariant=sn,$t.getLocaleForText=function(e){return an(e.language||"und")},$t.getBase=on,$t.relatedness=rn,$t.areSiblings=function(e,t){var n=on(e),a=on(t);return e!=n&&t!=a&&n==a},$t.normalize=an,$t.isSiblingOf=nn,$t.isParentOf=tn,$t.areLanguageCompatible=en,$t.areLocaleCompatible=function(e,t){return(e=an(e))==an(t)};var dn=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ln(){this.g={}}function un(e,t,n,a,i){var r=e.variants;(t.length||n.length)&&(r=function(e,t,n){for(var a={},i=(t=d(t)).next();!i.done;a={yd:a.yd},i=t.next())if(a.yd=i.value,i=e.filter(function(e){return function(t){return t.video&&t.video.codecs.startsWith(e.yd)}}(a)),i.length){e=i;break}for(a={},t=(n=d(n)).next();!t.done;a={kd:a.kd},t=n.next())if(a.kd=t.value,t=e.filter(function(e){return function(t){return t.audio&&t.audio.codecs.startsWith(e.kd)}}(a)),t.length){e=t;break}return e}(r,t,n)),t=function(e){for(var t=new ln,n=(e=d(e)).next();!n.done;n=e.next()){var a=pn(n=n.value);t.push(a,n)}return t}(r=kn(r,a)),t=function(e){var t=0,n=new Map,a=e.size();return e.forEach(function(e,i){for(var r=(i=d(i)).next();!r.done;r=i.next()){var o=(r=r.value).video;if(o&&o.width&&o.height){o=o.width*o.height*(o.frameRate||1),n.has(o)||n.set(o,new ln);var s=n.get(o);s.push(e,r),s.size()===a&&(t=Math.max(t,o))}}}),t?n.get(t):e}(t);var o=function(e,t){for(var n=(t=d(t)).next();!n.done;n=t.next())if((n=n.value)==Hn||n==Rn){if(1==(e=fn(e,n)).size())return e.keys()[0]}else if(n==Nn)break;return function(e){var t="",n=1/0;return e.forEach(function(e,a){for(var i=0,r=0,o=(a=d(a)).next();!o.done;o=a.next())i+=o.value.bandwidth||0,++r;(i/=r)<n&&(t=e,n=i)}),t}(e)}(t,i);e.variants=e.variants.filter(function(e){return pn(e)==o})}function fn(e,t){var n=0,a=new ln;return e.forEach(function(e,i){for(var r=0,o=0,s=d(i),c=s.next();!c.done;c=s.next())(c=c.value).decodingInfos.length&&(r+=c.decodingInfos[0][t]?1:0,o++);(r/=o)>n?(a.g={},a.push(e,i),n=r):r==n&&a.push(e,i)}),a}function pn(e){var t="";e.video&&(t=Gt(e.video.codecs));var n="";return e.audio&&(n=Gt(e.audio.codecs)),t+"-"+n}function mn(e,t,n){function a(e,t,n){return e>=t&&e<=n}var i=e.video;if(0!=e.disabledUntilTime){if(e.disabledUntilTime>Date.now()/1e3)return!1;e.disabledUntilTime=0}return!(i&&i.width&&i.height&&(!a(i.width,t.minWidth,Math.min(t.maxWidth,n.width))||!a(i.height,t.minHeight,Math.min(t.maxHeight,n.height))||!a(i.width*i.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!a(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!a(e.bandwidth,t.minBandwidth,t.maxBandwidth))}function _n(e,t,n){for(var a=!1,i=(e=d(e)).next();!i.done;i=e.next()){var r=(i=i.value).allowedByApplication;i.allowedByApplication=mn(i,t,n),r!=i.allowedByApplication&&(a=!0)}return a}function hn(e,t){return M(function(n){if(1==n.g)return y(n,bn(e.variants,t,!1),2);e.variants=e.variants.filter(function(e){var t=e.video;if(t){var n=yn(t.codecs);if(t.codecs.includes(",")){var a=t.codecs.split(",");if(n=yn(n=Ze("video",a)),a=vn(a=Ze("audio",a)),!Z(a=zt(t.mimeType,a,"audio")))return!1}if(!Z(n=zt(t.mimeType,n,"video")))return!1}return!((n=e.audio)&&(a=vn(n.codecs),!Z(n=zt(n.mimeType,a,"audio"))))&&(dt()&&t&&(t.width&&1920<t.width||t.height&&1080<t.height)&&(t.codecs.includes("avc1.")||t.codecs.includes("avc3."))?(Tn(e),!1):((t=e.decodingInfos.some(function(e){return e.supported}))||Tn(e),t))}),S(n)})}function bn(e,t,n){var a,i,r,o,s,c,l,u,f,p;return M(function(m){if(e.some(function(e){return e.decodingInfos.length}))return m.return();for(a=navigator.mediaCapabilities,i=[],r=function(e,t){var n;return M(function(i){return 1==i.g?(D(i,2),y(i,a.decodingInfo(t),4)):2!=i.g?(n=i.h,e.decodingInfos.push(n),x(i,0)):(C(i),JSON.stringify(t),void S(i))})},o=d(e),s=o.next();!s.done;s=o.next())for(c=s.value,l=gn(c,t,n),u=d(l),f=u.next();!f.done;f=u.next())p=f.value,i.push(r(c,p));return y(m,Promise.all(i),0)})}function gn(e,t,n){var a=e.audio,i=e.video;if(n={type:n?"file":"media-source"},i){var r=i.codecs;if(i.codecs.includes(",")){var o=i.codecs.split(",");r=yn(r=Ze("video",o)),o=Ze("audio",o),o=zt(i.mimeType,o,"audio"),n.audio={contentType:o,channels:2,bitrate:e.bandwidth||1,samplerate:1,spatialRendering:!1}}if(r=yn(r),r=zt(i.mimeType,r,"video"),n.video={contentType:r,width:i.width||64,height:i.height||64,bitrate:i.bandwidth||e.bandwidth||1,framerate:i.frameRate||1},i.hdr)switch(i.hdr){case"SDR":n.video.transferFunction="srgb";break;case"PQ":n.video.transferFunction="pq";break;case"HLG":n.video.transferFunction="hlg"}}if(a&&(r=vn(a.codecs),r=zt(a.mimeType,r,"audio"),n.audio={contentType:r,channels:a.channelsCount||2,bitrate:a.bandwidth||e.bandwidth||1,samplerate:a.audioSamplingRate||1,spatialRendering:a.spatialAudio}),!(o=(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])).length)return[n];e=[],r=new Map;for(var s=(o=d(o)).next();!s.done;s=o.next()){var c=s.value;r.get(c.keySystem)||r.set(c.keySystem,[]),r.get(c.keySystem).push(c)}o=t?"required":"optional",t=t?["persistent-license"]:["temporary"];for(var l=(c=d(r.keys())).next();!l.done;l=c.next()){var u=l.value;l=Object.assign({},n);var f=r.get(u);for(u={keySystem:u,initDataType:"cenc",persistentState:o,distinctiveIdentifier:"optional",sessionTypes:t},s=(f=d(f)).next();!s.done;s=f.next()){if((s=s.value).initData&&s.initData.length){for(var p=new Set,m=d(s.initData),_=m.next();!_.done;_=m.next())p.add(_.value.initDataType);u.initDataType=s.initData[0].initDataType}s.distinctiveIdentifierRequired&&(u.distinctiveIdentifier="required"),s.persistentStateRequired&&(u.persistentState="required"),s.sessionType&&(u.sessionTypes=[s.sessionType]),a&&(u.audio?u.audio.robustness=u.audio.robustness||s.audioRobustness:u.audio={robustness:s.audioRobustness}),i&&(u.video?u.video.robustness=u.video.robustness||s.videoRobustness:u.video={robustness:s.videoRobustness})}l.keySystemConfiguration=u,e.push(l)}return e}function vn(e){return lt()&&"ac-3"==e.toLowerCase()?"ec-3":e}function yn(e){if(e.includes("avc1")){var t=e.split(".");if(3==t.length)return e=t.shift()+".",(e+=parseInt(t.shift(),10).toString(16))+("000"+parseInt(t.shift(),10).toString(16)).slice(-4)}else if("vp9"==e)return"vp09.00.41.08";return e}function Sn(e,t){t.variants=t.variants.filter(function(t){var n=t.audio;return t=t.video,!(n&&e&&e.audio&&!Dn(n,e.audio)||t&&e&&e.video&&!Dn(t,e.video))})}function Dn(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]}function In(e){var t=e.audio,n=e.video,a=t?t.mimeType:null,i=n?n.mimeType:null,r=t?t.codecs:null,o=n?n.codecs:null,s=[];o&&s.push(o),r&&s.push(r);var c=[];n&&c.push(n.mimeType),t&&c.push(t.mimeType),c=c[0]||null;var l=[];t&&l.push(t.kind),n&&l.push(n.kind),l=l[0]||null;var u=new Set;if(t)for(var f=d(t.roles),p=f.next();!p.done;p=f.next())u.add(p.value);if(n)for(p=(f=d(n.roles)).next();!p.done;p=f.next())u.add(p.value);return e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:l,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:c,audioMimeType:a,videoMimeType:i,codecs:s.join(", "),audioCodec:r,videoCodec:o,primary:e.primary,roles:Array.from(u),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.spatialAudio=t.spatialAudio,e.label=t.label,e.audioRoles=t.roles),e}function xn(e){return{id:e.id,active:!1,type:et,bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,forced:e.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId,originalImageId:null}}function Cn(e){var t=e.width||null,n=e.height||null,a=null;e.segmentIndex&&(a=e.segmentIndex.get(0));var i=e.tilesLayout;return a&&(i=a.tilesLayout||i),i&&null!=t&&(t/=Number(i.split("x")[0])),i&&null!=n&&(n/=Number(i.split("x")[1])),{id:e.id,active:!1,type:"image",bandwidth:e.bandwidth||0,language:"",label:null,kind:null,width:t,height:n,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:e.mimeType,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:i||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:e.originalId}}function On(e){return e.__shaka_id||(e.__shaka_id=Fn++),e.__shaka_id}function wn(e){var t=An(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),"forced"==e.kind&&(t.forced=!0),t}function En(e){var t=An(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind],t.label=e.label),t}function An(e){return{id:On(e),active:!1,type:"",bandwidth:0,language:an(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null}}function Ln(e){return e.allowedByApplication&&e.allowedByKeySystem}function kn(e,t){for(var n=e.filter(function(e){return e.audio&&e.audio.channelsCount}),a=new Map,i=(n=d(n)).next();!i.done;i=n.next()){var r=(i=i.value).audio.channelsCount;a.has(r)||a.set(r,[]),a.get(r).push(i)}return 0==(n=Array.from(a.keys())).length?e:(e=n.filter(function(e){return e<=t})).length?a.get(Math.max.apply(Math,l(e))):a.get(Math.min.apply(Math,l(n)))}function Mn(e,t,n,a){var i=e,r=e.filter(function(e){return e.primary});r.length&&(i=r);var o=i.length?i[0].language:"";if(i=i.filter(function(e){return e.language==o}),t){var s=cn(an(t),e.map(function(e){return e.language}));s&&(i=e.filter(function(e){return an(e.language)==s}))}if(i=i.filter(function(e){return e.forced==a}),n){if((e=Pn(i,n)).length)return e}else if(e=i.filter(function(e){return 0==e.roles.length}),e.length)return e;return e=i.map(function(e){return e.roles}).reduce(qe,[]),e.length?Pn(i,e[0]):i}function Pn(e,t){return e.filter(function(e){return e.roles.includes(t)})}function Tn(e){var t=[];return e.audio&&t.push(Un(e.audio)),e.video&&t.push(Un(e.video)),t.join(", ")}function Un(e){return"audio"==e.type?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:"video"==e.type?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}(a=ln.prototype).push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},a.get=function(e){return(e=this.g[e])?e.slice():null},a.remove=function(e,t){e in this.g&&(this.g[e]=this.g[e].filter(function(e){return e!=t}),0==this.g[e].length&&delete this.g[e])},a.forEach=function(e){for(var t in this.g)e(t,this.g[t])},a.size=function(){return Object.keys(this.g).length},a.keys=function(){return Object.keys(this.g)};var Fn=0,Hn="smooth",Rn="powerEfficient",Nn="bandwidth",Bn=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),jn=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function Vn(){var e=this;this.l=null,this.o=!1,this.i=new z,this.u=null,navigator.connection&&(this.u=function(){if(e.g.useNetworkInformation&&e.o){e.i=new z,e.g&&e.i.configure(e.g.advanced);var t=e.chooseVariant();t&&e.l(t)}},navigator.connection.addEventListener("change",this.u)),this.m=[],this.B=1,this.F=!1,this.h=this.j=this.g=this.s=null,this.D=new ot(function(){if(e.g.restrictToElementSize){var t=e.chooseVariant();t&&e.l(t)}})}function zn(e){var t=e.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&e.g.useNetworkInformation&&(t=1e6*navigator.connection.downlink),t}function Gn(e,t,n,a){return e&&(t=t.filter(function(t){return mn(t,e,{width:a,height:n})})),t.sort(function(e,t){return e.bandwidth-t.bandwidth})}(a=Vn.prototype).stop=function(){this.l=null,this.o=!1,this.m=[],this.B=1,this.j=this.s=null,this.h&&(this.h.disconnect(),this.h=null),this.D.stop()},a.release=function(){navigator.connection&&(navigator.connection.removeEventListener("change",this.u),this.u=null),this.D=null},a.init=function(e){this.l=e},a.chooseVariant=function(){var t=1/0,n=1/0;this.g.restrictToScreenSize&&(n=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio,t=e.screen.height*n,n*=e.screen.width),this.h&&this.g.restrictToElementSize&&(n=this.g.ignoreDevicePixelRatio?1:e.devicePixelRatio,t=this.j.clientWidth*n,n*=this.j.clientHeight),t=Gn(this.g.restrictions,this.m,t,n),n=this.i.getBandwidthEstimate(zn(this)),this.m.length&&!t.length&&(t=[(t=Gn(null,this.m,1/0,1/0))[0]]);for(var a=t[0]||null,i=0;i<t.length;i++){for(var r=t[i],o=isNaN(this.B)?1:Math.abs(this.B),s=o*r.bandwidth/this.g.bandwidthDowngradeTarget,c={bandwidth:1/0},d=i+1;d<t.length;d++)if(r.bandwidth!=t[d].bandwidth){c=t[d];break}o=o*c.bandwidth/this.g.bandwidthUpgradeTarget,n>=s&&n<=o&&a.bandwidth!=r.bandwidth&&(a=r)}return this.s=Date.now(),a},a.enable=function(){this.o=!0},a.disable=function(){this.o=!1},a.segmentDownloaded=function(e,t){if(this.i.sample(e,t),null!=this.s&&this.o)e:{if(this.F){if(Date.now()-this.s<1e3*this.g.switchInterval)break e}else{if(!((e=this.i).g>=e.i))break e;this.F=!0}e=this.chooseVariant(),this.i.getBandwidthEstimate(zn(this)),e&&this.l(e)}},a.getBandwidthEstimate=function(){return this.i.getBandwidthEstimate(zn(this))},a.setVariants=function(e){this.m=e},a.playbackRateChanged=function(e){this.B=e},a.setMediaElement=function(t){var n=this;this.j=t,this.h&&(this.h.disconnect(),this.h=null),this.j&&"ResizeObserver"in e&&(this.h=new ResizeObserver(function(){n.D.N(Kn)}),this.h.observe(this.j))},a.configure=function(e){this.g=e,this.i&&this.g&&this.i.configure(this.g.advanced)},B("shaka.abr.SimpleAbrManager",Vn),Vn.prototype.configure=Vn.prototype.configure,Vn.prototype.setMediaElement=Vn.prototype.setMediaElement,Vn.prototype.playbackRateChanged=Vn.prototype.playbackRateChanged,Vn.prototype.setVariants=Vn.prototype.setVariants,Vn.prototype.getBandwidthEstimate=Vn.prototype.getBandwidthEstimate,Vn.prototype.segmentDownloaded=Vn.prototype.segmentDownloaded,Vn.prototype.disable=Vn.prototype.disable,Vn.prototype.enable=Vn.prototype.enable,Vn.prototype.chooseVariant=Vn.prototype.chooseVariant,Vn.prototype.init=Vn.prototype.init,Vn.prototype.release=Vn.prototype.release,Vn.prototype.stop=Vn.prototype.stop;var Kn=1;function Wn(e,t){this.g=e,this.h=t}function qn(e,t){var n=new Wn(5,0),a=Jn,i=a.g,r=n.h-i.h;(0<(n.g-i.g||r)?a.i:a.h)(a.g,n,e,t)}function Qn(e,t,n,a){W([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",a].join(" "))}function Yn(e,t,n,a){K([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",a].join(""))}Wn.prototype.toString=function(){return"v"+this.g+"."+this.h};var Jn=null;function Xn(e,t){for(this.h=e,this.g=new Set([e]),t=(e=d(t=t||[])).next();!t.done;t=e.next())this.add(t.value)}function Zn(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var a=t.audio;n=!((!(!n.channelsCount||!a.channelsCount||2<n.channelsCount||2<a.channelsCount)||n.channelsCount==a.channelsCount)&&$n(n,a)&&ea(n.roles,a.roles))}return!n&&(n=e.video&&t.video)&&(n=!($n(e=e.video,t=t.video)&&ea(e.roles,t.roles))),!n}function $n(e,t){if(e.mimeType!=t.mimeType)return!1;if(e=e.codecs.split(",").map(function(e){return Wt(e)[0]}),t=t.codecs.split(",").map(function(e){return Wt(e)[0]}),e.length!=t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function ea(e,t){if(e=new Set(e),t=new Set(t),e.delete("main"),t.delete("main"),e.size!=t.size)return!1;for(var n=(e=d(e)).next();!n.done;n=e.next())if(!t.has(n.value))return!1;return!0}function ta(e){this.g=e,this.h=new na(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function na(e,t,n,a){this.i=e,this.j=t,this.g=n,this.h=void 0===a?"":a}function aa(){this.g=oa,this.h=(new Map).set(oa,2).set(ra,1)}function ia(e,t,n){e.h.set(oa,n).set(ra,t)}B("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),Xn.prototype.add=function(e){return!!Zn(this.h,e)&&(this.g.add(e),!0)},Xn.prototype.values=function(){return this.g.values()},ta.prototype.create=function(e){var t=this,n=e.filter(function(e){return Zn(t.g,e)});return n.length?new Xn(n[0],n):this.h.create(e)},na.prototype.create=function(e){var t=[];t=function(e,t){var n=cn(t=an(t),e.map(function(e){return sn(e)}));return n?e.filter(function(e){return n==sn(e)}):[]}(e,this.i);var n=e.filter(function(e){return e.primary});for(e=function(e,t){return e.filter(function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)})}(t=t.length?t:n.length?n:e,this.j),e.length&&(t=e),this.g&&(e=kn(t,this.g)).length&&(t=e),this.h&&(e=function(e,t){return e.filter(function(e){return!(!e.audio||!e.audio.label)&&e.audio.label.toLowerCase()==t.toLowerCase()})}(t,this.h),e.length&&(t=e)),e=new Xn(t[0]),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,Zn(e.h,n)&&e.add(n);return e};var ra=0,oa=1;function sa(e,t){this.l=null==e.maxAttempts?2:e.maxAttempts,this.j=null==e.baseDelay?1e3:e.baseDelay,this.o=null==e.fuzzFactor?.5:e.fuzzFactor,this.m=null==e.backoffFactor?2:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function ca(e){var t,n;return M(function(a){if(1==a.g){if(e.g>=e.l){if(!e.i)throw new ke(2,7,1010);e.g=1,e.h=e.j}return t=e.g,e.g++,0==t?a.return():(n=e.h*(1+(2*Math.random()-1)*e.o),y(a,new Promise(function(e){new ot(e).N(n/1e3)}),2))}e.h*=e.m,S(a)})}function da(e,t){this.promise=e,this.i=t,this.g=!1}function la(e){return new da(Promise.reject(e),function(){return Promise.resolve()})}function ua(){var e=Promise.reject(new ke(2,7,7001));return e.catch(function(){}),new da(e,function(){return Promise.resolve()})}function fa(e){return new da(Promise.resolve(e),function(){return Promise.resolve()})}function pa(e){return new da(e,function(){return e.catch(function(){})})}function ma(e){return new da(Promise.all(e.map(function(e){return e.promise})),function(){return Promise.all(e.map(function(e){return e.abort()}))})}function _a(t,n){if(n)if(n instanceof Map)for(var a=d(n.keys()),i=a.next();!i.done;i=a.next())i=i.value,Object.defineProperty(this,i,{value:n.get(i),writable:!0,enumerable:!0});else for(a in n)Object.defineProperty(this,a,{value:n[a],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function ha(e){var t,n=new _a(e.type);for(t in e)Object.defineProperty(n,t,{value:e[t],writable:!0,enumerable:!0});return n}da.prototype.abort=function(){return this.g=!0,this.i()},da.prototype.finally=function(e){return this.promise.then(function(){return e(!0)},function(){return e(!1)}),this},da.prototype.X=function(e,t){function n(n){return function(s){if(i.g&&n)r.reject(o);else{var c=n?e:t;c?a=function(e,t,n){try{var a=e(t);return a&&a.promise&&a.abort?(n.resolve(a.promise),function(){return a.abort()}):(n.resolve(a),function(){return Promise.resolve(a).then(function(){},function(){})})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(c,s,r):(n?r.resolve:r.reject)(s)}}}function a(){return r.reject(o),i.abort()}var i=this,r=new at,o=new ke(2,7,7001);return this.promise.then(n(!0),n(!1)),new da(r,function(){return a()})},B("shaka.util.AbortableOperation",da),da.prototype.chain=da.prototype.X,da.prototype.finally=da.prototype.finally,da.all=ma,da.prototype.abort=da.prototype.abort,da.notAbortable=pa,da.completed=fa,da.aborted=ua,da.failed=la,_a.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},_a.prototype.stopImmediatePropagation=function(){this.g=!0},_a.prototype.stopPropagation=function(){},B("shaka.util.FakeEvent",_a);var ba={Hg:"abrstatuschanged",Ig:"adaptation",Jg:"buffering",Lg:"downloadfailed",Mg:"downloadheadersreceived",Ng:"drmsessionupdate",Pg:"emsg",bh:"prft",Error:"error",Qg:"expirationupdated",Rg:"gapjumped",Ug:"loaded",Vg:"loading",Xg:"manifestparsed",Yg:"mediaqualitychanged",Metadata:"metadata",$g:"onstatechange",ah:"onstateidle",dh:"ratechange",fh:"segmentappended",gh:"sessiondata",hh:"stalldetected",ih:"streaming",jh:"textchanged",kh:"texttrackvisibility",lh:"timelineregionadded",mh:"timelineregionenter",nh:"timelineregionexit",oh:"trackschanged",qh:"unloading",rh:"variantchanged"};function ga(){this.ca=new ln,this.Wc=this}function va(e){var t=new Set;return function e(n){switch(typeof n){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return n;default:if(!n||n.buffer&&n.buffer.constructor==ArrayBuffer)return n;if(t.has(n))return null;var a=n.constructor==Array;if(n.constructor!=Object&&!a)return null;t.add(n);var i,r=a?[]:{};for(i in n)r[i]=e(n[i]);return a&&(r.length=n.length),r}}(e)}function ya(e){var t,n={};for(t in e)n[t]=e[t];return n}function Sa(){this.g=[]}function Da(e,t){e.g.push(t.finally(function(){te(e.g,t)}))}function Ia(e,t,n){ga.call(this),this.i=!1,this.m=new Sa,this.g=new Set,this.h=new Set,this.l=e||null,this.j=t||null,this.s=n||null,this.o=!1}function xa(e,t,n,a){n=n||La;var i=ka[e];(!i||n>=i.priority)&&(ka[e]={priority:n,ig:t,jg:void 0!==a&&a})}function Ca(e,t,n){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===n?null:n}}function Oa(e,t,n,a,i,r,o){e.o&&(n.uris[i]=n.uris[i].replace("http://","https://"));var s=new Pe(n.uris[i]),c=s.Ea,d=!1;c||(Te(s,c=(c=location.protocol).slice(0,-1)),n.uris[i]=s.toString()),c=c.toLowerCase();var l=(c=ka[c])?c.ig:null;if(!l)return la(new ke(2,1,1e3,s));var u,f=c.jg,p=null,m=null,_=!1,h=!1;return pa(ca(a)).X(function(){if(e.i)return ua();u=Date.now();var a=l(n.uris[i],n,t,function(n,a,i){p&&p.stop(),m&&m.N(s/1e3),e.l&&t==Aa&&(e.l(n,a),d=!0,o.g=i)},function(a){e.j&&e.j(a,n,t),h=!0});if(!f)return a;var r=n.retryParameters.connectionTimeout;r&&(p=new ot(function(){_=!0,a.abort()})).N(r/1e3);var s=n.retryParameters.stallTimeout;return s&&(m=new ot(function(){_=!0,a.abort()})),a}).X(function(a){p&&p.stop(),m&&m.stop(),null==a.timeMs&&(a.timeMs=Date.now()-u);var i={response:a,Xf:d};return!h&&e.j&&e.j(a.headers,n,t),i},function(s){if(p&&p.stop(),m&&m.stop(),e.s){var c=null,d=0;s instanceof ke&&(c=s,1001==s.code&&(d=s.data[1])),e.s(n,c,d,_)}if(e.i)return ua();if(_&&(s=new ke(1,1,1003,n.uris[i],t)),s instanceof ke){if(7001==s.code)throw s;if(1010==s.code)throw r;if(1==s.severity)return c=new _a("retry",c=(new Map).set("error",s)),e.dispatchEvent(c),i=(i+1)%n.uris.length,Oa(e,t,n,a,i,s,o)}throw s})}function wa(){this.g=0}function Ea(e,t,n){da.call(this,e,t),this.h=n}ga.prototype.addEventListener=function(e,t){this.ca&&this.ca.push(e,t)},ga.prototype.removeEventListener=function(e,t){this.ca&&this.ca.remove(e,t)},ga.prototype.dispatchEvent=function(e){if(!this.ca)return!0;var t=this.ca.get(e.type)||[],n=this.ca.get("All");for(n&&(t=t.concat(n)),n=(t=d(t)).next();!n.done;n=t.next()){n=n.value,e.target=this.Wc,e.currentTarget=this.Wc;try{n.handleEvent?n.handleEvent(e):n.call(this,e)}catch(e){}if(e.g)break}return e.defaultPrevented},ga.prototype.release=function(){this.ca=null},Sa.prototype.destroy=function(){for(var e=[],t=d(this.g),n=t.next();!n.done;n=t.next())(n=n.value).promise.catch(function(){}),e.push(n.abort());return this.g=[],Promise.all(e)},h(Ia,ga),(a=Ia.prototype).ie=function(e){this.o=e},a.kg=function(e){this.g.add(e)},a.Ag=function(e){this.g.delete(e)},a.qf=function(){this.g.clear()},a.lg=function(e){this.h.add(e)},a.Bg=function(e){this.h.delete(e)},a.rf=function(){this.h.clear()},a.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),ga.prototype.release.call(this),this.m.destroy()},a.request=function(e,t){var n=this,a=new wa;if(this.i){var i=Promise.reject(new ke(2,7,7001));return i.catch(function(){}),new Ea(i,function(){return Promise.resolve()},a)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?va(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},t.uris=va(t.uris),i=function(e,t,n){for(var a=fa(void 0),i={},r=(e=d(e.g)).next();!r.done;i={td:i.td},r=e.next())i.td=r.value,a=a.X(function(e){return function(){return n.body&&(n.body=we(n.body)),e.td(t,n)}}(i));return a.X(void 0,function(e){if(e instanceof ke&&7001==e.code)throw e;throw new ke(2,1,1006,e)})}(this,e,t);var r=i.X(function(){return Oa(n,e,t,new sa(t.retryParameters,!1),0,null,a)}),o=r.X(function(t){return function(e,t,n){for(var a=fa(void 0),i={},r=(e=d(e.h)).next();!r.done;i={ud:i.ud},r=e.next())i.ud=r.value,a=a.X(function(e){return function(){var a=n.response;return a.data&&(a.data=we(a.data)),e.ud(t,a)}}(i));return a.X(function(){return n},function(e){var t=2;if(e instanceof ke){if(7001==e.code)throw e;t=e.severity}throw new ke(t,1,1007,e)})}(n,e,t)}),s=Date.now(),c=0;i.promise.then(function(){c=Date.now()-s},function(){});var l=0;r.promise.then(function(){l=Date.now()},function(){});var u=o.X(function(t){var a=Date.now()-l,i=t.response;return i.timeMs+=c,i.timeMs+=a,t.Xf||!n.l||i.fromCache||e!=Aa||n.l(i.timeMs,i.data.byteLength),i},function(e){throw e&&(e.severity=2),e});return i=new Ea(u.promise,function(){return u.abort()},a),Da(this.m,i),i},B("shaka.net.NetworkingEngine",Ia),Ia.prototype.request=Ia.prototype.request,Ia.prototype.destroy=Ia.prototype.destroy,Ia.makeRequest=Ca,Ia.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Ia.prototype.clearAllResponseFilters=Ia.prototype.rf,Ia.prototype.unregisterResponseFilter=Ia.prototype.Bg,Ia.prototype.registerResponseFilter=Ia.prototype.lg,Ia.prototype.clearAllRequestFilters=Ia.prototype.qf,Ia.prototype.unregisterRequestFilter=Ia.prototype.Ag,Ia.prototype.registerRequestFilter=Ia.prototype.kg,Ia.unregisterScheme=function(e){delete ka[e]},Ia.registerScheme=xa,Ia.prototype.setForceHTTPS=Ia.prototype.ie,Ia.NumBytesRemainingClass=wa,h(Ea,da),Ia.PendingRequest=Ea;var Aa=1;Ia.RequestType={MANIFEST:0,SEGMENT:Aa,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6};var La=3;Ia.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:La};var ka={};function Ma(e){this.g=!1,this.h=new at,this.i=e}function Pa(e,t){if(e.g){if(t instanceof ke&&7003==t.code)throw t;throw new ke(2,7,7003,t)}}function Ta(){this.g=new ln}function Ua(e,t,n,a){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter(function(e){return!n.has(e)}),function(e){var t=Fa;if(null==t){t=!1;try{var n={},a={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",a),Object.defineProperty(n,"capture",a),a=function(){},e.addEventListener("test",a,n),e.removeEventListener("test",a,n)}catch(e){t=!1}Fa=t}return t||!1}(e)?t:t.capture||!1}(e,a),this.target.addEventListener(t,n,this.g)}Ma.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then(function(){e.h.resolve()},function(){e.h.resolve()}))},(a=Ta.prototype).release=function(){this.pb(),this.g=null},a.C=function(e,t,n,a){this.g&&(e=new Ua(e,t,n,a),this.g.push(t,e))},a.ma=function(e,t,n,a){var i=this;this.C(e,t,function a(r){i.zc(e,t,a),n(r)},a)},a.zc=function(e,t,n){if(this.g)for(var a=this.g.get(t)||[],i=(a=d(a)).next();!i.done;i=a.next())(i=i.value).target!=e||n!=i.listener&&n||(i.zc(),this.g.remove(t,i))},a.pb=function(){if(this.g){var e,t=this.g,n=[];for(e in t.g)n.push.apply(n,l(t.g[e]));for(n=(t=d(n)).next();!n.done;n=t.next())n.value.zc();this.g.g={}}},B("shaka.util.EventManager",Ta),Ta.prototype.removeAll=Ta.prototype.pb,Ta.prototype.unlisten=Ta.prototype.zc,Ta.prototype.listenOnce=Ta.prototype.ma,Ta.prototype.listen=Ta.prototype.C,Ta.prototype.release=Ta.prototype.release,Ua.prototype.zc=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var Fa=void 0;function Ha(e,t){for(var n=[],a=(e=d(e)).next();!a.done;a=e.next())n.push(t(a.value));return n}function Ra(e){for(var t=new Map,n=d(Object.keys(e)),a=n.next();!a.done;a=n.next())a=a.value,t.set(a,e[a]);return t}function Na(e){var t={};return e.forEach(function(e,n){t[n]=e}),t}function Ba(e,t){if(!e&&!t)return!0;if(e&&!t||t&&!e)return!1;if(e.size!=t.size)return!1;for(var n=(e=d(e)).next();!n.done;n=e.next()){var a=d(n.value);if(n=a.next().value,a=a.next().value,!t.has(n))return!1;if((n=t.get(n))!=a||null==n)return!1}return!0}function ja(e,t){this.S=Ae(e),this.h=t==za,this.g=0}function Va(){return new ke(2,3,3e3)}(a=ja.prototype).ga=function(){return this.g<this.S.byteLength},a.$=function(){return this.g},a.Ff=function(){return this.S.byteLength},a.Ra=function(){try{var e=this.S.getUint8(this.g);return this.g+=1,e}catch(e){throw Va()}},a.Zd=function(){try{var e=this.S.getUint16(this.g,this.h);return this.g+=2,e}catch(e){throw Va()}},a.K=function(){try{var e=this.S.getUint32(this.g,this.h);return this.g+=4,e}catch(e){throw Va()}},a.Oe=function(){try{var e=this.S.getInt32(this.g,this.h);return this.g+=4,e}catch(e){throw Va()}},a.ab=function(){try{if(this.h)var e=this.S.getUint32(this.g,!0),t=this.S.getUint32(this.g+4,!0);else t=this.S.getUint32(this.g,!1),e=this.S.getUint32(this.g+4,!1)}catch(e){throw Va()}if(2097151<t)throw new ke(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},a.$a=function(e){if(this.g+e>this.S.byteLength)throw Va();var t=Ee(this.S,this.g,e);return this.g+=e,t},a.skip=function(e){if(this.g+e>this.S.byteLength)throw Va();this.g+=e},a.rg=function(e){if(this.g<e)throw Va();this.g-=e},a.seek=function(e){if(0>e||e>this.S.byteLength)throw Va();this.g=e},a.sc=function(){for(var e=this.g;this.ga()&&0!=this.S.getUint8(this.g);)this.g+=1;return e=Ee(this.S,e,this.g-e),this.g+=1,yt(e)},B("shaka.util.DataViewReader",ja),ja.prototype.readTerminatedString=ja.prototype.sc,ja.prototype.seek=ja.prototype.seek,ja.prototype.rewind=ja.prototype.rg,ja.prototype.skip=ja.prototype.skip,ja.prototype.readBytes=ja.prototype.$a,ja.prototype.readUint64=ja.prototype.ab,ja.prototype.readInt32=ja.prototype.Oe,ja.prototype.readUint32=ja.prototype.K,ja.prototype.readUint16=ja.prototype.Zd,ja.prototype.readUint8=ja.prototype.Ra,ja.prototype.getLength=ja.prototype.Ff,ja.prototype.getPosition=ja.prototype.$,ja.prototype.hasMoreData=ja.prototype.ga;var za=1;function Ga(){this.i=[],this.h=[],this.g=!1}function Ka(e){for(var t=Xa(e);e.reader.ga()&&!e.parser.g;)e.parser.qc(e.start+t,e.reader,e.partialOkay)}function Wa(e){for(var t=Xa(e),n=e.reader.K(),a=0;a<n&&(e.parser.qc(e.start+t,e.reader,e.partialOkay),!e.parser.g);a++);}function qa(e){var t=Xa(e);for(e.reader.skip(78);e.reader.ga()&&!e.parser.g;)e.parser.qc(e.start+t,e.reader,e.partialOkay)}function Qa(e){return function(t){e(t.reader.$a(t.reader.S.byteLength-t.reader.$()))}}function Ya(e){for(var t=0,n=(e=d(e)).next();!n.done;n=e.next())t=t<<8|n.value.charCodeAt(0);return t}function Ja(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Xa(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}ja.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:za},(a=Ga.prototype).box=function(e,t){return e=Ya(e),this.i[e]=Za,this.h[e]=t,this},a.P=function(e,t){return e=Ya(e),this.i[e]=$a,this.h[e]=t,this},a.stop=function(){this.g=!0},a.parse=function(e,t,n){for(e=new ja(e,0),this.g=!1;e.ga()&&!this.g;)this.qc(0,e,t,n)},a.qc=function(e,t,n,a){var i=t.$();if(a&&i+8>t.S.byteLength)this.g=!0;else{var r=t.K(),o=t.K(),s=Ja(o),c=!1;switch(r){case 0:r=t.S.byteLength-i;break;case 1:if(a&&t.$()+8>t.S.byteLength)return void(this.g=!0);r=t.ab(),c=!0}var d=this.h[o];if(d){var l=null,u=null;if(this.i[o]==$a){if(a&&t.$()+4>t.S.byteLength)return void(this.g=!0);l=(u=t.K())>>>24,u&=16777215}o=i+r,n&&o>t.S.byteLength&&(o=t.S.byteLength),a&&o>t.S.byteLength?this.g=!0:(a=o-t.$(),d({name:s,parser:this,partialOkay:n||!1,version:l,flags:u,reader:t=new ja(t=0<a?t.$a(a):new Uint8Array(0),0),size:r,start:i+e,has64BitSize:c}))}else t.skip(Math.min(i+r-t.$(),t.S.byteLength-t.$()))}},B("shaka.util.Mp4Parser",Ga),Ga.headerSize=Xa,Ga.typeToString=Ja,Ga.allData=Qa,Ga.visualSampleEntry=qa,Ga.sampleDescription=Wa,Ga.children=Ka,Ga.prototype.parseNext=Ga.prototype.qc,Ga.prototype.parse=Ga.prototype.parse,Ga.prototype.stop=Ga.prototype.stop,Ga.prototype.fullBox=Ga.prototype.P,Ga.prototype.box=Ga.prototype.box;var Za=0,$a=1;function ei(e){var t=this;this.g=[],this.h=[],this.data=[],(new Ga).box("moov",Ka).box("moof",Ka).P("pssh",function(e){if(!(1<e.version)){var n=Ee(e.reader.S,-12,e.size);if(t.data.push(n),t.g.push(kt(e.reader.$a(16))),0<e.version){n=e.reader.K();for(var a=0;a<n;a++){var i=kt(e.reader.$a(16));t.h.push(i)}}}}).parse(e)}function ti(e,t,n,a){var i=e.length,r=t.length+16+i;0<a&&(r+=4+16*n.size);var o=new Uint8Array(r),s=Ae(o),c=0;if(s.setUint32(c,r),c+=4,s.setUint32(c,1886614376),c+=4,1>a?s.setUint32(c,0):s.setUint32(c,16777216),c+=4,o.set(t,c),c+=t.length,0<a)for(s.setUint32(c,n.size),c+=4,n=(t=d(n)).next();!n.done;n=t.next())n=Lt(n.value),o.set(n,c),c+=n.length;return s.setUint32(c,i),o.set(e,c+4),o}function ni(e,t){return 1!=(e=ii(e,t)).length?null:e[0]}function ai(e,t,n){return 1!=(e=ri(e,t,n)).length?null:e[0]}function ii(e,t){for(var n=[],a=(e=d(e.childNodes)).next();!a.done;a=e.next())(a=a.value)instanceof Element&&a.tagName==t&&n.push(a);return n}function ri(e,t,n){for(var a=[],i=(e=d(e.childNodes)).next();!i.done;i=e.next())(i=i.value)instanceof Element&&i.localName==n&&i.namespaceURI==t&&a.push(i);return a}function oi(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function si(e,t,n){for(var a=(t=d(t)).next();!a.done;a=t.next())if(a=a.value,e.hasAttributeNS(a,n))return e.getAttributeNS(a,n);return null}function ci(e){return Array.from(e.childNodes).every(di)?e.textContent.trim():null}function di(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}function li(e,t,n,a){a=void 0===a?null:a;var i=null;return null!=(e=e.getAttribute(t))&&(i=n(e)),i??a}function ui(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:e/1e3):null}function fi(e){return e&&(e=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(e))?(e=31536e3*Number(e[1]||null)+2592e3*Number(e[2]||null)+86400*Number(e[3]||null)+3600*Number(e[4]||null)+60*Number(e[5]||null)+Number(e[6]||null),isFinite(e)?e:null):null}function pi(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null}function mi(e){return 0==(e=Number(e))%1?e:null}function _i(e){return 0==(e=Number(e))%1&&0<e?e:null}function hi(e){return 0==(e=Number(e))%1&&0<=e?e:null}function bi(e){return e=Number(e),isNaN(e)?null:e}function gi(e){var t,n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e);return isNaN(n)?null:n}function vi(e,t){var n=new DOMParser,a=Si.value()(e);e=null;try{e=n.parseFromString(a,"text/xml")}catch(e){return null}if(!(n=e.documentElement)||n.getElementsByTagName("parsererror").length||n.tagName!=t)return null;for(t=document.createNodeIterator(e,NodeFilter.SHOW_ALL);e=t.nextNode();)if(e instanceof HTMLElement||e instanceof SVGElement)return null;return n}function yi(e,t){try{return vi(yt(e),t)}catch(e){return null}}var Si=new it(function(){if("undefined"!=typeof trustedTypes){var e=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function(e){return e}});return function(t){return e.createHTML(t)}}return function(e){return e}});function Di(e,t){var n=this;t=void 0===t?1:t,this.D=e,this.G=new Set,this.l=this.u=null,this.da=this.W=!1,this.H=0,this.g=null,this.s=new Ta,this.i=new Map,this.B=[],this.o=new at,this.h=null,this.m=function(t){n.o.reject(t),e.onError(t)},this.ia=new Map,this.ba=new Map,this.O=new ot(function(){return function(e){var t=e.ia,n=e.ba;n.clear(),t.forEach(function(e,t){return n.set(t,e)}),(t=Array.from(n.values())).length&&t.every(function(e){return"expired"==e})&&e.m(new ke(2,6,6014)),e.D.dd(Na(n))}(n)}),this.L=!1,this.J=[],this.M=!1,this.ca=new ot(function(){!function(e){e.i.forEach(function(t,n){var a=t.Ud,i=n.expiration;isNaN(i)&&(i=1/0),i!=a&&(e.D.onExpirationUpdated(n.sessionId,i),t.Ud=i)})}(n)}).Ca(t),this.o.catch(function(){}),this.j=new Ma(function(){return function(e){return M(function(t){switch(t.g){case 1:return e.s.release(),e.s=null,e.o.reject(),e.ca.stop(),e.ca=null,e.O.stop(),e.O=null,y(t,Ui(e),2);case 2:if(!e.l){t.A(3);break}return D(t,4),y(t,e.l.setMediaKeys(null),6);case 6:x(t,5);break;case 4:C(t);case 5:e.l=null;case 3:e.g=null,e.G.clear(),e.u=null,e.B=[],e.h=null,e.m=function(){},e.D=null,e.V=!1,e.F=null,S(t)}})}(n)}),this.V=!1,this.F=null}function Ii(e,t,n){return e.B=n,e.L=0<n.length,xi(e,t)}function xi(t,n){var a,i,r,o,s,c,l,u,f,p,m,_;return M(function(h){if(1==h.g){if(a=function(t){if(0==(t=Ra(t.h.clearKeys)).size)return null;var n=[],a=[];t.forEach(function(e,t){var i=t;22!=i.length&&(i=Et(Lt(t),!1)),22!=(t=e).length&&(t=Et(Lt(e),!1)),e={kty:"oct",kid:i,k:t},n.push(e),a.push(e.kid)}),t=JSON.stringify({keys:n});var i=JSON.stringify({kids:a});return i=[{initData:Ee(It(i)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:i,keyIds:new Set(a)}}(t))for(i=d(n),r=i.next();!r.done;r=i.next())(o=r.value).video&&(o.video.drmInfos=[a]),o.audio&&(o.audio.drmInfos=[a]);for((s=n.some(function(e){return!!(e.video&&e.video.drmInfos.length||e.audio&&e.audio.drmInfos.length)}))||(c=Ra(t.h.servers),function(e,t){var n=[];for(t.forEach(function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})}),t=(e=d(e)).next();!t.done;t=e.next())(t=t.value).video&&(t.video.drmInfos=n),t.audio&&(t.audio.drmInfos=n)}(n,c)),l=d(n),r=l.next();!r.done;r=l.next())for(u=r.value,f=Hi(u),p=d(f),m=p.next();!m.done;m=p.next())Bi(m.value,Ra(t.h.servers),Ra(t.h.advanced||{}),t.h.keySystemsMapping);return y(h,bn(n,t.L,t.V),2)}return s||Object.keys(t.h.servers).length?(_=ki(t,void 0,n),h.return(s?_:_.catch(function(){}))):(t.W=!0,h.return(Promise.resolve()))})}function Ci(e){var t;return M(function(n){switch(n.g){case 1:if(e.l.mediaKeys)return n.return();if(!e.F){n.A(2);break}return y(n,e.F,3);case 3:return Pa(e.j),n.return();case 2:return D(n,4),e.F=e.l.setMediaKeys(e.u),y(n,e.F,6);case 6:x(n,5);break;case 4:t=C(n),e.m(new ke(2,6,6003,t.message));case 5:Pa(e.j),S(n)}})}function Oi(e){var t,n;return M(function(a){switch(a.g){case 1:if(!e.u||!e.g)return a.return();if(!e.g.serverCertificateUri||e.g.serverCertificate&&e.g.serverCertificate.length){a.A(2);break}return t=Ca([e.g.serverCertificateUri],e.h.retryParameters),D(a,3),y(a,e.D.mb.request(5,t).promise,5);case 5:n=a.h,e.g.serverCertificate=Ee(n.data),x(a,4);break;case 3:throw new ke(2,6,6017,C(a));case 4:if(e.j.g)return a.return();case 2:return e.g.serverCertificate&&e.g.serverCertificate.length?(D(a,6),y(a,e.u.setServerCertificate(e.g.serverCertificate),8)):a.return();case 8:x(a,0);break;case 6:throw new ke(2,6,6004,C(a).message)}})}function wi(e){for(var t=(e.g?e.g.initData:[])||[],n=d(t),a=n.next();!a.done;a=n.next())Ei(e,(a=a.value).initDataType,a.initData);for(a=(n=d(e.B)).next();!a.done;a=n.next())Mi(e,a.value);return t.length||e.B.length||e.o.resolve(),e.o}function Ei(e,t,n){if(n.length){for(var a=e.i.values(),i=(a=d(a)).next();!i.done;i=a.next())if(Ce(n,i.value.initData)&&!_t("Tizen 2"))return;0<e.i.size&&Ri(e)&&(e.o.resolve(),e.o=new at,e.o.catch(function(){})),function(e,t,n,a){try{var i=e.u.createSession(a)}catch(t){return void e.m(new ke(2,6,6005,t.message))}e.s.C(i,"message",function(t){e.l&&e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.M?e.J.push(t):Pi(e,t)}),e.s.C(i,"keystatuseschange",function(t){return Ti(e,t)}),e.i.set(i,{initData:n,initDataType:t,loaded:!1,Ud:1/0,Ja:null,type:a});try{n=e.h.initDataTransform(n,t,e.g)}catch(n){return t=n,n instanceof ke||(t=new ke(2,6,6016,n)),void e.m(t)}e.h.logLicenseExchange&&Et(n),i.generateRequest(t,n).catch(function(t){if(!e.j.g){e.i.delete(i);var n=t.errorCode;if(n&&n.systemCode){var a=n.systemCode;0>a&&(a+=Math.pow(2,32)),a="0x"+a.toString(16)}e.m(new ke(2,6,6006,t.message,t,a))}})}(e,t,n,e.g.sessionType)}}function Ai(e){return!!e&&!!e.match(/^com\.(microsoft|chromecast)\.playready/)}function Li(e){return e=Ha(e=e.i.keys(),function(e){return e.sessionId}),Array.from(e)}function ki(e,t,n){var a,i,r,o,s,c,l,u,f,p,m,_,h;return M(function(b){switch(b.g){case 1:if(a=new Map,n.length){i=function(e,t,n){for(var a=d(t),i=a.next();!i.done;i=a.next()){var r=d(Hi(i.value));for(i=r.next();!i.done;i=r.next())i=i.value,n.has(i.keySystem)||n.set(i.keySystem,[]),n.get(i.keySystem).push(i)}if(1==n.size&&n.has(""))throw new ke(2,6,6e3);for(a={},i=(e=d(e.h.preferredKeySystems)).next();!i.done;a={rd:a.rd},i=e.next())for(a.rd=i.value,i=(r=d(t)).next();!i.done;i=r.next())if(i=i.value.decodingInfos.find(function(e){return function(t){return t.supported&&null!=t.keySystemAccess&&t.keySystemAccess.keySystem==e.rd}}(a)))return i.keySystemAccess;for(i=(e=d([!0,!1])).next();!i.done;i=e.next())for(a=i.value,i=(r=d(t)).next();!i.done;i=r.next()){var o=d(i.value.decodingInfos);for(i=o.next();!i.done;i=o.next()){var s=i.value;if(s.supported&&s.keySystemAccess){var c=d(i=n.get(s.keySystemAccess.keySystem));for(i=c.next();!i.done;i=c.next())if(!!i.value.licenseServerUri==a)return s.keySystemAccess}}}return null}(e,n,a),b.A(2);break}return y(b,function(e,t){var n,a,i,r,o,s,c,l,u,f,p,m,_,h,b;return M(function(g){switch(g.g){case 1:if(1==t.size&&t.has(""))throw new ke(2,6,6e3);for(a=d(t.values()),i=a.next();!i.done;i=a.next())0==(r=i.value).audioCapabilities.length&&delete r.audioCapabilities,0==r.videoCapabilities.length&&delete r.videoCapabilities;o=d(e.h.preferredKeySystems),s=o.next();case 2:if(s.done){g.A(4);break}if(c=s.value,!t.has(c)){g.A(3);break}return l=t.get(c),D(g,6),y(g,navigator.requestMediaKeySystemAccess(c,[l]),8);case 8:return n=g.h,g.return(n);case 6:C(g);case 7:Pa(e.j);case 3:s=o.next(),g.A(2);break;case 4:u=d([!0,!1]),f=u.next();case 9:if(f.done){g.A(11);break}p=f.value,m=d(t.keys()),s=m.next();case 12:if(s.done){f=u.next(),g.A(9);break}if(_=s.value,h=t.get(_),b=h.drmInfos.some(function(e){return!!e.licenseServerUri}),b!=p){g.A(13);break}return D(g,15),y(g,navigator.requestMediaKeySystemAccess(_,[h]),17);case 17:return n=g.h,g.return(n);case 15:C(g);case 16:Pa(e.j);case 13:s=m.next(),g.A(12);break;case 11:return g.return(n)}})}(e,t),3);case 3:i=b.h;case 2:if(!(r=i))throw new ke(2,6,6001);for(Pa(e.j),D(b,4),e.G.clear(),o=r.getConfiguration(),s=o.audioCapabilities||[],c=o.videoCapabilities||[],l=d(s),u=l.next();!u.done;u=l.next())f=u.value,e.G.add(f.contentType.toLowerCase());for(p=d(c),u=p.next();!u.done;u=p.next())m=u.value,e.G.add(m.contentType.toLowerCase());if(n.length){var g=r.keySystem,v=a.get(r.keySystem),S=[],I=[],O=[],w=[],E=new Set;Ni(v,S,O,I,w,E);var A=e.L?"persistent-license":"temporary";for(g={keySystem:g,licenseServerUri:S[0],distinctiveIdentifierRequired:v[0].distinctiveIdentifierRequired,persistentStateRequired:v[0].persistentStateRequired,sessionType:v[0].sessionType||A,audioRobustness:v[0].audioRobustness||"",videoRobustness:v[0].videoRobustness||"",serverCertificate:O[0],serverCertificateUri:I[0],initData:w,keyIds:E},S=(v=d(v)).next();!S.done;S=v.next())(S=S.value).distinctiveIdentifierRequired&&(g.distinctiveIdentifierRequired=S.distinctiveIdentifierRequired),S.persistentStateRequired&&(g.persistentStateRequired=S.persistentStateRequired);v=g}else v=r.keySystem,g=t.get(r.keySystem),S=[],I=[],O=[],w=[],E=new Set,Ni(g.drmInfos,S,O,I,w,E),v={keySystem:v,licenseServerUri:S[0],distinctiveIdentifierRequired:"required"==g.distinctiveIdentifier,persistentStateRequired:"required"==g.persistentState,sessionType:g.sessionTypes[0]||"temporary",audioRobustness:(g.audioCapabilities?g.audioCapabilities[0].robustness:"")||"",videoRobustness:(g.videoCapabilities?g.videoCapabilities[0].robustness:"")||"",serverCertificate:O[0],serverCertificateUri:I[0],initData:w,keyIds:E};if(e.g=v,!e.g.licenseServerUri)throw new ke(2,6,6012,e.g.keySystem);return y(b,r.createMediaKeys(),6);case 6:return _=b.h,Pa(e.j),e.u=_,e.W=!0,y(b,Oi(e),7);case 7:Pa(e.j),x(b,0);break;case 4:if(h=C(b),Pa(e.j,h),e.g=null,e.G.clear(),h instanceof ke)throw h;throw new ke(2,6,6002,h.message)}})}function Mi(e,t){var n,a,i,r,o;return M(function(s){switch(s.g){case 1:try{n=e.u.createSession("persistent-license")}catch(t){return a=new ke(2,6,6005,t.message),e.m(a),s.return(Promise.reject(a))}return e.s.C(n,"message",function(t){e.l&&e.h.delayLicenseRequestUntilPlayed&&e.l.paused&&!e.M?e.J.push(t):Pi(e,t)}),e.s.C(n,"keystatuseschange",function(t){return Ti(e,t)}),i={initData:null,initDataType:null,loaded:!1,Ud:1/0,Ja:null,type:"persistent-license"},e.i.set(n,i),D(s,2),y(s,n.load(t),4);case 4:return r=s.h,Pa(e.j),r?(i.loaded=!0,Ri(e)&&e.o.resolve(),s.return(n)):(e.i.delete(n),e.m(new ke(2,6,6013)),s.return(Promise.resolve()));case 2:o=C(s),Pa(e.j,o),e.i.delete(n),e.m(new ke(2,6,6005,o.message));case 3:return s.return(Promise.resolve())}})}function Pi(e,t){var n,a,i,r,o,s,c,l,u,f,p,m;M(function(_){switch(_.g){case 1:return n=t.target,e.h.logLicenseExchange&&Et(t.message),a=e.i.get(n),i=e.g.licenseServerUri,r=e.h.advanced[e.g.keySystem],"individualization-request"==t.messageType&&r&&r.individualizationServer&&(i=r.individualizationServer),(o=Ca([i],e.h.retryParameters)).body=t.message,o.method="POST",o.licenseRequestType=t.messageType,o.sessionId=n.sessionId,o.drmInfo=e.g,a&&(o.initData=a.initData,o.initDataType=a.initDataType),Ai(e.g.keySystem)&&function(e){var t=St(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){for(var n=d((t=vi(t,"PlayReadyKeyMessage")).getElementsByTagName("HttpHeader")),a=n.next();!a.done;a=n.next())a=a.value,e.headers[a.getElementsByTagName("name")[0].textContent]=a.getElementsByTagName("value")[0].textContent;e.body=At(t.getElementsByTagName("Challenge")[0].textContent)}else e.headers["Content-Type"]="text/xml; charset=utf-8"}(o),s=Date.now(),D(_,2),y(_,e.D.mb.request(2,o).promise,4);case 4:c=_.h,x(_,3);break;case 2:return l=C(_),u=new ke(2,6,6007,l),e.m(u),a&&a.Ja&&a.Ja.reject(u),_.return();case 3:return e.j.g?_.return():(e.H+=(Date.now()-s)/1e3,e.h.logLicenseExchange&&Et(c.data),D(_,5),y(_,n.update(c.data),7));case 7:x(_,6);break;case 5:return f=C(_),p=new ke(2,6,6008,f.message),e.m(p),a&&a.Ja&&a.Ja.reject(p),_.return();case 6:if(e.j.g)return _.return();m=new _a("drmsessionupdate"),e.D.onEvent(m),a&&(a.Ja&&a.Ja.resolve(),new ot(function(){a.loaded=!0,Ri(e)&&e.o.resolve()}).N(Vi)),S(_)}})}function Ti(e,t){t=t.target;var n=e.i.get(t),a=!1;t.keyStatuses.forEach(function(t,i){if("string"==typeof i){var r=i;i=t,t=r}if(Ai(e.g.keySystem)&&16==i.byteLength&&(navigator.userAgent.match(/Edge?\//)||pt())){var o=(r=Ae(i)).getUint32(0,!0),s=r.getUint16(4,!0),c=r.getUint16(6,!0);r.setUint32(0,o,!1),r.setUint16(4,s,!1),r.setUint16(6,c,!1)}"status-pending"!=t&&(n.loaded=!0),"expired"==t&&(a=!0),i=kt(i).slice(0,32),e.ia.set(i,t)});var i=t.expiration-Date.now();(0>i||a&&1e3>i)&&n&&!n.Ja&&(e.i.delete(t),t.close().catch(function(){})),Ri(e)&&(e.o.resolve(),e.O.N(zi))}function Ui(e){var t;return M(function(n){return t=Array.from(e.i.entries()),e.i.clear(),y(n,Promise.all(t.map(function(t){var n=(t=d(t)).next().value,a=t.next().value;return M(function(t){return 1==t.g?(D(t,2),e.da||e.B.includes(n.sessionId)||"persistent-license"!==a.type?y(t,function(e){var t;return M(function(n){return 1==n.g?(t=new Promise(function(e,t){new ot(t).N(ji)}),D(n,2),y(n,Promise.race([Promise.all([e.close(),e.closed]),t]),4)):2!=n.g?x(n,0):(C(n),void S(n))})}(n),5):y(t,n.remove(),5)):2!=t.g?x(t,0):(C(t),void S(t))})})),0)})}function Fi(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],a=(e=d(e)).next();!a.done;a=e.next()){a=a.value;for(var i={},r=d(t),o=r.next();!o.done;i={Da:i.Da},o=r.next())if(o=o.value,a.keySystem==o.keySystem){i.Da=[],i.Da=i.Da.concat(a.initData||[]),i.Da=i.Da.concat(o.initData||[]),i.Da=i.Da.filter(function(e){return function(t,n){return void 0===t.keyId||n===e.Da.findIndex(function(e){return e.keyId===t.keyId})}}(i)),r=a.keyIds&&o.keyIds?new Set([].concat(l(a.keyIds),l(o.keyIds))):a.keyIds||o.keyIds,n.push({keySystem:a.keySystem,licenseServerUri:a.licenseServerUri||o.licenseServerUri,distinctiveIdentifierRequired:a.distinctiveIdentifierRequired||o.distinctiveIdentifierRequired,persistentStateRequired:a.persistentStateRequired||o.persistentStateRequired,videoRobustness:a.videoRobustness||o.videoRobustness,audioRobustness:a.audioRobustness||o.audioRobustness,serverCertificate:a.serverCertificate||o.serverCertificate,serverCertificateUri:a.serverCertificateUri||o.serverCertificateUri,initData:i.Da,keyIds:r});break}}return n}function Hi(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[])}function Ri(e){return function(e,t){for(var n=(e=d(e)).next();!n.done;n=e.next())if(!t(n.value))return!1;return!0}(e=e.i.values(),function(e){return e.loaded})}function Ni(e,t,n,a,i,r){for(var o={},s=(e=d(e)).next();!s.done;o={pa:o.pa},s=e.next()){if(o.pa=s.value,t.includes(o.pa.licenseServerUri)||t.push(o.pa.licenseServerUri),a.includes(o.pa.serverCertificateUri)||a.push(o.pa.serverCertificateUri),o.pa.serverCertificate&&(n.some(function(e){return function(t){return Ce(t,e.pa.serverCertificate)}}(o))||n.push(o.pa.serverCertificate)),o.pa.initData){s={};for(var c=d(o.pa.initData),l=c.next();!l.done;s={Dc:s.Dc},l=c.next())s.Dc=l.value,i.some(function(e){return function(t){var n=e.Dc;return!(!t.keyId||t.keyId!=n.keyId)||t.initDataType==n.initDataType&&Ce(t.initData,n.initData)}}(s))||i.push(s.Dc)}if(o.pa.keyIds)for(c=(s=d(o.pa.keyIds)).next();!c.done;c=s.next())r.add(c.value)}}function Bi(t,n,a,i){var r=t.keySystem;!r||"org.w3.clearkey"==r&&t.licenseServerUri||(n.size&&(n=n.get(r)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=new Set),(a=a.get(r))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=a.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=a.persistentStateRequired),t.videoRobustness||(t.videoRobustness=a.videoRobustness),t.audioRobustness||(t.audioRobustness=a.audioRobustness),t.serverCertificate||(t.serverCertificate=a.serverCertificate),a.sessionType&&(t.sessionType=a.sessionType),t.serverCertificateUri||(t.serverCertificateUri=a.serverCertificateUri)),i[r]&&(t.keySystem=i[r]),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==r&&(t.keySystem="com.chromecast.playready"))}(a=Di.prototype).destroy=function(){return this.j.destroy()},a.configure=function(e){this.h=e},a.Zb=function(e){var t,n=this;return M(function(a){if(1==a.g)return n.u?(n.l=e,n.s.ma(n.l,"play",function(){for(var e=d(n.J),t=e.next();!t.done;t=e.next())Pi(n,t.value);n.M=!0,n.J=[]}),"webkitCurrentPlaybackTargetIsWireless"in n.l&&n.s.C(n.l,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Ui(n)}),(t=n.g.initData.find(function(e){return 0<e.initData.length}))||"com.apple.fps"!==n.g.keySystem||n.B.length?y(a,Ci(n),2):a.A(2)):(n.s.ma(e,"encrypted",function(){n.m(new ke(2,6,6010))}),a.return());wi(n),t||n.B.length||n.h.parseInbandPsshEnabled||n.s.C(n.l,"encrypted",function(e){return function(e,t){return M(function(n){if(1==n.g)return y(n,Ci(e),2);Ei(e,t.initDataType,Ee(t.initData)),S(n)})}(n,e)}),S(a)})},a.ic=function(){for(var e=1/0,t=this.i.keys(),n=(t=d(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},a.Rc=function(){return Na(this.ba)};var ji=1,Vi=5,zi=.5,Gi=new it(function(){return we(new Uint8Array([0]))});function Ki(){}function Wi(e,t,n,a){var i,r,o,s;return M(function(c){if(1==c.g)return a&&(i=Yi[a.toLowerCase()])?c.return(i):(r=Qi(e))&&(o=Ji[r])?c.return(o):a?c.A(2):y(c,qi(e,t,n),3);if(2!=c.g&&(a=c.h)&&(s=Yi[a]))return c.return(s);throw new ke(2,4,4e3,e)})}function qi(e,t,n){var a,i,r;return M(function(o){return 1==o.g?((a=Ca([e],n)).method="HEAD",y(o,t.request(0,a).promise,2)):(i=o.h,r=i.headers["content-type"],o.return(r?r.toLowerCase().split(";").shift():""))})}function Qi(e){return 1==(e=new Pe(e).ra.split("/").pop().split(".")).length?"":e.pop().toLowerCase()}B("shaka.media.ManifestParser",Ki),Ki.unregisterParserByMime=function(e){delete Yi[e]},Ki.registerParserByMime=function(e,t){Yi[e]=t},Ki.registerParserByExtension=function(e,t){Ji[e]=t};var Yi={},Ji={};function Xi(e,t,n,a,i){var r=$i.value(),o=e.subarray(n.start,n.start+n.size),s=Ae(o),c=new Uint8Array(n.size+r.byteLength);for(c.set(o,0),(o=Ae(c)).setUint32(4,i),c.set(r,n.size),i=s.getUint32(4),o.setUint32(n.size+16,i),Zi(c,0,c.byteLength),i=new Uint8Array(e.byteLength+c.byteLength),n=dt()?n.start:n.start+n.size,r=e.subarray(n),i.set(e.subarray(0,n)),i.set(c,n),i.set(r,n+c.byteLength),a=(e=d(a)).next();!a.done;a=e.next())Zi(i,(a=a.value).start,a.size+c.byteLength);return c=Ae(i,t.start),t=Xa(t),e=c.getUint32(t),c.setUint32(t,e+1),i}function Zi(e,t,n){0!=(t=(e=Ae(e,t)).getUint32(0))&&(1==t?(e.setUint32(8,n>>32),e.setUint32(12,4294967295&n)):e.setUint32(0,n))}var $i=new it(function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])});function er(e,t,n,a,i){if(a>=i)return null;for(var r=-1,o=-1,s=0;s<n.length;s++)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){r=s;break}for(s=n.length-1;0<=s;s--)if(n[s].some(function(e){return null!=e&&""!=e.g.trim()})){o=s;break}if(-1===r||-1===o)return null;for(var c=s=!1,d="white",l="black",u=tr(a,i,s,c,d,l);r<=o;r++){for(var f=n[r],p=-1,m=-1,_=0;_<f.length;_++)if(null!=f[_]&&""!==f[_].g.trim()){p=_;break}for(_=f.length-1;0<=_;_--)if(null!=f[_]&&""!==f[_].g.trim()){m=_;break}if(-1===p||-1===m)f=nr(a,i),e.nestedCues.push(f);else{for(;p<=m;p++)if(_=f[p]){var h=_.l,b=_.i,g=_.j,v=_.h;h==s&&b==c&&g==d&&v==l||(u.payload&&e.nestedCues.push(u),u=tr(a,i,h,b,g,v),s=h,c=b,d=g,l=v),u.payload+=_.g}else u.payload+=" ";u.payload&&e.nestedCues.push(u),r!==o&&(u=nr(a,i),e.nestedCues.push(u)),u=tr(a,i,s,c,d,l)}}return e.nestedCues.length?{cue:e,stream:t}:null}function tr(e,t,n,a,i,r){return e=new ie(e,t,""),n&&e.textDecoration.push("underline"),a&&(e.fontStyle="italic"),e.color=i,e.backgroundColor=r,e}function nr(e,t){return(e=new ie(e,t,"")).lineBreak=!0,e}function ar(e,t,n,a,i){this.g=e,this.l=t,this.i=n,this.h=a,this.j=i}function ir(e,t){this.i=[],this.g=1,this.h=0,this.u=e,this.s=t,this.j=this.m=!1,this.l="white",this.o="black",or(this)}function rr(e,t,n){return er(new ie(t,n,""),"CC"+(e.u<<1|e.s+1),e.i,t,n)}function or(e){dr(e,0,15),e.g=1}function sr(e,t,n){if(!(32>n||127<n)){var a="";switch(t){case lr:a=mr.has(n)?mr.get(n):String.fromCharCode(n);break;case ur:a=_r.get(n);break;case fr:e.i[e.g].pop(),a=hr.get(n);break;case pr:e.i[e.g].pop(),a=br.get(n)}a&&e.i[e.g].push(new ar(a,e.m,e.j,e.o,e.l))}}function cr(e,t,n,a){if(!(0>n||0>t))if(t>=n)for(--a;0<=a;a--)e.i[t+a]=e.i[n+a].map(function(e){return e});else for(var i=0;i<a;i++)e.i[t+i]=e.i[n+i].map(function(e){return e})}function dr(e,t,n){for(var a=0;a<=n;a++)e.i[t+a]=[]}var lr=0,ur=1,fr=2,pr=3,mr=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),_r=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),hr=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),br=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]);function gr(e,t){this.h=Dr,this.o=new ir(e,t),this.i=new ir(e,t),this.l=new ir(e,t),this.g=this.i,this.j=0,this.m=null}function vr(e,t,n){e.g=e.i;var a=e.g,i=null;return e.h!==xr&&e.h!==Cr&&(i=rr(a,e.j,n),(n=e.i).g=0<n.h?n.h:0,dr(n,0,15),(n=e.l).g=0<n.h?n.h:0,dr(n,0,15),a.g=15),e.h=xr,a.h=t,i}function yr(e){e.h=Ir,e.g=e.l,e.g.h=0}function Sr(e){q("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),e.g=e.o,e.h=Cr}var Dr=0,Ir=1,xr=3,Cr=4,Or="black green blue cyan red yellow magenta black".split(" "),wr="white green blue cyan red yellow magenta white_italics".split(" ");function Er(){this.l=!1,this.B=this.F=0,this.D=Fr,this.i=[],this.g=this.h=this.j=0,this.u=this.o=!1,this.s="white",this.m="black",Ar(this)}function Ar(e){e.i=[];for(var t=0;16>t;t++)e.i.push(Lr())}function Lr(){for(var e=[],t=0;42>t;t++)e.push(null);return e}function kr(e,t){Mr(e)&&(e.i[e.h][e.g]=new ar(t,e.u,e.o,e.m,e.s),e.g++)}function Mr(e){var t=e.g<e.B&&0<=e.g;return e.h<e.F&&0<=e.h&&t}function Pr(e,t,n){var a=new ie(e.j,t,"");return a.textAlign=e.D===Tr?"left":e.D===Ur?"right":se,(n=er(a,"svc"+n,e.i,e.j,t))&&(e.j=t),n}Er.prototype.isVisible=function(){return this.l};var Tr=0,Ur=1,Fr=2;function Hr(){this.i=[],this.h=null,this.g=0}function Rr(e,t){3===t.type?(e.g=2*(63&t.value)-1,e.h=[]):e.h&&(0<e.g&&(e.h.push(t),e.g--),0===e.g&&(e.i.push(new Nr(e.h)),e.h=null,e.g=0))}function Nr(e){this.g=0,this.h=e}function Br(e){if(!e.ga())throw new ke(2,2,3e3);return e.h[e.g++]}function jr(e){this.i=e,this.h=[null,null,null,null,null,null,null,null],this.g=null}function Vr(e,t,n,a){if(128<=n&&135>=n)a=7&n,e.h[a]&&(e.g=e.h[a]);else{if(136===n){n=Br(t).value,t=null;for(var i=(n=d(zr(e,n))).next();!i.done;i=n.next())(i=e.h[i.value]).isVisible()&&(t=Pr(i,a,e.i)),Ar(i);return t}if(137===n)for(n=(t=d(zr(e,t=Br(t).value))).next();!n.done;n=t.next())(n=e.h[n.value]).isVisible()||(n.j=a),n.l=!0;else{if(138===n){for(n=Br(t).value,t=null,i=(n=d(zr(e,n))).next();!i.done;i=n.next())(i=e.h[i.value]).isVisible()&&(t=Pr(i,a,e.i)),i.l=!1;return t}if(139===n){for(n=Br(t).value,t=null,i=(n=d(zr(e,n))).next();!i.done;i=n.next())(i=e.h[i.value]).isVisible()?t=Pr(i,a,e.i):i.j=a,i.l=!i.l;return t}if(140===n)return Gr(e,t=Br(t).value,a);if(143===n)return a=Gr(e,255,a),Kr(e),a;if(144===n)t.skip(1),a=Br(t).value,e.g&&(e.g.o=0<(128&a),e.g.u=0<(64&a));else if(145===n)a=Br(t).value,n=Br(t).value,t.skip(1),e.g&&(t=Wr((48&n)>>4,(12&n)>>2,3&n),e.g.s=Wr((48&a)>>4,(12&a)>>2,3&a),e.g.m=t);else if(146===n)a=Br(t).value,t=Br(t).value,e.g&&((e=e.g).h=15&a,e.g=63&t);else if(151===n)t.skip(1),t.skip(1),a=Br(t).value,t.skip(1),e.g&&(e.g.D=3&a);else if(152<=n&&159>=n){if(n=(15&n)-8,!(i=null!==e.h[n])){var r=new Er;r.j=a,e.h[n]=r}a=Br(t).value,Br(t),Br(t),r=Br(t).value;var o=Br(t).value;t=Br(t).value,i&&0==(7&t)||((t=e.h[n]).h=0,t.g=0,t.u=!1,t.o=!1,t.s="white",t.m="black"),(t=e.h[n]).l=0<(32&a),t.F=1+(15&r),t.B=1+(63&o),e.g=e.h[n]}}}return null}function zr(e,t){for(var n=[],a=0;8>a;a++)1==(1&t)&&e.h[a]&&n.push(a),t>>=1;return n}function Gr(e,t,n){for(var a=null,i=(t=d(zr(e,t))).next();!i.done;i=t.next()){i=i.value;var r=e.h[i];r.isVisible()&&(a=Pr(r,n,e.i)),e.h[i]=null}return a}function Kr(e){e.g=null,e.h=[null,null,null,null,null,null,null,null]}function Wr(e,t,n){var a={0:0,1:0,2:1,3:1};return Qr[(e=a[e])<<2|(t=a[t])<<1|(n=a[n])]}Nr.prototype.ga=function(){return this.g<this.h.length},Nr.prototype.$=function(){return this.g},Nr.prototype.skip=function(e){if(this.g+e>this.h.length)throw new ke(2,2,3e3);this.g+=e};var qr=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),Qr="black blue green cyan red magenta yellow white".split(" ");function Yr(){this.h=[],this.g=[],this.i=new Hr,this.l=0,this.s=new Map([["CC1",new gr(0,0)],["CC2",new gr(0,1)],["CC3",new gr(1,0)],["CC4",new gr(1,1)]]),this.o=this.m=0,this.j=new Map,Jr(this)}function Jr(e){e.m=0,e.o=0;for(var t=(e=d(e.s.values())).next();!t.done;t=e.next())(t=t.value).h=2,t.g=t.i,t.m=null,or(t.i),or(t.l),or(t.o)}function Xr(e,t){var n=t.type;if(16==(112&t.ya)){var a=t.ya>>3&1;0===n?e.m=a:e.o=a}if(n=e.s.get("CC"+(n<<1|(n?e.o:e.m)+1)),255===t.ya&&255===t.Ma||!t.ya&&!t.Ma||!$r(t.ya)||!$r(t.Ma))return 45<=++e.l&&Jr(e),null;if(e.l=0,t.ya&=127,t.Ma&=127,!t.ya&&!t.Ma)return null;if(e=null,16==(112&t.ya))e:{if(a=t.ya,e=t.Ma,n.m===(a<<8|e))n.m=null;else if(n.m=a<<8|e,16==(240&a)&&64==(192&e)){t=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&a)<<1|e>>5&1];var i=(30&e)>>1;a="white";var r=!1;if(7>i?a=wr[i]:7===i&&(r=!0),e=1==(1&e),n.h!==Cr){if(i=n.g,n.h===xr&&t!==i.g){var o=1+t-i.h;cr(i,o,1+i.g-i.h,i.h),dr(i,0,o-1),dr(i,t+1,15-t)}i.g=t,n.g.m=e,n.g.j=r,n.g.l=a,n.g.o="black"}}else if(17==(247&a)&&32==(240&e))n.g.m=!1,n.g.j=!1,n.g.l="white",sr(n.g,lr,32),a=!1,"white_italics"===(t=wr[(14&e)>>1])&&(t="white",a=!0),n.g.m=1==(1&e),n.g.j=a,n.g.l=t;else if(16==(247&a)&&32==(240&e)||23==(247&a)&&45==(255&e))t="black",0==(7&a)&&(t=Or[(14&e)>>1]),n.g.o=t;else if(17==(247&a)&&48==(240&e))sr(n.g,ur,e);else if(18==(246&a)&&32==(224&e))sr(n.g,1&a?pr:fr,e);else if(20==(246&a)&&32==(240&e)){switch(e=t.pts,a=null,t.Ma){case 32:yr(n);break;case 33:(n=n.g).i[n.g].pop();break;case 37:a=vr(n,2,e);break;case 38:a=vr(n,3,e);break;case 39:a=vr(n,4,e);break;case 40:sr(n.g,lr,32);break;case 41:n.h=2,n.g=n.i,n.g.h=0,n.j=e;break;case 42:or(n.o),Sr(n);break;case 43:Sr(n);break;case 44:t=n.i,a=null,n.h!==Cr&&(a=rr(t,n.j,e)),dr(t,0,15);break;case 45:t=n.g,n.h!==xr?a=null:(a=rr(t,n.j,e),cr(t,(r=t.g-t.h+1)-1,r,t.h),dr(t,0,r-1),dr(t,t.g,15-t.g),n.j=e);break;case 46:dr(n.l,0,15);break;case 47:t=null,n.h!==Cr&&(t=rr(n.i,n.j,e)),a=n.l,n.l=n.i,n.i=a,yr(n),n.j=e,a=t}e=a;break e}e=null}else a=t.Ma,sr(n.g,lr,t.ya),sr(n.g,lr,a);return e}function Zr(e,t){var n=[];try{for(;t.ga();){var a=Br(t).value,i=(224&a)>>5,r=31&a;if(7===i&&0!=r&&(i=63&Br(t).value),0!=i){e.j.has(i)||e.j.set(i,new jr(i));for(var o=e.j.get(i),s=t.$();t.$()-s<r;){var c=Br(i=t),d=c.value,l=c.pts;if(16===d&&(d=d<<16|Br(i).value),0<=d&&31>=d){var u=l;if(o.g){var f=o.g;switch(i=null,d){case 8:!Mr(f)||0>=f.g&&0>=f.h||(0>=f.g?(f.g=f.B-1,f.h--):f.g--,f.i[f.h][f.g]=null);break;case 13:if(f.isVisible()&&(i=Pr(f,u,o.i)),f.h+1>=f.F){u=f;for(var p=0,m=1;16>m;m++,p++)u.i[p]=u.i[m];for(m=0;1>m;m++,p++)u.i[p]=Lr()}else f.h++;f.g=0;break;case 14:f.isVisible()&&(i=Pr(f,u,o.i)),f.i[f.h]=Lr(),f.g=0;break;case 12:f.isVisible()&&(i=Pr(f,u,o.i)),Ar(f),(u=f).h=0,u.g=0}var _=i}else _=null}else if(128<=d&&159>=d)_=Vr(o,i,d,l);else{if(4096<=d&&4127>=d)8<=(u=255&d)&&15>=u?i.skip(1):16<=u&&23>=u?i.skip(2):24<=u&&31>=u&&i.skip(3);else if(4224<=d&&4255>=d)128<=(u=255&d)&&135>=u?i.skip(4):136<=u&&143>=u&&i.skip(5);else if(32<=d&&127>=d)i=d,o.g&&kr(o.g,127===i?"♪":String.fromCharCode(i));else if(160<=d&&255>=d)o.g&&kr(o.g,String.fromCharCode(d));else if(4128<=d&&4223>=d){if(i=255&d,o.g)if(qr.has(i)){var h=qr.get(i);kr(o.g,h)}else kr(o.g,"_")}else 4256<=d&&4351>=d&&o.g&&kr(o.g,160!=(255&d)?"_":"[CC]");_=null}(i=_)&&n.push(i)}}}}catch(e){if(!(e instanceof ke&&3e3===e.code))throw e;q("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return n}function $r(e){for(var t=0;e;)t^=1&e,e>>=1;return 1===t}function eo(){}function to(e,t){var n=null,a=null,i=null,r=e.K();return 1&t&&(i=e.ab()),2&t&&e.skip(4),8&t&&(n=e.K()),16&t&&(a=e.K()),{trackId:r,Ae:n,wf:a,sh:i}}function no(e,t){return{ue:1==t?e.ab():e.K()}}function ao(e,t){return 1==t?(e.skip(8),e.skip(8)):(e.skip(4),e.skip(4)),{timescale:e.K()}}function io(e,t,n){var a=e.K(),i=[],r=null;1&n&&(r=e.K()),4&n&&e.skip(4);for(var o=0;o<a;o++){var s={de:null,sampleSize:null,fd:null};256&n&&(s.de=e.K()),512&n&&(s.sampleSize=e.K()),1024&n&&e.skip(4),2048&n&&(s.fd=0==t?e.K():e.Oe()),i.push(s)}return{xh:a,Qe:i,vf:r}}function ro(){this.j=new Map,this.i=this.h=0,this.g=oo}eo.prototype.init=function(){},eo.prototype.parse=function(){return[]},ro.prototype.init=function(e){function t(e){(e=e.name)in lo&&(n.g=lo[e])}var n=this,a=[],i=[];if((new Ga).box("moov",Ka).box("mvex",Ka).P("trex",function(e){var t=e.reader;t.skip(4),t.skip(4),e=t.K(),t=t.K(),n.h=e,n.i=t}).box("trak",Ka).P("tkhd",function(e){var t=e.reader;1==e.version?(t.skip(8),t.skip(8)):(t.skip(4),t.skip(4)),e=t.K(),a.push(e)}).box("mdia",Ka).P("mdhd",function(e){e=ao(e.reader,e.version),i.push(e.timescale)}).box("minf",Ka).box("stbl",Ka).P("stsd",Wa).box("avc1",t).box("avc3",t).box("hev1",t).box("hvc1",t).box("dvh1",t).box("dvhe",t).box("encv",qa).box("sinf",Ka).box("frma",function(e){(e=Ja(e=e.reader.K()))in lo&&(n.g=lo[e])}).parse(e,!0),!a.length||!i.length||a.length!=i.length)throw new ke(2,2,2010);this.g==oo&&W("Unable to determine bitstream format for CEA parsing!"),a.forEach(function(e,t){n.j.set(e,i[t])})},ro.prototype.parse=function(e){var t=this;if(this.g==oo)return[];var n=[],a=this.h,i=this.i,r=[],o=null,s=null,c=null,u=9e4;return(new Ga).box("moof",function(e){o=e.start,Ka(e)}).box("traf",Ka).P("trun",function(e){e=io(e.reader,e.version,e.flags),r=e.Qe,s=e.vf}).P("tfhd",function(e){e=to(e.reader,e.flags),a=e.Ae||t.h,i=e.wf||t.i,e=e.trackId,t.j.has(e)&&(u=t.j.get(e))}).P("tfdt",function(e){c=no(e.reader,e.version).ue}).box("mdat",function(e){if(null===c)throw new ke(2,2,2010);e:{var f=e.reader,p=c,m=u,_=a,h=i,b=r,g=0,v=h;for(b.length&&(v=b[0].sampleSize||h),f.skip((o||0)+(s||0)-e.start-8);f.ga();){e=f.K();var y=f.Ra();switch(t.g){case so:y=6==(y&=31);break;case co:y=39==(y=y>>1&63)||40==y;break;default:break e}if(y){y=0,b.length>g&&(y=b[g].fd||0),y=(p+y)/m;for(var S,D=[],I=f.$a(e-1),x=S=0;x<I.length;)2==S&&3==I[x]?(S=0,(I=[].concat(l(I))).splice(x,1),I=new Uint8Array(I)):0==I[x]?S++:S=0,x++;for(S=I,x=0;x<S.length;){for(I=0;255==S[x];)I+=255,x++;I+=S[x++];for(var C=0;255==S[x];)C+=255,x++;C+=S[x++],4==I&&D.push(S.subarray(x,x+C)),x+=C}for(S=(D=d(D)).next();!S.done;S=D.next())n.push({hg:S.value,pts:y})}else try{f.skip(e-1)}catch(e){break}0==(v-=e+4)&&(p=b.length>g?p+(b[g].de||_):p+_,g++,v=b.length>g&&b[g].sampleSize||h)}}}).parse(e,!1),n};var oo=0,so=1,co=2,lo={avc1:so,avc3:so,hev1:co,hvc1:co,dvh1:co,dvhe:co};function uo(e){this.h=new eo,e.includes("video/mp4")&&(this.h=new ro),this.g=new Yr}function fo(e,t,n,a,i){this.za=e,this.Ba=t,this.ka=n,this.Od=void 0===a?null:a,this.timescale=i}function po(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){d=void 0===d?[]:d,p=void 0===p?mo:p,this.startTime=e,this.j=this.endTime=t,this.u=n,this.Ba=a,this.ka=i,this.h=r,this.timestampOffset=o,this.appendWindowStart=s,this.appendWindowEnd=c,this.i=d,this.tilesLayout=void 0===l?"":l,this.s=void 0===u?null:u,this.g=void 0===f?null:f,this.status=p,this.l=void 0===m?null:m,this.o=null,this.m=0}uo.prototype.init=function(e){this.h.init(e)},fo.prototype.lc=function(){return this.Ba},fo.prototype.hc=function(){return this.ka},B("shaka.media.InitSegmentReference",fo),fo.prototype.getEndByte=fo.prototype.hc,fo.prototype.getStartByte=fo.prototype.lc,(a=po.prototype).za=function(){return this.u()},a.getStartTime=function(){return this.startTime},a.Df=function(){return this.endTime},a.lc=function(){return this.Ba},a.hc=function(){return this.ka},a.Uf=function(){return this.tilesLayout},a.Tf=function(){return this.s},a.Eb=function(){return this.status},a.ag=function(){this.status=_o},a.Xe=function(e){this.o=e},a.Rf=function(){return this.o},B("shaka.media.SegmentReference",po),po.prototype.getThumbnailSprite=po.prototype.Rf,po.prototype.setThumbnailSprite=po.prototype.Xe,po.prototype.markAsUnavailable=po.prototype.ag,po.prototype.getStatus=po.prototype.Eb,po.prototype.getTileDuration=po.prototype.Tf,po.prototype.getTilesLayout=po.prototype.Uf,po.prototype.getEndByte=po.prototype.hc,po.prototype.getStartByte=po.prototype.lc,po.prototype.getEndTime=po.prototype.Df,po.prototype.getStartTime=po.prototype.getStartTime,po.prototype.getUris=po.prototype.za;var mo=0,_o=1;function ho(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:1==e.length&&0>e.start(0)?0:e.length?e.start(0):null}function bo(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function go(e,t){return!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t>=e.start(0)}function vo(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,a=(e=d(yo(e))).next();!a.done;a=e.next()){var i=a.value;a=i.start,(i=i.end)>t&&(n+=i-Math.max(a,t))}return n}function yo(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function So(){}function Do(e,t){var n=(127&e[t])<<21;return n|=(127&e[t+1])<<14,(n|=(127&e[t+2])<<7)|127&e[t+3]}function Io(e){var t={key:e.type,description:"",data:""};if("TXXX"===e.type){if(2>e.size||3!==e.data[0])return null;var n=e.data.subarray(1).indexOf(0);if(-1===n)return null;var a=yt(Ee(e.data,1,n));return e=yt(Ee(e.data,2+n)).replace(/\0*$/,""),t.description=a,t.data=e,t}return"WXXX"===e.type?2>e.size||3!==e.data[0]||-1===(n=e.data.subarray(1).indexOf(0))?null:(a=yt(Ee(e.data,1,n)),e=yt(Ee(e.data,2+n)).replace(/\0*$/,""),t.description=a,t.data=e,t):"PRIV"===e.type?2>e.size||-1===(a=e.data.indexOf(0))?null:(a=yt(Ee(e.data,0,a)),e=we(e.data.subarray(a.length+1)),t.description=a,t.data=e,t):"T"===e.type[0]?2>e.size||3!==e.data[0]?null:(e=yt(e.data.subarray(1)).replace(/\0*$/,""),t.data=e,t):"W"===e.type[0]?(e=yt(e.data).replace(/\0*$/,""),t.data=e,t):e.data?(t.data=we(e.data),t):null}function xo(e){for(var t=0,n=[];t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9];){var a=Do(e,t+6);for(e[t+5]>>6&1&&(t+=10),a=(t+=10)+a;t+10<a;){var i=e.subarray(t),r=Do(i,4);(r=Io(i={type:String.fromCharCode(i[0],i[1],i[2],i[3]),size:r,data:i.subarray(10,10+r)}))&&n.push(r),t+=i.size+10}t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&255>e[t+3]&&255>e[t+4]&&128>e[t+6]&&128>e[t+7]&&128>e[t+8]&&128>e[t+9]&&(t+=10)}return n}function Co(){this.o=null,this.s=!1,this.l=this.m=null,this.B=[],this.g=this.h=null,this.u=[],this.j=null,this.i=[]}function Oo(e){if(1!=(e[0]<<16|e[1]<<8|e[2]))return null;var t={data:new Uint8Array(0),wh:6+(e[4]<<8|e[5]),pts:null,dts:null},n=e[7];return 192&n&&(t.pts=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,t.dts=t.pts,64&n&&(t.dts=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)),t.data=e.subarray(9+e[8]),t}function wo(e){for(var t=Math.min(1e3,e.length-564),n=0;n<t;){if(71===e[n]&&71===e[n+188]&&71===e[n+376])return n;n++}return-1}function Eo(e,t,n){this.g=null,this.i=-1,this.j=e,this.h=t,this.l=n,"undefined"==typeof libDPIModule&&W("Could not Find LCEVC Library dependencies on this page"),"undefined"==typeof LcevcDil?W("Could not Find LCEVC Library on this page"):LcevcDil.SupportObject.SupportStatus||W(LcevcDil.SupportObject.SupportError),"undefined"!=typeof LcevcDil&&"undefined"!=typeof libDPIModule&&this.h instanceof HTMLCanvasElement&&LcevcDil.SupportObject.SupportStatus&&!this.g&&LcevcDil.SupportObject.webGLSupport(this.h)&&(this.h.classList.remove("shaka-hidden"),this.g=new LcevcDil.LcevcDil(this.j,this.h,this.l))}function Ao(e,t){var n=Lo;switch(t.mimeType){case"video/webm":n=ko;break;case"video/mp4":n=Mo}e.g&&(e.i=t.id,e.g.setLevelSwitching(t.id,!0),e.g.setContainerFormat(n))}po.Status={Gg:mo,ph:_o,Wg:2},B("shaka.util.Id3Utils",So),So.getID3Frames=xo,Co.prototype.parse=function(e){if(564>e.length)return this;for(var t=Math.max(0,wo(e)),n=e.length-(e.length+t)%188,a=!1,i=t;i<n;i+=188)if(71===e[i]){var r=!!(64&e[i+1]),o=((31&e[i+1])<<8)+e[i+2];if(1<(48&e[i+3])>>4){var s=i+5+e[i+4];if(s===i+188)continue}else s=i+4;switch(o){case 0:r&&(s+=e[s]+1),this.o=(31&e[s+10])<<8|e[s+11];break;case 17:case 8191:break;case this.o:r&&(s+=e[s]+1),o={audio:-1,video:-1,Fd:-1,audioCodec:"",videoCodec:""};var c=s+3+((15&(r=e)[s+1])<<8|r[s+2])-4;for(s+=12+((15&r[s+10])<<8|r[s+11]);s<c;){var d=(31&r[s+1])<<8|r[s+2];switch(r[s]){case 15:-1===o.audio&&(o.audio=d,o.audioCodec="aac");break;case 21:-1===o.Fd&&(o.Fd=d);break;case 27:-1===o.video&&(o.video=d,o.videoCodec="avc");break;case 3:case 4:-1===o.audio&&(o.audio=d,o.audioCodec="mp3");break;case 36:-1===o.video&&(o.video=d,o.videoCodec="hvc")}s+=5+((15&r[s+3])<<8|r[s+4])}r=o,null==this.l&&(this.l=r.video),null==this.g&&(this.g=r.audio),null==this.j&&(this.j=r.Fd),a&&!this.s&&(a=!1,i=t-188),this.s=!0;break;case this.l:r=e.subarray(s,i+188),null==this.m&&(s=Oo(r))&&null!=s.pts&&(this.m=s.pts/9e4),this.B.push(r);break;case this.g:r=e.subarray(s,i+188),null==this.h&&(s=Oo(r))&&null!=s.pts&&(this.h=s.pts/9e4),this.u.push(r);break;case this.j:this.i.push(e.subarray(s,i+188));break;default:a=!0}}return this},Co.prototype.getStartTime=function(){return{audio:this.h,video:this.m}},B("shaka.util.TsParser",Co),Eo.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},B("shaka.lcevc.Dil",Eo),Eo.prototype.release=Eo.prototype.release;var Lo=0,ko=1,Mo=2;function Po(e,t,n,a){var i=this;this.j=e,this.F=null,this.m=t,this.h={},this.L={},this.O={},this.g=null,this.H=!1,this.V=n||function(){},this.D=a||null,this.i={},this.u=new Ta,this.o={},this.s=null,this.J=new at,this.l=function(e,t){var n=new MediaSource;return e.u.ma(n,"sourceopen",function(){URL.revokeObjectURL(e.M),t.resolve()}),e.M=Jo(n),e.j.src=e.M,n}(this,this.J),this.G=new Ma(function(){return function(e){var t,n,a,i,r,o,s;return M(function(c){if(1==c.g){for(n in t=[],e.i)for(a=e.i[n],i=a[0],e.i[n]=a.slice(0,1),i&&t.push(i.p.catch(Qe)),r=d(a.slice(1)),o=r.next();!o.done;o=r.next())o.value.p.reject(new ke(2,7,7003,void 0));for(s in e.g&&t.push(e.g.destroy()),e.m&&t.push(e.m.destroy()),e.o)t.push(e.o[s].destroy());return y(c,Promise.all(t),2)}e.u&&(e.u.release(),e.u=null),e.j&&(e.j.removeAttribute("src"),e.j.load(),e.j=null),e.F=null,e.l=null,e.g=null,e.m=null,e.h={},e.o={},e.s=null,e.i={},e.D=null,S(c)})}(i)}),this.M="",this.B=!1,this.W=new at}function To(e,t,n){e.g||(e.g=new qt(e.m));var a=e.g;e=e.H,"application/cea-608"!=t&&"application/cea-708"!=t&&(a.j=(0,Zt[t])(),a.j.setSequenceMode?a.j.setSequenceMode(n):W('Text parsers should have a "setSequenceMode" method!'),a.u=e)}function Uo(e){return!e.l||"ended"==e.l.readyState}function Fo(e,t){return t==et?e.g.g:ho(Ro(e,t))}function Ho(e,t){return t==et?e.g.h:bo(Ro(e,t))}function Ro(e,t){try{return e.h[t].buffered}catch(e){return null}}function No(e,t,n,a,i,r,o){var s,c,u,f,p,m,_,h,b,g,v,D,I,x,C,O,w,E,A,L,k;return r=void 0!==r&&r,o=void 0!==o&&o,M(function(P){switch(P.g){case 1:if(t!=(s=tt).Z){P.A(2);break}if(!e.B){P.A(3);break}return y(P,e.W,4);case 4:c=P.h,e.g.s=c;case 3:return y(P,function(e,t,n,a){var i,r,o,s;return M(function(c){return 1==c.g?y(c,Promise.resolve(),2):e.j&&e.i?null==n||null==a?(e.j.parseInit(Ee(t)),c.return()):(i=e.u?n:e.s,r={periodStart:e.s,segmentStart:n,segmentEnd:a,vttOffset:i},o=e.j.parseMedia(Ee(t),r),s=o.filter(function(t){return t.startTime>=e.l&&t.startTime<e.m}),e.i.append(s),null==e.g&&(e.g=Math.max(n,e.l)),e.h=Math.min(a,e.m),void S(c)):c.return()})}(e.g,n,a?a.startTime:null,a?a.endTime:null),5);case 5:return P.return();case 2:if(u=Ee(n),f=e.L[t],e.o[t]&&(f=e.o[t].o),0>wo(u)?Zo.includes(f)&&(h=xo(u)).length&&a&&(b={cueTime:a.startTime,data:u,frames:h,dts:a.startTime,pts:a.startTime},e.V([b],0,a.endTime)):(p=(new Co).parse(u),m=a.startTime-(p.getStartTime()[t]||0),_=function(e){for(var t=[],n=new Uint8Array(0),a=e.i.length-1;0<=a;a--){var i=Oo(n=Mt(e.i[a],n));i&&(t.unshift({cueTime:i.pts?i.pts/9e4:null,data:i.data,frames:xo(i.data),dts:i.dts,pts:i.pts}),n=new Uint8Array(0))}return t}(p),_.length&&e.V(_,m,a?a.endTime:null)),!e.o[t]){i&&t==s.wa&&(e.g||To(e,"text/vtt",e.B),e.s||(e.s=new uo(f)),a?(g=function(e,t){for(var n=(t=d(t=e.h.parse(t))).next();!n.done;n=t.next()){var a=n.value,i=Ee(a.hg);if(0<i.length&&(n=e.g,a=a.pts,181===(i=new ja(i,0)).Ra()&&49===i.Zd()&&1195456820===i.K()&&3===i.Ra())){var r=i.Ra();if(0!=(64&r)){r&=31,i.skip(1);for(var o=0;o<r;o++){var s=i.Ra(),c=(4&s)>>2,u=i.Ra(),f=i.Ra();c&&(0==(s&=3)||1===s?n.h.push({pts:a,type:s,ya:u,Ma:f,order:n.h.length}):(n.g.push({pts:a,type:s,value:u,order:n.g.length}),n.g.push({pts:a,type:2,value:f,order:n.g.length})))}}}}return function(e){function t(e,t){return e.pts-t.pts||e.order-t.order}var n=[];e.h.sort(t),e.g.sort(t);for(var a=d(e.h),i=a.next();!i.done;i=a.next())(i=Xr(e,i.value))&&n.push(i);for(i=(a=d(e.g)).next();!i.done;i=a.next())Rr(e.i,i.value);for(i=(a=d(e.i.i)).next();!i.done;i=a.next())i=Zr(e,i.value),n.push.apply(n,l(i));return e.i.i=[],e.h=[],e.g=[],n}(e.g)}(e.s,n)).length&&(v=e.h[s.wa].timestampOffset,Xt(e.g,g,a.startTime,a.endTime,v)):e.s.init(n)),P.A(6);break}return r&&e.o[t].g.resetCaptions(),y(P,function(e,t){return e.j=!0,e.h=new at,e.l=[],e.i=[],t=Ee(t),e.g.push(t),e.g.flush(),e.j&&e.h.reject(new ke(2,3,3018)),e.h}(e.o[t],n),7);case 7:D=P.h,e.g||To(e,"text/vtt",e.B),D.captions&&D.captions.length&&(I=e.h[s.wa].timestampOffset,x=function(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())n=n.value,t.push({stream:n.stream,cue:new ie(n.startTime,n.endTime,n.text)});return t}(D.captions),Xt(e.g,x,a?a.startTime:null,a?a.endTime:null,I)),n=D.data;case 6:if(n=function(e,t,n,a){var i=e.O[a];return null==n&&i&&(lt()||dt())&&"mp4"==e.L[a].split(";")[0].split("/")[1]&&(t=function(e){function t(){i=!0}function n(e){r.push(e),Ka(e)}e=Ee(e);var a,i=!1,r=[],o=[];if((new Ga).box("moov",n).box("trak",n).box("mdia",n).box("minf",n).box("stbl",n).P("stsd",function(e){a=e,r.push(e),Wa(e)}).P("encv",t).P("enca",t).P("hev1",function(e){o.push({box:e,nb:1701733238})}).P("hvc1",function(e){o.push({box:e,nb:1701733238})}).P("avc1",function(e){o.push({box:e,nb:1701733238})}).P("avc3",function(e){o.push({box:e,nb:1701733238})}).P("ac-3",function(e){o.push({box:e,nb:1701733217})}).P("ec-3",function(e){o.push({box:e,nb:1701733217})}).P("mp4a",function(e){o.push({box:e,nb:1701733217})}).parse(e),i)return e;if(0==o.length||!a)throw kt(e),new ke(2,3,3019);o.reverse();for(var s=d(o),c=s.next();!c.done;c=s.next())c=c.value,e=Xi(e,a,c.box,r,c.nb);return e}(t)),t}(e,n,a?a.startTime:null,t),C=e.h[t],O=Xo,!e.B||C.mode==O||!a){P.A(8);break}if(t!=s.wa&&s.wa in e.h){P.A(9);break}return w=[C.appendWindowStart,C.appendWindowEnd],C.appendWindowStart=0,C.appendWindowEnd=1/0,E=C.timestampOffset,C.timestampOffset=0,y(P,Wo(e,t,function(){return jo(e,t,n)}),10);case 10:return y(P,Wo(e,t,function(){return zo(e,t)}),11);case 11:return C.timestampOffset=E,C.appendWindowStart=w[0],C.appendWindowEnd=w[1],A=ho(Ro(e,t)),L=(a.startTime||0)-(A||0),e.W.resolve(L),y(P,Wo(e,t,function(){return Vo(e,t,0,e.l.duration)}),12);case 12:if(t!=s.wa){P.A(9);break}return y(P,Wo(e,t,function(){e.j.currentTime-=.001,Ko(e,t)}),9);case 9:C.mode=O;case 8:return a&&e.B&&t!=s.Z&&(r||o)&&(k=a.startTime,Wo(e,t,function(){return zo(e,t)}),Wo(e,t,function(){return Go(e,t,k)})),y(P,Wo(e,t,function(){jo(e,t,n)}),15);case 15:S(P)}})}function Bo(e,t){return M(function(n){return t==tt.Z?e.g?y(n,e.g.remove(0,1/0),0):n.return():y(n,Wo(e,t,function(){return Vo(e,t,0,e.l.duration)}),0)})}function jo(e,t,n){if("video"==t&&e.D){var a=e.D;a.g&&a.g.appendBuffer(n,"video",a.i)}e.h[t].appendBuffer(n)}function Vo(e,t,n,a){a<=n?Ko(e,t):e.h[t].remove(n,a)}function zo(e,t){var n=e.h[t].appendWindowStart,a=e.h[t].appendWindowEnd;e.h[t].abort(),e.h[t].appendWindowStart=n,e.h[t].appendWindowEnd=a,Ko(e,t)}function Go(e,t,n){0>n&&(n+=.001),e.h[t].timestampOffset=n,Ko(e,t)}function Ko(e,t){var n=e.i[t][0];n&&(n.p.resolve(),Qo(e,t))}function Wo(e,t,n){return Pa(e.G),n={start:n,p:new at},e.i[t].push(n),1==e.i[t].length&&Yo(e,t),n.p}function qo(e,t){var n,a,i,r,o;return M(function(s){switch(s.g){case 1:for(i in Pa(e.G),n=[],a={},e.h)a.Ub=new at,r={start:function(e){return function(){return e.Ub.resolve()}}(a),p:a.Ub},e.i[i].push(r),n.push(a.Ub),1==e.i[i].length&&r.start(),a={Ub:a.Ub};return D(s,2),y(s,Promise.all(n),4);case 4:x(s,3);break;case 2:throw C(s);case 3:try{t()}catch(e){throw new ke(2,3,3015,e)}finally{for(o in e.h)Qo(e,o)}S(s)}})}function Qo(e,t){e.i[t].shift(),Yo(e,t)}function Yo(e,t){var n=e.i[t][0];if(n)try{n.start()}catch(a){"QuotaExceededError"==a.name?n.p.reject(new ke(2,3,3017,t)):n.p.reject(new ke(2,3,3015,a)),Qo(e,t)}}(a=Po.prototype).destroy=function(){return this.G.destroy()},a.init=function(e,t,n){n=void 0!==n&&n;var a,i,r,o,s,c,l,u,f=this;return M(function(p){if(1==p.g)return a=tt,y(p,f.J,2);for(f.B=n,i={},r=d(e.keys()),o=r.next();!o.done;i={oa:i.oa},o=r.next())i.oa=o.value,s=e.get(i.oa),c=Vt(s.mimeType,s.codecs),i.oa==a.Z?To(f,c,n):(!t&&Z(c)||!Ht(c,i.oa)||(f.o[i.oa]=new Ft(c),c=Nt(i.oa,c)),l=c+f.F.sourceBufferExtraFeatures,u=f.l.addSourceBuffer(l),f.u.C(u,"error",function(e){return function(){f.i[e.oa][0].p.reject(new ke(2,3,3014,f.j.error?f.j.error.code:0))}}(i)),f.u.C(u,"updateend",function(e){return function(){return Ko(f,e.oa)}}(i)),f.h[i.oa]=u,f.L[i.oa]=c,f.i[i.oa]=[],f.O[i.oa]=!!s.drmInfos.length);S(p)})},a.configure=function(e){this.F=e},a.Na=function(){var e={total:yo(this.j.buffered),audio:yo(Ro(this,"audio")),video:yo(Ro(this,"video")),text:[]};if(this.g){var t=this.g.g,n=this.g.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}return e},a.remove=function(e,t,n){var a=this;return M(function(i){return y(i,e==tt.Z?a.g.remove(t,n):Wo(a,e,function(){return Vo(a,e,t,n)}),0)})},a.flush=function(e){var t=this;return M(function(n){return e==tt.Z?n.return():y(n,Wo(t,e,function(){t.j.currentTime-=.001,Ko(t,e)}),0)})},a.endOfStream=function(e){var t=this;return M(function(n){return y(n,qo(t,function(){Uo(t)||(e?t.l.endOfStream(e):t.l.endOfStream())}),0)})},a.Ia=function(e){var t=this;return M(function(n){return y(n,qo(t,function(){if(e<t.l.duration)for(var n in t.h){var a={start:function(){},p:new at};t.i[n].unshift(a)}t.l.duration=e}),0)})},a.getDuration=function(){return this.l.duration};var Jo=e.URL.createObjectURL,Xo="sequence",Zo=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function $o(e,t,n){this.i=e,this.m=t,this.o=this.j=1/0,this.g=1,this.h=this.l=null,this.s=0,this.u=!0,this.B=0,this.D=void 0===n||n,this.F=0,this.G=!1}function es(e,t,n){this.l=n,this.j=e,this.s=ns(e),this.g=e.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.u=t,this.i=function(){}}function ts(e){this.g=e}function ns(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.currentTime;for(var n=(e=d(yo(e.g.buffered))).next();!n.done;n=e.next())if(!(t<(n=n.value).start-.1||t>n.end-.5)){t=!0;break e}t=!1}return t}function as(e,t,n,a,i){var r=this;this.o=i,this.g=e,this.s=t,this.D=n,this.i=new Ta,this.m=!1,this.B=e.readyState,this.u=0,this.h=a,this.l=!1,this.i.C(e,"waiting",function(){return is(r)}),this.j=new ot(function(){is(r)}).Ca(.25)}function is(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.m)return}else e.m=!1;if(!e.g.paused||0==e.g.currentTime&&(e.g.autoplay||0!=e.g.currentTime)){var t;if(e.g.readyState!=e.B&&(e.B=e.g.readyState),!(t=!e.h)){var n=(t=e.h).j,a=ns(n),i=n.g.currentTime,r=Date.now()/1e3;t.g==i&&t.s==a||(t.m=r,t.g=i,t.s=a,t.h=!1),(a=(i=r-t.m)>=t.u&&a&&!t.h)&&(t.i(t.g,i),t.h=!0,t.g=n.g.currentTime,t.o++,t.l(new _a("stalldetected"))),t=!a}t&&(t=e.g.currentTime,a=function(e,t,n){return!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)?null:0<=(e=yo(e).findIndex(function(e,a,i){return e.start>t&&(0==a||i[a-1].end-t<=n)}))?e:null}(n=e.g.buffered,t,e.D.gapDetectionThreshold),null==a||0==a&&!e.l||(i=n.start(a))>=e.s.Oa()||.001>i-t||(0!=a&&n.end(a-1),e.g.currentTime=i,e.u++,e.o(new _a("gapjumped"))))}}}function rs(e,t,n,a){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?a():(t=os.value().get(t),n.ma(e,t,a))}(a=$o.prototype).getDuration=function(){return this.j},a.Jf=function(){return this.g},a.We=function(e){this.i=e},a.Ia=function(e){this.j=e},a.Of=function(){return this.i},a.Ue=function(e){this.s=e},a.yc=function(e){this.u=e},a.le=function(e){this.o=e},a.Ve=function(e){this.m=e},a.Cf=function(){return this.m},a.Ib=function(e){if(0!=e.length){for(var t=e[0].startTime,n=e[0].endTime,a=(e=d(e)).next();!a.done;a=e.next())a=a.value,t=Math.min(t,a.startTime),n=Math.max(n,a.endTime),this.g=Math.max(this.g,a.endTime-a.startTime);this.Sd(t),this.h=Math.max(this.h,n),null!=this.i&&this.D&&!this.G&&(this.i=(Date.now()+this.s)/1e3-this.h-this.g)}},a.Md=function(){this.G=!0},a.Sd=function(e){this.l=null==this.l?e:Math.min(this.l,e)},a.Rd=function(e){this.g=Math.max(this.g,e)},a.offset=function(e){null!=this.l&&(this.l+=e),null!=this.h&&(this.h+=e)},a.T=function(){return 1/0==this.j&&!this.u},a.lb=function(){return 1/0!=this.j&&!this.u},a.Pa=function(){return Math.max(this.B,this.ib()-this.o)},a.Ye=function(e){this.B=e},a.ib=function(){return this.T()||this.lb()?Math.min(Math.max(0,(Date.now()+this.s)/1e3-this.g-this.i)+this.F,this.j):this.h?Math.min(this.h,this.j):this.j},a.kc=function(e){var t=Math.max(this.l,this.B);return 1/0==this.o?Math.ceil(1e3*t)/1e3:Math.max(t,Math.min(this.ib()-this.o+e,this.Oa()))},a.Db=function(){return this.kc(0)},a.Oa=function(){return Math.max(0,this.ib()-(this.T()||this.lb()?this.m:0))},a.cf=function(){return!(null==this.i||null!=this.h&&this.D)},a.Te=function(e){this.F=e},B("shaka.media.PresentationTimeline",$o),$o.prototype.setAvailabilityTimeOffset=$o.prototype.Te,$o.prototype.usingPresentationStartTime=$o.prototype.cf,$o.prototype.getSeekRangeEnd=$o.prototype.Oa,$o.prototype.getSeekRangeStart=$o.prototype.Db,$o.prototype.getSafeSeekRangeStart=$o.prototype.kc,$o.prototype.getSegmentAvailabilityEnd=$o.prototype.ib,$o.prototype.setUserSeekStart=$o.prototype.Ye,$o.prototype.getSegmentAvailabilityStart=$o.prototype.Pa,$o.prototype.isInProgress=$o.prototype.lb,$o.prototype.isLive=$o.prototype.T,$o.prototype.offset=$o.prototype.offset,$o.prototype.notifyMaxSegmentDuration=$o.prototype.Rd,$o.prototype.notifyMinSegmentStartTime=$o.prototype.Sd,$o.prototype.lockStartTime=$o.prototype.Md,$o.prototype.notifySegments=$o.prototype.Ib,$o.prototype.getDelay=$o.prototype.Cf,$o.prototype.setDelay=$o.prototype.Ve,$o.prototype.setSegmentAvailabilityDuration=$o.prototype.le,$o.prototype.setStatic=$o.prototype.yc,$o.prototype.setClockOffset=$o.prototype.Ue,$o.prototype.getPresentationStartTime=$o.prototype.Of,$o.prototype.setDuration=$o.prototype.Ia,$o.prototype.setPresentationStartTime=$o.prototype.We,$o.prototype.getMaxSegmentDuration=$o.prototype.Jf,$o.prototype.getDuration=$o.prototype.getDuration,es.prototype.release=function(){this.l=this.j=null,this.i=function(){}},as.prototype.release=function(){this.i&&(this.i.release(),this.i=null),null!=this.j&&(this.j.stop(),this.j=null),this.h&&(this.h.release(),this.h=null),this.g=this.s=this.o=null},as.prototype.Vd=function(){this.l=!0,is(this)};var os=new it(function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])});function ss(e,t,n){var a=this;this.g=e,this.l=t,this.j=n,this.m=!1,this.h=new Ta,this.i=new fs(e),rs(this.g,HTMLMediaElement.HAVE_METADATA,this.h,function(){ls(a,a.j)})}function cs(e){return e.m?e.g.currentTime:e.j}function ds(e,t){0<e.g.readyState?ps(e.i,t):rs(e.g,HTMLMediaElement.HAVE_METADATA,e.h,function(){ls(e,e.j)})}function ls(e,t){.001>Math.abs(e.g.currentTime-t)?us(e):(e.h.ma(e.g,"seeking",function(){us(e)}),ps(e.i,0==e.g.currentTime?t:e.g.currentTime))}function us(e){e.m=!0,e.h.C(e.g,"seeking",function(){return e.l()})}function fs(e){var t=this;this.h=e,this.m=10,this.l=this.j=this.i=0,this.g=new ot(function(){0>=t.i||t.h.currentTime!=t.j?t.g.stop():(t.h.currentTime=t.l,t.i--)})}function ps(e,t){e.j=e.h.currentTime,e.l=t,e.i=e.m,e.h.currentTime=t,e.g.Ca(.1)}function ms(e){this.g=e,this.j=!1,this.h=null,this.i=new Ta}function _s(e,t,n,a,i,r){var o=this;this.i=e,this.g=t.presentationTimeline,this.B=t.minBufferTime||0,this.l=n,this.u=i,this.s=null,this.o=function(e,t,n){if(!t.stallEnabled)return null;var a=t.stallSkip;return function(e,t){e.i=t}(t=new es(new ts(e),t.stallThreshold,n),function(){a?e.currentTime+=a:(e.pause(),e.play())}),t}(e,n,r),this.j=new as(e,t.presentationTimeline,n,this.o,r),this.h=new ss(e,function(){var e=o.j;e.m=!0,e.l=!1;var t=cs(o.h);return e=bs(o,t),.001<Math.abs(e-t)&&(t=Date.now()/1e3,!o.s||o.s<t-1)?(o.s=t,ds(o.h,e),e=void 0):(o.u(),e=void 0),e},function(e,t){return null==t?t=1/0>e.g.getDuration()?e.g.Db():e.g.Oa():0>t&&(t=e.g.Oa()+t),hs(e,gs(e,t))}(this,a)),this.m=new ot(function(){if(0!=o.i.readyState&&!o.i.paused){var e=cs(o.h),t=o.g.Db(),n=o.g.Oa();3>n-t&&(t=n-3),e<t&&(e=bs(o,e),o.i.currentTime=e)}})}function hs(e,t){var n=e.g.getDuration();return t>=n?n-e.l.durationBackoff:t}function bs(e,t){var n=Math.max(e.B,e.l.rebufferingGoal),a=e.l.safeSeekOffset,i=e.g.Db(),r=e.g.Oa(),o=e.g.getDuration();3>r-i&&(i=r-3);var s=e.g.kc(n),c=e.g.kc(a);return n=e.g.kc(n+a),t>=o?hs(e,t):t>r?r:t<i?go(e.i.buffered,c)?c:n:t>=s||go(e.i.buffered,t)?t:n}function gs(e,t){var n=e.g.Db();return t<n?n:t>(e=e.g.Oa())?e:t}function vs(e){this.g=e,this.h=null,this.i=0,this.j=!1}function ys(e,t){for(var n=(e=d(e.g)).next();!n.done;n=e.next())t(n.value)}function Ss(e,t,n){return new vs([new po(e,e+t,function(){return n},0,null,null,e,e,e+t)])}function Ds(e,t,n){this.i=e,this.g=t,this.h=n}function Is(){vs.call(this,[]),this.l=[]}function xs(e){var t=this;this.g=e,this.j=!1,this.i=this.g.Uc(),this.h=new ot(function(){t.g.Le(.25*t.i)})}function Cs(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.Uc()!=t&&e.g.ke(t))}catch(e){}e.h.Ca(.25),0!=e.g.Uc()&&e.g.ke(0)}function Os(e){var t=this;this.h=e,this.g=new Set,this.i=new ot(function(){ws(t,!1)}).Ca(.25)}function ws(e,t){for(var n=d(e.g),a=n.next();!a.done;a=n.next())a.value.j(e.h.currentTime,t)}function Es(e){ga.call(this),this.g=new Map,this.h=e}function As(e){ga.call(this);var t=this;this.g=new Set,this.i=e,this.h=new ot(function(){for(var e=t.i(),n=d(t.g),a=n.next();!a.done;a=n.next())(a=a.value).endTime<e.start&&(t.g.delete(a),a=new _a("regionremove",new Map([["region",a]])),t.dispatchEvent(a))}).Ca(2)}function Ls(e){ga.call(this);var t=this;this.i=e,this.g=new Map,this.l=[{ub:null,sb:Ps,kb:function(e,n){return ks(t,"enter",e,n)}},{ub:Ms,sb:Ps,kb:function(e,n){return ks(t,"enter",e,n)}},{ub:Ts,sb:Ps,kb:function(e,n){return ks(t,"enter",e,n)}},{ub:Ps,sb:Ms,kb:function(e,n){return ks(t,"exit",e,n)}},{ub:Ps,sb:Ts,kb:function(e,n){return ks(t,"exit",e,n)}},{ub:Ms,sb:Ts,kb:function(e,n){return ks(t,"skip",e,n)}},{ub:Ts,sb:Ms,kb:function(e,n){return ks(t,"skip",e,n)}}],this.h=new Ta,this.h.C(this.i,"regionremove",function(e){t.g.delete(e.region)})}function ks(e,t,n,a){t=new _a(t,new Map([["region",n],["seeking",a]])),e.dispatchEvent(t)}ss.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.l=function(){},this.g=null},fs.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},(a=ms.prototype).zd=function(){var e=this;rs(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,function(){null==e.h||0==e.h?e.j=!0:(e.i.ma(e.g,"seeking",function(){e.j=!0}),e.g.currentTime=Math.max(0,e.g.currentTime+e.h))})},a.release=function(){this.i&&(this.i.release(),this.i=null),this.g=null},a.Bd=function(e){this.h=this.j?this.h:e},a.Ic=function(){return(this.j?this.g.currentTime:this.h)||0},a.se=function(){return 0},a.re=function(){return 0},a.Me=function(){},(a=_s.prototype).zd=function(){this.m.Ca(.25)},a.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.u=function(){}},a.Bd=function(e){ds(this.h,e)},a.Ic=function(){var e=cs(this.h);return 0<this.i.readyState&&!this.i.paused?gs(this,e):e},a.se=function(){return this.o?this.o.o:0},a.re=function(){return this.j.u},a.Me=function(){this.j.Vd()},(a=vs.prototype).release=function(){this.j||(this.g=[],this.h&&this.h.stop(),this.h=null)},a.bg=function(){this.j=!0},a.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var a=this.g[n],i=n<t?this.g[n+1].startTime:a.endTime;if(e>=a.startTime&&e<i)return n+this.i}return this.g.length&&e<this.g[0].startTime?this.i:null},a.get=function(e){return 0==this.g.length||0>(e-=this.i)||e>=this.g.length?null:this.g[e]},a.offset=function(e){if(!this.j)for(var t=d(this.g),n=t.next();!n.done;n=t.next()){(n=n.value).startTime+=e,n.endTime+=e,n.j+=e;for(var a=(n=d(n.i)).next();!a.done;a=n.next())(a=a.value).startTime+=e,a.endTime+=e,a.j+=e}},a.pc=function(e){!this.j&&e.length&&(this.g=this.g.filter(function(t){return t.startTime<e[0].startTime}),this.g.push.apply(this.g,l(e)))},a.Hb=function(e,t){var n=this;e=e.filter(function(e){return e.endTime>t&&(0==n.g.length||e.endTime>n.g[0].startTime)}),this.pc(e),this.fb(t)},a.fb=function(e){if(!this.j){var t=this.g.length;this.g=this.g.filter(function(t){return t.endTime>e}),this.i+=t-this.g.length}},a.Xa=function(e,t,n){if(n=void 0!==n&&n,!this.j){for(;this.g.length&&this.g[this.g.length-1].startTime>=t;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=e;)this.g.shift(),n||this.i++;0!=this.g.length&&(e=this.g[this.g.length-1],this.g[this.g.length-1]=new po(e.startTime,t,e.u,e.Ba,e.ka,e.h,e.timestampOffset,e.appendWindowStart,e.appendWindowEnd,e.i,e.tilesLayout,e.s,e.g,e.status,e.l))}},a.gd=function(e,t){var n=this;this.j||(this.h&&this.h.stop(),this.h=new ot(function(){var e=t();e?n.g.push.apply(n.g,l(e)):(n.h.stop(),n.h=null)}),this.h.Ca(e))},vs.prototype[Symbol.iterator]=function(){return this.hb(0)},vs.prototype.hb=function(e){var t=this.find(e);if(null==t)return null;t--;var n=this.get(t+1),a=-1;if(n&&0<n.i.length)for(var i=n.i.length-1;0<=i;--i){var r=n.i[i];if(e>=r.startTime&&e<r.endTime){t++,a=i-1;break}}return new Ds(this,t,a)},B("shaka.media.SegmentIndex",vs),vs.forSingleSegment=Ss,vs.prototype.getIteratorForTime=vs.prototype.hb,vs.prototype.updateEvery=vs.prototype.gd,vs.prototype.fit=vs.prototype.Xa,vs.prototype.evict=vs.prototype.fb,vs.prototype.mergeAndEvict=vs.prototype.Hb,vs.prototype.offset=vs.prototype.offset,vs.prototype.get=vs.prototype.get,vs.prototype.find=vs.prototype.find,vs.prototype.markImmutable=vs.prototype.bg,vs.prototype.release=vs.prototype.release,Ds.prototype.uf=function(){return this.g},Ds.prototype.current=function(){var e=this.i.get(this.g);return e&&0<e.i.length&&e.za().length&&this.h>=e.i.length&&(this.g++,this.h=0,e=this.i.get(this.g)),e&&0<e.i.length?e.i[this.h]:e},Ds.prototype.next=function(){var e=this.i.get(this.g);return e&&0<e.i.length?(this.h++,e.za().length&&this.h==e.i.length&&(this.g++,this.h=0)):(this.g++,this.h=0),{value:e=this.current(),done:!e}},B("shaka.media.SegmentIterator",Ds),Ds.prototype.next=Ds.prototype.next,Ds.prototype.current=Ds.prototype.current,Ds.prototype.currentPosition=Ds.prototype.uf,h(Is,vs),(a=Is.prototype).clone=function(){var e=new Is;return e.l=this.l.slice(),e},a.release=function(){for(var e=d(this.l),t=e.next();!t.done;t=e.next())t.value.release();this.l=[]},a.find=function(e){for(var t=0,n=d(this.l),a=n.next();!a.done;a=n.next()){var i=(a=a.value).find(e);if(null!=i)return i+t;t+=a.i+a.g.length}return null},a.get=function(e){for(var t=0,n=d(this.l),a=n.next();!a.done;a=n.next()){var i=(a=a.value).get(e-t);if(i)return i;t+=a.i+a.g.length}return null},a.offset=function(){},a.pc=function(){},a.fb=function(){},a.Hb=function(){},a.Xa=function(){},a.gd=function(){},B("shaka.media.MetaSegmentIndex",Is),Is.prototype.updateEvery=Is.prototype.gd,Is.prototype.fit=Is.prototype.Xa,Is.prototype.mergeAndEvict=Is.prototype.Hb,Is.prototype.evict=Is.prototype.fb,Is.prototype.merge=Is.prototype.pc,Is.prototype.offset=Is.prototype.offset,Is.prototype.get=Is.prototype.get,Is.prototype.find=Is.prototype.find,Is.prototype.release=Is.prototype.release,xs.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},xs.prototype.set=function(e){this.i=e,Cs(this)},xs.prototype.Qc=function(){return this.g.Qc()},Os.prototype.release=function(){this.i.stop();for(var e=d(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},h(Es,ga),Es.prototype.release=function(){this.g.clear(),ga.prototype.release.call(this)},Es.prototype.j=function(e){for(var t=d(this.g.values()),n=t.next();!n.done;n=t.next()){e:{for(var a=(n=n.value).rc,i=a.length-1;0<=i;i--){var r=a[i];if(r.position<=e){a=r.Od;break e}}a=null}if((i=a)&&(i=!((i=n.ye)===a||i&&a&&i.bandwidth==a.bandwidth&&i.audioSamplingRate==a.audioSamplingRate&&i.codecs==a.codecs&&i.contentType==a.contentType&&i.frameRate==a.frameRate&&i.height==a.height&&i.mimeType==a.mimeType&&i.channelsCount==a.channelsCount&&i.pixelAspectRatio==a.pixelAspectRatio&&i.width==a.width)),i)e:{if(i=e,r=a.contentType,(r=this.h()[r])&&0<r.length){var o=r[r.length-1].end;if(i>=r[0].start&&i<o){i=!0;break e}}i=!1}i&&(n.ye=a,JSON.stringify(a),n=new _a("qualitychange",new Map([["quality",a],["position",e]])),this.dispatchEvent(n))}},h(As,ga),As.prototype.release=function(){this.g.clear(),this.h.stop(),ga.prototype.release.call(this)},h(Ls,ga),Ls.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,ga.prototype.release.call(this)},Ls.prototype.j=function(e,t){for(var n=d(this.i.g),a=n.next();!a.done;a=n.next()){a=a.value;var i=this.g.get(a),r=e<a.startTime?Ms:e>a.endTime?Ts:Ps;this.g.set(a,r);for(var o=d(this.l),s=o.next();!s.done;s=o.next())(s=s.value).ub==i&&s.sb==r&&s.kb(a,t)}};var Ms=1,Ps=2,Ts=3;function Us(e,t,n){this.h=e,this.i=t,this.j=0,this.l=n,this.g=new Map}function Fs(e){if(0!==e.g.size){for(var t=d(e.g.keys()),n=t.next();!n.done;n=t.next()){n=n.value;var a=e.g.get(n);e.g.delete(n),a.abort()}e.j=0}}function Hs(e,t,n,a,i){return e=Ca(e,a,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Rs(e,t){var n=this;this.g=t,this.m=e,this.h=null,this.u=1,this.o=this.l=null,this.D=!1,this.i=new Map,this.B=!1,this.F=null,this.s=!1,this.j=new Ma(function(){return function(e){var t,n,a,i;return M(function(r){if(1==r.g){for(t=[],n=d(e.i.values()),a=n.next();!a.done;a=n.next())Zs(i=a.value),t.push($s(i));return y(r,Promise.all(t),2)}e.i.clear(),e.g=null,e.m=null,e.h=null,S(r)})}(n)})}function Ns(e,t){var n=e.i.get("video");if(n){var a=n.stream;a&&(t?(t=a.trickModeVideo)&&!n.qb&&(Vs(e,t,!1,0,!1),n.qb=a):(a=n.qb)&&(n.qb=null,Vs(e,a,!0,0,!1)))}}function Bs(e,t,n,a,i,r){n=void 0!==n&&n,a=void 0===a?0:a,i=void 0!==i&&i,r=void 0!==r&&r,e.l=t,e.B&&(t.video&&Vs(e,t.video,n,a,i,r),t.audio&&Vs(e,t.audio,n,a,i,r))}function js(e,t){e.o=t,e.B&&Vs(e,t,!0,0,!1)}function Vs(e,t,n,a,i,r){var o=e.i.get(t.type);o||t.type!=et?o&&(o.qb&&(t.trickModeVideo?(o.qb=t,t=t.trickModeVideo):o.qb=null),o.stream!=t||i)&&(o.na&&function(e,t){t&&t!==e.i&&(Fs(e),e.i=t)}(o.na,t),t.type==et&&To(e.g.R,Vt(t.mimeType,t.codecs),e.m.sequenceMode),o.stream.closeSegmentIndex&&o.stream.closeSegmentIndex(),o.stream=t,o.Y=null,o.te=!!r,n&&(o.bc?o.jd=!0:o.sa?(o.cb=!0,o.Nc=a,o.jd=!0):(Zs(o),Js(e,o,!0,a).catch(function(t){e.g&&e.g.onError(t)}))),function(e,t){var n,a;return M(function(i){if(1==i.g)return t.ua?(n=t.stream,a=t.ua,n.segmentIndex?i.A(2):y(i,n.createSegmentIndex(),2)):i.return();if(t.ua!=a||t.stream!=n)return i.return();var r=e.g.Tc(),o=Ho(e.g.R,t.type),s=t.stream.segmentIndex.find(t.qa?t.qa.endTime:r),c=null==s?null:t.stream.segmentIndex.get(s);s=c&&c.ka?c.ka-c.Ba:null,c&&!s&&(s=(c.endTime-c.getStartTime())*(t.stream.bandwidth||0)/8),s?((c=c.h)&&(s+=(c.ka?c.ka-c.Ba:null)||0),r=8*s/(c=e.g.getBandwidthEstimate())<(o||0)-r-Math.max(e.m.minBufferTime||0,e.h.rebufferingGoal)||t.ua.h.g>s):r=!1,r&&t.ua.abort(),S(i)})}(e,o).catch(function(t){e.g&&e.g.onError(t)})):function(e,t){var n,a,i,r;M(function(o){switch(o.g){case 1:return n=tt,D(o,2),y(o,Bo(e.g.R,n.Z),4);case 4:x(o,3);break;case 2:a=C(o),e.g&&e.g.onError(a);case 3:i=Vt(t.mimeType,t.codecs),To(e.g.R,i,e.m.sequenceMode),(e.g.R.m.isTextVisible()||e.h.alwaysStreamText)&&(r=Gs(e,t),e.i.set(n.Z,r),Xs(e,r,0)),S(o)}})}(e,t)}function zs(e,t){t.bc||t.cb||(t.sa?(t.cb=!0,t.Nc=0):null==Fo(e.g.R,t.type)?null==t.Ka&&Xs(e,t,0):(Zs(t),Js(e,t,!1,0).catch(function(t){e.g&&e.g.onError(t)})))}function Gs(e,t){return{stream:t,type:t.type,Y:null,na:Ks(e,t),qa:null,$c:null,Kd:null,Jd:null,Id:null,qb:null,endOfStream:!1,sa:!1,Ka:null,cb:!1,Nc:0,jd:!1,bc:!1,vc:!0,ae:!1,nc:!1,ua:null}}function Ks(e,t){var n=null;return 0<e.h.segmentPrefetchLimit&&(n=new Us(e.h.segmentPrefetchLimit,t,function(t,n){return Ys(e,t,n,null)})),n}function Ws(e,t,n,a,i,r){var o,s,c,d,l,u;return M(function(f){switch(f.g){case 1:return o=a.closedCaptions&&0<a.closedCaptions.size,c=null!=a.emsgSchemeIdUris&&0<a.emsgSchemeIdUris.length||e.h.dispatchAllEmsgBoxes,d=e.h.parsePrftBox&&!e.D,(c||d)&&(s=new Ga),c&&s.P("emsg",function(t){var n=a.emsgSchemeIdUris;if(0===t.version)var r=t.reader.sc(),o=t.reader.sc(),s=t.reader.K(),c=t.reader.K(),d=t.reader.K(),l=t.reader.K(),u=i.startTime+c/s;else s=t.reader.K(),c=(u=t.reader.ab()/s+i.timestampOffset)-i.startTime,d=t.reader.K(),l=t.reader.K(),r=t.reader.sc(),o=t.reader.sc();t=t.reader.$a(t.reader.S.byteLength-t.reader.$()),(n&&n.includes(r)||e.h.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==r?e.g.fg():"https://aomedia.org/emsg/ID3"==r?(n=xo(t)).length&&i&&e.g.gg([{cueTime:i.startTime,data:t,frames:n,dts:i.startTime,pts:i.startTime}],0,i.endTime):(n=new _a("emsg",n=(new Map).set("detail",{startTime:u,endTime:u+d/s,schemeIdUri:r,value:o,timescale:s,presentationTimeDelta:c,eventDuration:d,id:l,messageData:t})),e.g.onEvent(n)))}),d&&s.P("prft",function(t){e:{if(!e.D&&i.h.timescale){t.reader.K();var n=t.reader.K();if(n=1e3*n+t.reader.K()/Math.pow(2,32)*1e3,0===t.version)var a=t.reader.K();else try{a=t.reader.ab()}catch(t){e.D=!0,a=void 0;break e}t=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+n).getTime(),a=new _a("prft",a=(new Map).set("detail",{wallClockTime:t,programStartDate:new Date(t-a/i.h.timescale*1e3)})),e.g.onEvent(a),e.D=!0}a=void 0}return a}),(c||d)&&s.parse(r),y(f,function(e,t,n){var a,i,r;return M(function(o){if(1==o.g)return a=Math.max(e.h.bufferBehind,e.m.presentationTimeline.g),null==(i=Fo(e.g.R,t.type))||.01>=(r=n-i-a)?o.return():y(o,e.g.R.remove(t.type,i,i+r),2);Pa(e.j),S(o)})}(e,t,n),2);case 2:return Pa(e.j),l=t.vc,t.vc=!1,u=t.te,t.te=!1,y(f,e.g.ve(t.type,r),3);case 3:return y(f,No(e.g.R,t.type,r,i,o,l,u),4);case 4:Pa(e.j),S(f)}})}function qs(e){return e&&e.type==et&&("application/cea-608"==e.stream.mimeType||"application/cea-708"==e.stream.mimeType)}function Qs(e,t,n,a){var i,r;return M(function(o){if(1==o.g){if(i=null,t.na){var s=t.na,c=null;n instanceof po&&0<s.h?(s.g.has(n)&&(c=s.g.get(n),s.g.delete(n)),i=c):i=null}return i||(i=Ys(e,n,t.stream,a)),t.ua=i,y(o,i.promise,2)}return r=o.h,t.ua=null,o.return(r.data)})}function Ys(e,t,n,a){a=Hs(t.za(),t.Ba,t.ka,e.h.retryParameters,a);var i=0;return t instanceof po&&(i=t.endTime-t.startTime),e.g.modifySegmentRequest(a,{type:n.type,init:t instanceof fo,duration:i,mimeType:n.mimeType,codecs:n.codecs,bandwidth:n.bandwidth}),e.g.mb.request(Aa,a)}function Js(e,t,n,a){var i,r;return M(function(o){return 1==o.g?(t.cb=!1,t.jd=!1,t.Nc=0,t.bc=!0,t.qa=null,t.$c=null,t.Y=null,t.na&&Fs(t.na),a?(i=e.g.Tc(),r=e.g.R.getDuration(),y(o,e.g.R.remove(t.type,i+a,r),3)):y(o,Bo(e.g.R,t.type),4)):3!=o.g?(Pa(e.j),n?y(o,e.g.R.flush(t.type),3):o.A(3)):(t.na&&Fs(t.na),Pa(e.j),t.bc=!1,t.endOfStream=!1,t.sa||t.Ka||Xs(e,t,0),void S(o))})}function Xs(t,n,a){var i=n.type;(i!=et||t.i.has(i))&&(n.Ka=new rt(function(){var a;return M(function(i){return 1==i.g?(D(i,2),y(i,function(t,n){var a,i,r,o,s;return M(function(c){switch(c.g){case 1:if(Pa(t.j),n.sa||null==n.Ka||n.bc)return c.return();if(n.Ka=null,!n.cb){c.A(2);break}return y(c,Js(t,n,n.jd,n.Nc),3);case 3:return c.return();case 2:if(n.stream.segmentIndex){c.A(4);break}return a=n.stream,y(c,n.stream.createSegmentIndex(),5);case 5:if(a!=n.stream)return a.closeSegmentIndex&&a.closeSegmentIndex(),n.sa||n.Ka||Xs(t,n,0),c.return();case 4:D(c,6),i=function(t,n){if(qs(n))return function(e,t){var n=Ho(e,"video")||0;Yt(e.g,t,n)}(t.g.R,n.stream.originalId||""),null;n.type==et&&function(e){e.g&&Yt(e.g,"",0)}(t.g.R);var a=t.g.Tc(),i=n.qa?n.qa.endTime:a,r=function(e,t,n){return t==et?null==(e=e.g).h||e.h<n?0:e.h-Math.max(n,e.g):vo(e=Ro(e,t),n)}(t.g.R,n.type,a),o=Math.max(t.m.minBufferTime||0,t.h.rebufferingGoal,t.h.bufferingGoal)*t.u,s=t.m.presentationTimeline.getDuration()-i,c=Ho(t.g.R,n.type);if(1e-6>s&&c)return n.endOfStream=!0,"video"==n.type&&(t=t.i.get(et))&&qs(t)&&(t.endOfStream=!0),null;if(n.endOfStream=!1,r>=o)return t.h.updateIntervalSeconds/2;if(r=function(e,t,n,a){if(t.Y)return t.Y.current();if(t.qa||a)return t.Y=t.stream.segmentIndex.hb(t.qa?t.qa.endTime:a),t.Y&&t.Y.next().value;e=e.h.inaccurateManifestTolerance,a=Math.max(n-e,0);var i=null;return e&&(t.Y=t.stream.segmentIndex.hb(a),i=t.Y&&t.Y.next().value),i||(t.Y=t.stream.segmentIndex.hb(n),i=t.Y&&t.Y.next().value),i}(t,n,a,c),!r)return t.h.updateIntervalSeconds;for(o=1/0,c=(s=d(s=Array.from(t.i.values()))).next();!c.done;c=s.next())qs(c=c.value)||c.Y&&!c.Y.current()||(o=Math.min(o,c.qa?c.qa.endTime:a));return i>=o+t.m.presentationTimeline.g?t.h.updateIntervalSeconds:(n.na&&n.Y&&function(e,t){if(0<e.h&&e.i.segmentIndex)for(var n=e.i.segmentIndex.hb(Math.max(t.startTime,e.j));e.g.size<e.h&&null!=t;){if(!e.g.has(t)){var a=e.l(t,e.i);e.g.set(t,a)}e.j=t.startTime,t=n.next().value}}(n.na,r),function(t,n,a,i){var r,o,s,c,d,l,u,f,p,m,_,h,b,g;return M(function(v){switch(v.g){case 1:if(r=tt,o=n.stream,s=n.Y,n.sa=!0,D(v,2),2==i.Eb())throw new ke(1,1,1011);return y(v,function(e,t,n){var a,i,r,o,s,c,d,l;return M(function(u){return a=[],i=Math.max(0,n.appendWindowStart-.1),r=n.appendWindowEnd+.01,(o=n.timestampOffset)==t.Kd&&i==t.Jd&&r==t.Id||(s=function(){var n;return M(function(a){if(1==a.g)return D(a,2),t.Jd=i,t.Id=r,t.Kd=o,y(a,function(e,t,n,a,i,r){return M(function(o){return t==tt.Z?(r||(e.g.s=n),function(e,t,n){e.l=t,e.m=n}(e.g,a,i),o.return()):y(o,Promise.all([Wo(e,t,function(){return zo(e,t)}),r?Promise.resolve():Wo(e,t,function(){return Go(e,t,n)}),Wo(e,t,function(){e.h[t].appendWindowStart=0,e.h[t].appendWindowEnd=i,e.h[t].appendWindowStart=a,Ko(e,t)})]),0)})}(e.g.R,t.type,o,i,r,e.m.sequenceMode),4);if(2!=a.g)return x(a,0);throw n=C(a),t.Jd=null,t.Id=null,t.Kd=null,n})},a.push(s())),!function(e,t){return e&&t?e.lc()==t.lc()&&e.hc()==t.hc()&&ae(e.za(),t.za()):e==t}(n.h,t.$c)&&(t.$c=n.h)&&(c=Qs(e,t,n.h),d=function(){var a,i,r;return M(function(o){switch(o.g){case 1:return D(o,2),y(o,c,4);case 4:return a=o.h,Pa(e.j),(new Ga).box("moov",Ka).box("trak",Ka).box("mdia",Ka).P("mdhd",function(e){e=ao(e.reader||0,e.version||0),n.h.timescale=e.timescale}).parse(a),i=t.stream.closedCaptions&&0<t.stream.closedCaptions.size,y(o,e.g.ve(t.type,a),5);case 5:return y(o,No(e.g.R,t.type,a,null,i),6);case 6:x(o,0);break;case 2:throw r=C(o),t.$c=null,r}})},e.g.eg(n.startTime,n.h),a.push(d())),e.m.sequenceMode&&(l=t.qa?t.qa.m:null,n.m!=l&&a.push(function(e,t,n){return M(function(a){return y(a,Wo(e,t,function(){return Go(e,t,n)}),0)})}(e.g.R,t.type,n.startTime))),y(u,Promise.all(a),0)})}(t,n,i),4);case 4:return Pa(t.j),t.s?v.return():(c="video/mp4"==o.mimeType||"audio/mp4"==o.mimeType,d=e.ReadableStream,t.h.lowLatencyMode&&d&&c&&!i.l?(u=new Uint8Array(0),p=f=!1,m=function(e){var r,s,c;return M(function(d){return f?d.return():(p=!0,Pa(t.j),t.s?d.return():(u=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(u,e),r=!1,s=0,(new Ga).box("mdat",function(e){s=e.size+e.start,r=!0}).parse(u,!1,!0),r?(c=u.subarray(0,s),u=u.subarray(s),y(d,Ws(t,n,a,o,i,c),0)):d.A(0)))})},y(v,Qs(t,n,i,m),11)):y(v,Qs(t,n,i),7));case 7:if(l=v.h,Pa(t.j),t.s)return v.return();if(!i.l){v.A(8);break}return y(v,function(t,n,a){var i,r,o,s;return M(function(c){if(1==c.g)return(i=n.l).cryptoKey?c.A(2):y(c,i.fetchKey(),3);if(!(r=i.iv))for(r=Ee(new ArrayBuffer(16)),o=i.firstMediaSequenceNumber+a.g,s=r.byteLength-1;0<=s;s--)r[s]=255&o,o>>=8;return c.return(e.crypto.subtle.decrypt({name:"AES-CBC",iv:r},i.cryptoKey,t))})}(l,i,s),9);case 9:l=v.h;case 8:return Pa(t.j),n.cb?(n.sa=!1,Xs(t,n,0),v.return()):y(v,Ws(t,n,a,o,i,l),6);case 11:if(_=v.h,p){v.A(6);break}return f=!0,Pa(t.j),t.s?v.return():n.cb?(n.sa=!1,Xs(t,n,0),v.return()):y(v,Ws(t,n,a,o,i,_),6);case 6:if(Pa(t.j),t.s)return v.return();n.qa=i,s.next(),n.sa=!1,n.ae=!1,h=t.g.R.Na(),b=h[n.type],JSON.stringify(b),n.cb||t.g.Vd(i.startTime,i.endTime,n.type),Xs(t,n,0),x(v,0);break;case 2:if(g=C(v),Pa(t.j,g),t.s)return v.return();if(n.sa=!1,7001==g.code)n.sa=!1,Zs(n),Xs(t,n,0),v.A(0);else if(n.type==r.Z&&t.h.ignoreTextStreamFailures)t.i.delete(r.Z),v.A(0);else{if(3017!=g.code)return n.nc=!0,g.severity=2,y(v,ec(t,g),0);(function(e,t,n){if(!Array.from(e.i.values()).some(function(e){return e!=t&&e.ae})){var a=Math.round(100*e.u);if(20<a)e.u-=.2;else{if(!(4<a))return t.nc=!0,e.s=!0,void e.g.onError(n);e.u-=.04}t.ae=!0}Xs(e,t,4)})(t,n,g),v.A(0)}}})}(t,n,a,r).catch(function(){}),null)}(t,n),null!=i&&(Xs(t,n,i),n.nc=!1),x(c,7);break;case 6:return r=C(c),y(c,ec(t,r),8);case 8:return c.return();case 7:if(o=Array.from(t.i.values()),!t.B||!o.every(function(e){return e.endOfStream})){c.A(0);break}return y(c,t.g.R.endOfStream(),10);case 10:Pa(t.j),0!=(s=t.g.R.getDuration())&&s<t.m.presentationTimeline.getDuration()&&t.m.presentationTimeline.Ia(s),S(c)}})}(t,n),4)):2!=i.g?x(i,0):(a=C(i),t.g&&t.g.onError(a),void S(i))})}).N(a))}function Zs(e){null!=e.Ka&&(e.Ka.stop(),e.Ka=null)}function $s(e){return M(function(t){return e.ua?y(t,e.ua.abort(),0):t.A(0)})}function ec(e,t){return M(function(n){if(1==n.g)return y(n,ca(e.F),2);Pa(e.j),e.g.onError(t),t.handled||e.h.failureCallback(t),S(n)})}function tc(e,t){var n=this;this.j=t,this.i=e,this.l={mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null},this.o=null,this.m=[],this.h=this.g=null,this.u=Promise.resolve().then(function(){return function(e){return M(function(t){if(e.s.g)t=t.A(0);else{if(0==e.m.length||e.g&&!e.g.jb)var n=!1;else{e.g&&(e.g.Ha.ob(),e.g=null);var a=(n=e.m.shift()).create(e.l);a?(n.Ha.Jb(),e.g={node:a.node,payload:a.payload,jb:a.jb,Ha:n.Ha}):n.Ha.ed(),n=!0}n?n=Promise.resolve():e.g?n=function(e){var t,n;return M(function(a){switch(a.g){case 1:return e.i=e.j.Lf(e.i,e.l,e.g.node,e.g.payload),D(a,2),e.h=e.j.xf(e.i,e.l,e.g.payload),y(a,e.h.promise,4);case 4:e.h=null,e.i==e.g.node&&(e.g.Ha.cd(),e.g=null),x(a,0);break;case 2:return 7001==(t=C(a)).code?e.g.Ha.ob():e.g.Ha.onError(t),e.g=null,e.h=null,n=e,y(a,e.j.handleError(e.l,t),5);case 5:n.i=a.h,S(a)}})}(e):(e.j.dg(e.i),e.o=new at,n=e.o),t=y(t,n,1)}return t})}(n)}),this.s=new Ma(function(){return function(e){var t,n;return M(function(a){if(1==a.g)return e.h&&e.h.abort(),ac(e),y(a,e.u,2);for(e.g&&e.g.Ha.ob(),t=d(e.m),n=t.next();!n.done;n=t.next())n.value.Ha.ob();e.g=null,e.m=[],e.j=null,S(a)})}(n)})}function nc(e,t){var n={Jb:function(){},cd:function(){},ob:function(){},onError:function(){},ed:function(){},vh:function(){}};return e.m.push({create:t,Ha:n}),e.h&&e.h.abort(),ac(e),n}function ac(e){e.o&&(e.o.resolve(),e.o=null)}function ic(e){this.g=null;for(var t=d(Array.from(e.textTracks)),n=t.next();!n.done;n=t.next())(n=n.value).mode="disabled","Shaka Player TextTrack"==n.label&&(this.g=n);this.g||(this.g=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.g.mode="hidden"}function rc(e){if(e.startTime>=e.endTime)return null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function oc(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var a=d(Array.from(e.cues)),i=a.next();!i.done;i=a.next())(i=i.value)&&t(i)&&e.removeCue(i);e.mode=n}function sc(){}function cc(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function dc(t,n){var a=this;this.j=!1,this.i=[],this.B=t,this.m=n,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.m.appendChild(this.g),this.u=new ot(function(){fc(a)}).Ca(.25),this.h=new Map,this.s=new Ta,this.s.C(document,"fullscreenchange",function(){fc(a,!0)}),this.l=null,"ResizeObserver"in e&&(this.l=new ResizeObserver(function(){fc(a,!0)}),this.l.observe(this.g)),this.o=new Map}function lc(e,t){for(;null!=t;){if(t==e.g)return!0;t=t.parentElement}return!1}function uc(e,t,n,a,i){for(var r=!1,o=[],s=[],c=(t=d(t)).next();!c.done;c=t.next()){c=c.value,i.push(c);var l=e.h.get(c),u=c.startTime<=a&&c.endTime>a,f=l?l.df:null;l&&(o.push(l.Cd),l.tc&&o.push(l.tc),u||(r=!0,e.h.delete(c),l=null)),u&&(s.push(c),l?lc(e,f)||(r=!0):(pc(e,c,i),f=(l=e.h.get(c)).df,r=!0)),0<c.nestedCues.length&&f&&uc(e,c.nestedCues,f,a,i),i.pop()}if(r){for(i=(a=d(o)).next();!i.done;i=a.next())(i=i.value).parentElement&&i.parentElement.removeChild(i);for(s.sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime-t.endTime}),c=(s=d(s)).next();!c.done;c=s.next())(a=e.h.get(c.value)).tc?(n.appendChild(a.tc),a.tc.appendChild(a.Cd)):n.appendChild(a.Cd)}}function fc(e,t){if(e.g){var n=e.B.currentTime;if(!e.j||void 0!==t&&t){for(var a=(t=d(e.o.values())).next();!a.done;a=t.next())cc(a.value);cc(e.g),e.h.clear(),e.o.clear()}if(e.j){t=new Map;for(var i=(a=d(e.h.keys())).next();!i.done;i=a.next())i=i.value,t.set(i,e.h.get(i));uc(e,e.i,e.g,n,[])}}}function pc(e,t,n){var a=1<n.length,i=a?"span":"div";t.lineBreak&&(i="br"),a=!a&&0<t.nestedCues.length;var r=document.createElement(i);if("br"!=i&&function(e,t,n,a,i){var r=t.style,o=0==n.nestedCues.length,s=1<a.length;r.whiteSpace="pre-wrap";var c=n.payload.replace(/\s+$/g,function(e){return" ".repeat(e.length)});if(r.webkitTextStrokeColor=n.textStrokeColor,r.webkitTextStrokeWidth=n.textStrokeWidth,r.color=n.color,r.direction=n.direction,r.opacity=n.opacity,r.paddingLeft=mc(n.linePadding,n,e.m),r.paddingRight=mc(n.linePadding,n,e.m),r.textShadow=n.textShadow,n.backgroundImage)r.backgroundImage="url('"+n.backgroundImage+"')",r.backgroundRepeat="no-repeat",r.backgroundSize="contain",r.backgroundPosition="center",r.width="100%",r.height="100%";else{if(n.nestedCues.length)var d=t;else d=document.createElement("span"),t.appendChild(d);n.border&&(d.style.border=n.border),i||((t=function(e,t){for(var n=e.length-1;0<=n;n--){var a=e[n].backgroundColor;if(a||0===a)return a}return null}(a))?d.style.backgroundColor=t:c&&(d.style.backgroundColor="rgba(0, 0, 0, 0.8)")),c&&(d.textContent=c)}s&&!a[a.length-1].isContainer?r.display="inline":(r.display="flex",r.flexDirection="column",r.alignItems="center",r.justifyContent="before"==n.displayAlign?"flex-start":"center"==n.displayAlign?"center":"flex-end"),o||(r.margin="0"),r.fontFamily=n.fontFamily,r.fontWeight=n.fontWeight.toString(),r.fontStyle=n.fontStyle,r.letterSpacing=n.letterSpacing,r.fontSize=mc(n.fontSize,n,e.m),null!=n.line&&1==n.lineInterpretation&&(r.position="absolute",r.left="0",r.top="0",n.writingMode==fe?(r.width="100%",n.lineAlign==me?r.top=n.line+"%":"end"==n.lineAlign&&(r.bottom=100-n.line+"%")):"vertical-lr"==n.writingMode?(r.height="100%",n.lineAlign==me?r.left=n.line+"%":"end"==n.lineAlign&&(r.right=100-n.line+"%")):(r.height="100%",n.lineAlign==me?r.right=n.line+"%":"end"==n.lineAlign&&(r.left=100-n.line+"%"))),r.lineHeight=n.lineHeight,null!=n.position&&(n.writingMode==fe?r.paddingLeft=n.position:r.paddingTop=n.position),"line-left"==n.positionAlign?r.cssFloat="left":"line-right"==n.positionAlign&&(r.cssFloat="right"),r.textAlign=n.textAlign,r.textDecoration=n.textDecoration.join(" "),r.writingMode=n.writingMode,"writingMode"in document.documentElement.style&&r.writingMode==n.writingMode||(r.webkitWritingMode=n.writingMode),n.size&&(n.writingMode==fe?r.width=n.size+"%":r.height=n.size+"%")}(e,r,t,n,a),n=null,t.region&&t.region.id)if(n=t.region,e.o.has(n.id))n=e.o.get(n.id);else{i=document.createElement("span");var o=n.heightUnits==De?"%":"px",s=n.widthUnits==De?"%":"px",c=n.viewportAnchorUnits==De?"%":"px";i.id="shaka-text-region---"+n.id,i.classList.add("shaka-text-region"),i.style.height=n.height+o,i.style.width=n.width+s,i.style.position="absolute",i.style.top=n.viewportAnchorY+c,i.style.left=n.viewportAnchorX+c,i.style.display="flex",i.style.flexDirection="column",i.style.alignItems="center",i.style.justifyContent="before"==t.displayAlign?"flex-start":"center"==t.displayAlign?"center":"flex-end",e.o.set(n.id,i),n=i}i=r,a&&((i=document.createElement("span")).classList.add("shaka-text-wrapper"),i.style.backgroundColor=t.backgroundColor,r.appendChild(i)),e.h.set(t,{Cd:r,df:i,tc:n})}function mc(e,t,n){var a=(a=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(e))?{value:Number(a[1]),unit:a[2]}:null;if(!a)return e;var i=a.value;switch(a.unit){case"%":return i/100*n.clientHeight/t.cellResolution.rows+"px";case"c":return n.clientHeight*i/t.cellResolution.rows+"px";default:return e}}function _c(e,t){this.h=e,this.g=t,this.j="",this.o=void 0,this.i=!1,this.m=!0,this.l=!1}function hc(e,t,n){try{if(e.g.enabled){var a={d:1e3*n.duration,st:e.h.T()?Ec:wc};a.ot=function(e){var t=e.type;return e.init?xc:"video"==t?e.codecs.includes(",")?Ic:Dc:"audio"==t?Sc:"text"==t?"application/mp4"===e.mimeType?Oc:Cc:void 0}(n);var i=a.ot===Dc||a.ot===Sc||a.ot===Ic||a.ot===Oc;i&&(a.bl=function(e,t){if(!(t=e.h.Na()[t]).length)return NaN;var n=e.h.getCurrentTime();return(e=t.find(function(e){return e.start<=n&&e.end>=n}))?1e3*(e.end-n):NaN}(e,n.type)),n.bandwidth&&(a.br=n.bandwidth/1e3),i&&a.ot!==Oc&&(a.tb=function(e,t){var n=e.h.Ya();if(!n.length)return NaN;e=n[0];for(var a=(n=d(n)).next();!a.done;a=n.next())"variant"===(a=a.value).type&&a.bandwidth>e.bandwidth&&(e=a);switch(t){case Dc:return e.videoBandwidth||NaN;case Sc:return e.audioBandwidth||NaN;default:return e.bandwidth}}(e,a.ot)/1e3),gc(e,t,a)}}catch(e){q("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",e)}}function bc(t){return t.j||(t.j=t.g.sessionId||e.crypto.randomUUID()),{v:1,sf:t.o,sid:t.j,cid:t.g.contentId,mtp:t.h.getBandwidthEstimate()/1e3}}function gc(e,t,n){n=void 0===n?{}:n;var a=void 0===a?e.g.useHeaders:a;if(e.g.enabled){Object.assign(n,bc(e)),n.pr=e.h.Sc();var i=n.ot===Dc||n.ot===Ic;if(e.l&&i&&(n.bs=!0,n.su=!0,e.l=!1),null==n.su&&(n.su=e.m),a)e=function(e){for(var t=Object.keys(e),n={},a=["Object","Request","Session","Status"],i=[{},{},{},{}],r={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=(t=d(t)).next();!o.done;o=t.next())i[null!=r[o=o.value]?r[o]:1][o]=e[o];for(e=0;e<i.length;e++)(r=vc(i[e]))&&(n["CMCD-"+a[e]]=r);return n}(n),Object.keys(e).length&&Object.assign(t.headers,e);else{var r=vc(n);r&&(t.uris=t.uris.map(function(e){return yc(e,r)}))}}}function vc(e){function t(e){return 100*n(e/100)}function n(e){return Math.round(e)}for(var a,i=[],r={br:n,d:n,bl:t,dl:t,mtp:t,nor:function(e){return encodeURIComponent(e)},rtp:t,tb:n},o=Object.keys(e||{}).sort(),s=(o=d(o)).next();!s.done;s=o.next()){var c=e[s=s.value];if(a=c,!(Number.isNaN(a)||null==a||""===a||!1===a||"v"===s&&1===c||"pr"==s&&1===c)){var l,u=r[s];u&&(c=u(c)),l="string"==(u=typeof c)&&"ot"!==s&&"sf"!==s&&"st"!==s?s+"="+JSON.stringify(c):"boolean"===u?s:"symbol"===u?s+"="+c.description:s+"="+c,i.push(l)}}return i.join(",")}function yc(e,t){return!t||e.includes("offline:")?e:((e=new Pe(e)).g.set("CMCD",t),e.toString())}(a=Rs.prototype).destroy=function(){return this.j.destroy()},a.configure=function(e){this.h=e,this.F=new sa({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);for(var t=d(this.i.keys()),n=t.next();!n.done;n=t.next())if((n=this.i.get(n.value)).na){var a=n.na,i=e.segmentPrefetchLimit;i!==a.h&&(Fs(a),a.h=i),0<e.segmentPrefetchLimit||(n.na=null)}else 0<e.segmentPrefetchLimit&&(n.na=Ks(this,n.stream))},a.start=function(){var e=this;return M(function(t){if(1==t.g)return y(t,function(e){var t,n,a,i,r,o,s,c,l,u;return M(function(f){if(1==f.g){if(t=tt,!e.l)throw new ke(2,5,5006);return n=new Map,a=new Set,e.l.audio&&(n.set(t.Hc,e.l.audio),a.add(e.l.audio)),e.l.video&&(n.set(t.wa,e.l.video),a.add(e.l.video)),e.o&&(n.set(t.Z,e.o),a.add(e.o)),i=e.g.R,r=e.h.forceTransmux,y(f,i.init(n,r,e.m.sequenceMode),2)}for(Pa(e.j),e.updateDuration(),o=d(n.keys()),s=o.next();!s.done;s=o.next())c=s.value,l=n.get(c),e.i.has(c)||(u=Gs(e,l),e.i.set(c,u),Xs(e,u,0));S(f)})}(e),2);Pa(e.j),e.B=!0,S(t)})},a.vc=function(){if(this.g)for(var e=this.g.Tc(),t=d(this.i.keys()),n=t.next();!n.done;n=t.next()){var a=n.value;(n=this.i.get(a)).Y=null;var i=this.g.R;if(!(i=a==et?null!=(i=i.g).g&&null!=i.h&&e>=i.g&&e<i.h:go(i=Ro(i,a),e))){if((null!=Ho(this.g.R,a)||n.sa)&&zs(this,n),n.ua&&(n.ua.abort(),n.ua=null),a===et&&(a=this.g.R).s)for((a=a.s.g).l=0,a.h=[],a.g=[],(i=a.i).i=[],i.h=[],i.g=0,Jr(a),i=(a=d(a.j.values())).next();!i.done;i=a.next())Kr(i.value);n.vc=!0}}},a.updateDuration=function(){var e=this.m.presentationTimeline.getDuration();1/0>e?this.g.R.Ia(e):this.g.R.Ia(Math.pow(2,32))},tc.prototype.destroy=function(){return this.s.destroy()},(a=ic.prototype).remove=function(e,t){return!!this.g&&(oc(this.g,function(n){return n.startTime<t&&n.endTime>e}),!0)},a.append=function(e){function t(e){var n=[],a=700<=e.fontWeight,i="italic"==e.fontStyle,r=e.textDecoration.includes("underline");return a&&n.push("b"),i&&n.push("i"),r&&n.push("u"),a=n.reduce(function(e,t){return e+"<"+t+">"},""),n=n.reduceRight(function(e,t){return e+"</"+t+">"},""),e.lineBreak?"\n":e.nestedCues.length?e.nestedCues.map(t).join(""):a+e.payload+n}var n=function e(n,a){for(var i=(n=d(n)).next();!i.done;i=n.next())if((i=i.value).isContainer)e(i.nestedCues,a);else{var r=i.clone();r.nestedCues=[],r.payload=t(i),a.push(r)}return a}(e,[]),a=[];e=this.g.cues?Array.from(this.g.cues):[];for(var i={},r=(n=d(n)).next();!r.done;i={vb:i.vb},r=n.next())i.vb=r.value,e.some(function(e){return function(t){return t.startTime==e.vb.startTime&&t.endTime==e.vb.endTime&&t.text==e.vb.payload}}(i))||(r=rc(i.vb))&&a.push(r);for(e=a.slice().sort(function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?a.indexOf(t)-a.indexOf(e):a.indexOf(e)-a.indexOf(t)}),i=(e=d(e)).next();!i.done;i=e.next())this.g.addCue(i.value)},a.destroy=function(){return this.g&&(oc(this.g,function(){return!0}),this.g.mode="disabled"),this.g=null,Promise.resolve()},a.isTextVisible=function(){return"showing"==this.g.mode},a.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"},B("shaka.text.SimpleTextDisplayer",ic),ic.prototype.setTextVisibility=ic.prototype.setTextVisibility,ic.prototype.isTextVisible=ic.prototype.isTextVisible,ic.prototype.destroy=ic.prototype.destroy,ic.prototype.append=ic.prototype.append,ic.prototype.remove=ic.prototype.remove,B("shaka.util.Dom",sc),sc.removeAllChildren=cc,(a=dc.prototype).append=function(e){for(var t=[].concat(l(this.i)),n={},a=(e=d(e)).next();!a.done;n={Cc:n.Cc},a=e.next())n.Cc=a.value,t.some(function(e){return function(t){return re(t,e.Cc)}}(n))||this.i.push(n.Cc);fc(this)},a.destroy=function(){this.m.removeChild(this.g),this.g=null,this.j=!1,this.i=[],this.u&&this.u.stop(),this.h.clear(),this.s&&(this.s.release(),this.s=null),this.l&&(this.l.disconnect(),this.l=null)},a.remove=function(e,t){if(!this.g)return!1;var n=this.i.length;return this.i=this.i.filter(function(n){return n.startTime<e||n.endTime>=t}),fc(this,n>this.i.length),!0},a.isTextVisible=function(){return this.j},a.setTextVisibility=function(e){this.j=e},B("shaka.text.UITextDisplayer",dc),dc.prototype.setTextVisibility=dc.prototype.setTextVisibility,dc.prototype.isTextVisible=dc.prototype.isTextVisible,dc.prototype.remove=dc.prototype.remove,dc.prototype.destroy=dc.prototype.destroy,dc.prototype.append=dc.prototype.append,B("shaka.text.WebVttGenerator",function(){});var Sc="a",Dc="v",Ic="av",xc="i",Cc="c",Oc="tt",wc="v",Ec="l";function Ac(){}function Lc(e,t,n,a,i){var r,o=i in a,s=!0;for(r in t){var c=i+"."+r,d=o?a[i]:n[r];o||r in n?void 0===t[r]?void 0===d||o?delete e[r]:e[r]=va(d):d.constructor==Object&&t[r]&&t[r].constructor==Object?(e[r]||(e[r]=va(d)),c=Lc(e[r],t[r],d,a,c),s=s&&c):typeof t[r]!=typeof d||null==t[r]||"function"!=typeof t[r]&&t[r].constructor!=d.constructor?(K("Invalid config, wrong type for "+c),s=!1):("function"==typeof n[r]&&n[r].length!=t[r].length&&W("Unexpected number of arguments for "+c),e[r]=t[r]):(K("Invalid config, unrecognized key "+c),s=!1)}return s}function kc(e,t){for(var n={},a=n,i=0,r=0;!(0>(i=e.indexOf(".",i)));)0!=i&&"\\"==e[i-1]||(a[r=e.substring(r,i).replace(/\\\./g,".")]={},a=a[r],r=i+1),i+=1;return a[e.substring(r).replace(/\\\./g,".")]=t,n}function Mc(e,t){return e&&t}function Pc(){}function Tc(e){return new Pe(e=Dt(e)).Ga}function Uc(e,t,n){function a(e){Ae(r).setUint32(o,e.byteLength,!0),o+=4,r.set(Ee(e),o),o+=e.byteLength}if(!n||!n.byteLength)throw new ke(2,6,6015);var i;i="string"==typeof t?xt(t,!0):t,e=xt(e=Dt(e),!0);var r=new Uint8Array(12+e.byteLength+i.byteLength+n.byteLength),o=0;return a(e),a(i),a(n),r}function Fc(){}function Hc(){var e=1/0;navigator.connection&&navigator.connection.saveData&&(e=360);var t={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:function(e,t,n){return"com.apple.fps.1_0"==n.keySystem&&"skd"==t&&(t=n.serverCertificate,e=Uc(e,n=Tc(e),t)),e},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:dt()},n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function(e){return Mc([e],e)},sequenceMode:!1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3}},a={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function(e){return Mc([e])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,durationBackoff:1,forceTransmux:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0};(_t("Web0S")||lt()||_t("CrKey"))&&(a.stallSkip=0);var i={trackSelectionCallback:function(e){return M(function(t){return t.return(e)})},downloadSizeCallback:function(e){var t;return M(function(n){return 1==n.g?navigator.storage&&navigator.storage.estimate?y(n,navigator.storage.estimate(),3):n.return(!0):(t=n.h,n.return(t.usage+e<.95*t.quota))})},progressCallback:function(e,t){return Mc([e,t])},usePersistentLicense:!0,numberOfParallelDownloads:5},r={drm:t,manifest:n,streaming:a,mediaSource:{sourceBufferExtraFeatures:""},offline:i,abrFactory:function(){return new Vn},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:e,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1}};return i.trackSelectionCallback=function(e){return M(function(t){return t.return(function(e,t){var n=e.filter(function(e){return"variant"==e.type}),a=[],i=cn(t,n.map(function(e){return e.language}));i&&(a=n.filter(function(e){return an(e.language)==i})),0==a.length&&(a=n.filter(function(e){return e.primary})),0==a.length&&(n.map(function(e){return e.language}),a=n);var r=a.filter(function(e){return e.height&&480>=e.height});for(r.length&&(r.sort(function(e,t){return t.height-e.height}),a=r.filter(function(e){return e.height==r[0].height})),t=[],a.length&&(n=Math.floor(a.length/2),a.sort(function(e,t){return e.bandwidth-t.bandwidth}),t.push(a[n])),a=(e=d(e)).next();!a.done;a=e.next())(a=a.value).type!=et&&"image"!=a.type||t.push(a);return t}(e,r.preferredAudioLanguage))})},r}function Rc(e,t,n){var a={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return Lc(e,t,n||Hc(),a,"")}function Nc(){this.g=null,this.h=[]}function Bc(e,t){if(null==e.g)e.g={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.g.duration=n-e.g.timestamp,e.g.state!=t&&(e.h.push(e.g),e.g={timestamp:n,state:t,duration:0})}}function jc(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var a=(e=d(e.h)).next();!a.done;a=e.next())n+=(a=a.value).state==t?a.duration:0;return n}function Vc(){this.i=this.h=null,this.g=[]}function zc(e,t,n){e.i!=t&&(e.i=t,e.g.push({timestamp:Date.now()/1e3,id:t.id,type:"text",fromAdaptation:n,bandwidth:null}))}function Gc(){this.u=this.B=this.G=this.D=this.s=this.j=this.F=this.m=this.i=this.M=this.O=this.H=this.J=this.L=this.l=this.o=NaN,this.g=new Nc,this.h=new Vc}function Kc(t,n){ga.call(this);var a=this;this.l=jd,this.Pc=this.g=null,this.ia=!1,this.Xc=new Ta,this.Nb=new Ta,this.u=new Ta,this.Xb=this.i=this.Yc=this.J=this.j=this.va=this.L=this.bf=this.V=this.Zc=this.M=this.Vc=this.H=this.yb=this.B=this.G=this.m=this.D=null,this.dc=!1,this.Nd=this.s=null,this.Xd=1e9,this.h=cd(this),this.ec={width:1/0,height:1/0},this.o=null,this.La=new na(this.h.preferredAudioLanguage,this.h.preferredVariantRole,this.h.preferredAudioChannelCount),this.wb=this.h.preferredTextLanguage,this.ac=this.h.preferredTextRole,this.$b=this.h.preferForcedSubs,this.Yb=[],this.fc=null,n&&n(this),this.D=function(e){return new Ia(function(t,n){e.s&&e.s.segmentDownloaded(t,n)},function(t,n,a){t=(new Map).set("headers",t).set("request",n).set("requestType",a),e.dispatchEvent(qc("downloadheadersreceived",t))},function(t,n,a,i){t=(new Map).set("request",t).set("error",n).set("httpResponseCode",a).set("aborted",i),e.dispatchEvent(qc("downloadfailed",t))})}(this),this.D.ie(this.h.streaming.forceHTTPS),this.F=null,qd&&(this.F=qd()),this.Xc.C(e,"online",function(){a.be()}),this.O={name:"detach"},this.W={name:"attach"},this.da={name:"unload"},this.Yd={name:"manifest-parser"},this.Wd={name:"manifest"},this.xb={name:"media-source"},this.Qd={name:"drm-engine"},this.ba={name:"load"},this.ce={name:"src-equals-drm-engine"},this.zb={name:"src-equals"};var i=new Map;i.set(this.W,function(e,t){return pa(function(e,t,n){return null==t.mediaElement&&(t.mediaElement=n.mediaElement,e.Nb.C(t.mediaElement,"error",function(){var t=Ed(e);t&&Od(e,t)})),e.g=t.mediaElement,Promise.resolve()}(a,e,t))}),i.set(this.O,function(e){return e.mediaElement&&(a.Nb.pb(),e.mediaElement=null),a.F&&a.F.release(),a.g=null,pa(e=Promise.resolve())}),i.set(this.da,function(e){return pa(Qc(a,e))}),i.set(this.xb,function(e){return e=function(e,t){var n,a,i,r,o;return M(function(s){if(1==s.g)return n=e.h.textDisplayFactory,a=n(),e.Td=n,i=function(e,t,n,a){return new Po(e,t,n,a)}(t.mediaElement,a,function(t,n,a){Yc(e,t,n,a)},e.L),i.configure(e.h.mediaSource),r=e.h.manifest,o=r.segmentRelativeVttTiming,i.H=o,y(s,i.J,2);e.G=i,S(s)})}(a,e),pa(e)}),i.set(this.Yd,function(e,t){return e=function(e,t,n){var a,i,r,o;return M(function(s){if(1==s.g)return t.mimeType=n.mimeType,t.uri=n.uri,a=t.uri,i=e.D,e.Xb=a,r=e,y(s,Wi(a,i,e.h.manifest.retryParameters,t.mimeType),2);r.Yc=s.h,e.J=e.Yc(),o=va(e.h.manifest),n.mediaElement&&"AUDIO"===n.mediaElement.nodeName&&(o.disableVideo=!0),e.J.configure(o),S(s)})}(a,e,t),pa(e)}),i.set(this.Wd,function(e){return function(e,t){var n=t.uri;t=e.D,e.Zc=new As(function(){return e.uc()}),e.Zc.addEventListener("regionadd",function(t){t=t.region,wd(e,"timelineregionadded",t),e.F&&e.F.onDashTimedMetadata(t)}),e.va=null,e.h.streaming.observeQualityChanges&&(e.va=new Es(function(){return e.Na()}),e.va.addEventListener("qualitychange",function(t){var n=t.quality;t=t.position,n=(new Map).set("mediaQuality",{bandwidth:n.bandwidth,audioSamplingRate:n.audioSamplingRate,codecs:n.codecs,contentType:n.contentType,frameRate:n.frameRate,height:n.height,mimeType:n.mimeType,channelsCount:n.channelsCount,pixelAspectRatio:n.pixelAspectRatio,width:n.width}).set("position",t),e.dispatchEvent(qc("mediaqualitychanged",n))}));var a={networkingEngine:t,modifyManifestRequest:function(t,n){var a=e.V;try{a.g.enabled&&(a.o=n.format,gc(a,t,{ot:"m",su:!a.i}))}catch(e){q("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",e)}},modifySegmentRequest:function(t,n){hc(e.V,t,n)},filter:function(t){return dd(e,t)},makeTextStreamsForClosedCaptions:function(t){return function(e,t){for(var n=new Set,a=d(t.textStreams),i=a.next();!i.done;i=a.next())"application/cea-608"!=(i=i.value).mimeType&&"application/cea-708"!=i.mimeType||n.add(i.originalId);for(i=(a=d(t.variants)).next();!i.done;i=a.next())if((i=i.value.video)&&i.closedCaptions)for(var r=d(i.closedCaptions.keys()),o=r.next();!o.done;o=r.next())if(o=o.value,!n.has(o)){var s=o.startsWith("CC")?"application/cea-608":"application/cea-708",c=new Is;s={id:e.Xd++,originalId:o,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:c,mimeType:s,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:i.closedCaptions.get(o),label:null,type:et,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:i.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},t.textStreams.push(s),n.add(o)}}(e,t)},onTimelineRegionAdded:function(t){var n=e.Zc;e:{for(var a=d(n.g),i=a.next();!i.done;i=a.next())if((i=i.value).schemeIdUri==t.schemeIdUri&&i.id==t.id&&i.startTime==t.startTime&&i.endTime==t.endTime){a=i;break e}a=null}null==a&&(n.g.add(t),t=new _a("regionadd",new Map([["region",t]])),n.dispatchEvent(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return Od(e,t)},isLowLatencyMode:function(){return e.h.streaming.lowLatencyMode},isAutoLowLatencyMode:function(){return e.h.streaming.autoLowLatencyMode},enableLowLatencyMode:function(){e.configure("streaming.lowLatencyMode",!0)},updateDuration:function(){e.j&&e.j.updateDuration()},newDrmInfo:function(t){var n=e.m?e.m.g:null;n&&e.m.u&&ud(e,n.keySystem,t)}},i=Date.now()/1e3;return new da(function(){var t,r,o,s;return M(function(c){if(1==c.g)return t=e,y(c,e.J.start(n,a),2);if(t.i=c.h,r=qc("manifestparsed"),e.dispatchEvent(r),0==e.i.variants.length)throw new ke(2,4,4036);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.variants.some(t)&&(e.variants=e.variants.filter(t))}(e.i),o=Date.now()/1e3,s=o-i,e.o.F=s,S(c)})}(),function(){return e.J.stop()})}(a,e)}),i.set(this.Qd,function(e){return e=function(e,t){var n,a;return M(function(i){return 1==i.g?(n=Date.now()/1e3,a=!0,e.m=Zc(e,{mb:e.D,onError:function(t){Od(e,t)},dd:function(t){Ad(e,t)},onExpirationUpdated:function(t,n){Ld(e,t,n)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&a&&(a=!1,e.o.j=Date.now()/1e3-n,e.L&&(t=e.L).g&&t.h.classList.add("shaka-hidden"))}}),e.m.configure(e.h.drm),y(i,Ii(e.m,e.i.variants,e.i.offlineSessionIds),2)):3!=i.g?y(i,e.m.Zb(t.mediaElement),3):y(i,dd(e,e.i),0)})}(a,e),pa(e)}),i.set(this.ba,function(e,t){return pa(function(e,t,n){var a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v;return M(function(D){switch(D.g){case 1:for(t.startTime=n.startTime,null!=e.fc&&(t.startTime=e.fc,e.fc=null),a=t.mediaElement,i=t.uri,e.Xb=i,e.H=new xs({Uc:function(){return a.playbackRate},Qc:function(){return a.defaultPlaybackRate},ke:function(e){a.playbackRate=e},Le:function(e){a.currentTime+=e}}),r=function(){return md(e)},o=function(){return pd(e)},e.u.C(a,"playing",r),e.u.C(a,"pause",r),e.u.C(a,"ended",r),e.u.C(a,"ratechange",o),function(e,t){if(t.lcevc.enabled){var n=e.Ya();n&&n[0]&&n[0].videoMimeType==Qd.ts&&(navigator.userAgent.match(/Edge?\//)||navigator.userAgent.match(/Edge\//))&&(t.streaming.forceTransmux||W("LCEVC Warning: For MPEG-2 TS decoding the config.streaming.forceTransmux must be enabled.")),Wc(e),null==e.L&&(e.L=new Eo(e.g,e.bf,t.lcevc),e.G&&(e.G.D=e.L))}else Wc(e)}(e,e.h),s=e.h.abrFactory,e.s&&e.Nd==s||(e.Nd=s,e.s=s(),"function"!=typeof e.s.setMediaElement&&(qn("AbrManager","Please use an AbrManager with setMediaElement function."),e.s.setMediaElement=function(){}),e.s.configure(e.h.abr)),e.La=new na(e.h.preferredAudioLanguage,e.h.preferredVariantRole,e.h.preferredAudioChannelCount,e.h.preferredAudioLabel),e.wb=e.h.preferredTextLanguage,e.ac=e.h.preferredTextRole,e.$b=e.h.preferForcedSubs,kd(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd),e.s.init(function(t,n,a){e.j&&t!=e.j.l&&gd(e,t,!0,void 0!==n&&n,void 0===a?0:a)}),e.s.setMediaElement(a),un(e.i,e.h.preferredVideoCodecs,e.h.preferredAudioCodecs,e.h.preferredAudioChannelCount,e.h.preferredDecodingAttributes),e.j=function(e){return new Rs(e.i,{Tc:function(){return e.B?e.B.Ic():0},getBandwidthEstimate:function(){return e.s.getBandwidthEstimate()},modifySegmentRequest:function(t,n){hc(e.V,t,n)},R:e.G,mb:e.D,onError:function(t){return Od(e,t)},onEvent:function(t){return e.dispatchEvent(t)},fg:function(){e.J&&e.J.update&&e.J.update()},Vd:function(t,n,a){e.B&&e.B.Me(),ed(e),t=(new Map).set("start",t).set("end",n).set("contentType",a),e.dispatchEvent(qc("segmentappended",t))},eg:function(t,n){(n=n.Od)&&e.va&&function(e,t,n){var a=function(e,t){var n=e.g.get(t);return n||(n={rc:[],ye:null,contentType:t},e.g.set(t,n)),n}(e,t.contentType);!function(e,t){if((e=e.h()[t.contentType])&&0<e.length){var n=e[0].start,a=e[e.length-1].end,i=t.rc;t.rc=i.filter(function(e,t){return!(e.position<=n&&t+1<i.length&&i[t+1].position<=n||e.position>=a)})}else t.rc=[]}(e,a),e={Od:t,position:n},0<=(t=(a=a.rc).findIndex(function(e){return e.position>=n}))?a.splice(t,a[t].position==n?1:0,e):a.push(e)}(e.va,n,t)},ve:function(t,n){var a=e.m;if(a.h.parseInbandPsshEnabled&&["audio","video"].includes(t)){var i=0,r=d((n=new ei(Ee(n))).data);for(t=r.next();!t.done;t=r.next())i+=t.value.length;if(0==i)a=Promise.resolve();else{for(i=new Uint8Array(i),r=0,t=(n=d(n.data)).next();!t.done;t=n.next())t=t.value,i.set(t,r),r+=t.length;Ei(a,"cenc",i),a=a.o}}else a=Promise.resolve();return a},gg:function(t,n,a){Yc(e,t,n,a)}})}(e),e.j.configure(e.h.streaming),e.l=Vd,a.textTracks&&e.u.C(a.textTracks,"addtrack",function(t){t.track&&"chapters"===(t=t.track).kind&&Xc(e,t)}),e.dispatchEvent(qc("streaming")),c=null,(l=e.j.l)||(c=hd(e)),u=[],p=d([(f=l||c).video,f.audio]),m=p.next();!m.done;m=p.next())(_=m.value)&&!_.segmentIndex&&u.push(_.createSegmentIndex());if(!(0<u.length)){D.A(2);break}return y(D,Promise.all(u),2);case 2:if(e.B=function(e,t){return new _s(e.g,e.i,e.h.streaming,t,function(){e.yb&&ws(e.yb,!0),e.j&&e.j.vc(),e.M&&ed(e)},function(t){return e.dispatchEvent(t)})}(e,t.startTime),e.yb=function(e){var t=new Ls(e.Zc);t.addEventListener("enter",function(t){wd(e,"timelineregionenter",t.region)}),t.addEventListener("exit",function(t){wd(e,"timelineregionexit",t.region)}),t.addEventListener("skip",function(t){var n=t.region;t.seeking||(wd(e,"timelineregionenter",n),wd(e,"timelineregionexit",n))});var n=new Os(e.g);return n.g.add(t),e.va&&n.g.add(e.va),n}(e),h=Math.max(e.i.minBufferTime,e.h.streaming.rebufferingGoal),$c(e,h),l){D.A(4);break}if(gd(e,c,!0,!1,0),!e.h.streaming.startAtSegmentBoundary){D.A(5);break}return b=e.B.Ic(),y(D,function(e,t){var n,a,i,r,o;return M(function(s){return 1==s.g?(n=e.audio,a=e.video,i=function(e,t){var n,a,i;return M(function(r){return 1==r.g?e?y(r,e.createSegmentIndex(),2):r.return(null):(a=(n=e.segmentIndex.hb(t))?n.next().value:null)?(i=a.startTime,r.return(i)):r.return(null)})},y(s,i(n,t),2)):3!=s.g?(r=s.h,y(s,i(a,t),3)):null!=(o=s.h)&&null!=r?s.return(Math.max(o,r)):null!=o?s.return(o):null!=r?s.return(r):s.return(t)})}(c,b),6);case 6:g=D.h,e.B.Bd(g);case 5:yd(e,null,In(c));case 4:return e.B.zd(),e.Fb().find(function(e){return e.active})||((v=Mn(e.i.textStreams,e.wb,e.ac,e.$b)[0]||null)&&zc(e.o.h,v,!0),c&&(v?(c.audio&&function(e,t,n){if(0==e.h.autoShowText)return!1;if(1==e.h.autoShowText)return!0;var a=an(e.h.preferredTextLanguage);return n=an(n.language),2==e.h.autoShowText?en(n,a):3==e.h.autoShowText?(e=an(t.language),en(n,a)&&!en(e,n)):(W("Invalid autoShowText setting!"),!1)}(e,c.audio,v)&&(e.ia=!0),e.ia&&e.G.m.setTextVisibility(!0),xd(e)):e.ia=!1),v&&(e.h.streaming.alwaysStreamText||e.Hd())&&js(e.j,v)),y(D,e.j.start(),7);case 7:e.h.abr.enabled&&(e.s.enable(),Cd(e)),Sn(e.j?e.j.l:null,e.i),Pd(e.i),Sd(e),_d(e),e.i.variants.some(function(e){return e.primary}),e.dc=!0,e.u.ma(a,"loadedmetadata",function(){e.o.m=Date.now()/1e3-n.me}),S(D)}})}(a,e,t))}),i.set(this.ce,function(e,t){return e=function(e,t,n){var a,i,r,o,s,c,d;return M(function(l){return 1==l.g?(a=tt,i=Date.now()/1e3,r=!0,e.m=Zc(e,{mb:e.D,onError:function(t){Od(e,t)},dd:function(t){Ad(e,t)},onExpirationUpdated:function(t,n){Ld(e,t,n)},onEvent:function(t){e.dispatchEvent(t),"drmsessionupdate"==t.type&&r&&(r=!1,e.o.j=Date.now()/1e3-i)}}),e.m.configure(e.h.drm),o=n.uri||"",s=Qi(o),"application/x-mpegurl"==(c=Qd[s])&&ft()&&(c="application/vnd.apple.mpegurl"),c||(c="video/mp4"),d={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:n.mimeType?n.mimeType.split(";")[0]:c,codecs:n.mimeType?Kt(n.mimeType):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",label:null,type:a.wa,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},e.m.V=!0,y(l,Ii(e.m,[d],[]),2)):y(l,e.m.Zb(t.mediaElement),0)})}(a,e,t),pa(e)}),i.set(this.zb,function(e,t){return function(e,t,n){function a(){return md(e)}t.uri=n.uri,t.startTime=n.startTime,e.Xb=t.uri;var i=t.mediaElement;e.B=new ms(i);var r=!1;e.Yb.push(function(){r=!0}),null!=t.startTime&&e.B.Bd(t.startTime),e.H=new xs({Uc:function(){return i.playbackRate},Qc:function(){return i.defaultPlaybackRate},ke:function(e){i.playbackRate=e},Le:function(e){i.currentTime+=e}}),$c(e,e.h.streaming.rebufferingGoal),e.u.C(i,"playing",a),e.u.C(i,"pause",a),e.u.C(i,"ended",a),e.u.C(i,"ratechange",function(){return pd(e)}),"none"!=i.preload&&e.u.ma(i,"loadedmetadata",function(){e.o.m=Date.now()/1e3-n.me}),i.audioTracks&&(e.u.C(i.audioTracks,"addtrack",function(){return Sd(e)}),e.u.C(i.audioTracks,"removetrack",function(){return Sd(e)}),e.u.C(i.audioTracks,"change",function(){return Sd(e)})),i.textTracks&&(e.u.C(i.textTracks,"addtrack",function(t){if(t.track)switch(t=t.track,t.kind){case"metadata":!function(e,t){if("metadata"==t.kind){t.mode="hidden",e.u.C(t,"cuechange",function(){if(t.activeCues)for(var n=d(t.activeCues),a=n.next();!a.done;a=n.next())a=a.value,Jc(e,a.startTime,a.endTime,a.type,a.value),e.F&&e.F.onCueMetadataChange(a.value)});var n=new ot(function(){for(var t=function(e){return Array.from(e.g.textTracks).filter(function(e){return"metadata"==e.kind})}(e),n=(t=d(t)).next();!n.done;n=t.next())n.value.mode="hidden"}).Mb().N(.5);e.Yb.push(function(){n.stop()})}}(e,t);break;case"chapters":Xc(e,t);break;default:Sd(e)}}),e.u.C(i.textTracks,"removetrack",function(){return Sd(e)}),e.u.C(i.textTracks,"change",function(){return Sd(e)}));var o=Qi(t.uri);i.src=function(e,t,n){try{if(!e.g.enabled)return t;var a=bc(e);e:{switch(n){case"video/webm":case"video/mp4":var i=Ic;break e;case"application/x-mpegurl":i="m";break e}i=void 0}return a.ot=i,a.su=!0,yc(t,vc(a))}catch(e){return q("CMCD_SRC_ERROR","Could not generate src CMCD data.",e),t}}(e.V,t.uri,Qd[o]),(lt()||_t("Web0S"))&&i.load(),e.l=zd,e.dispatchEvent(qc("streaming"));var s=new at;return rs(i,HTMLMediaElement.HAVE_METADATA,e.u,function(){e.B.zd(),s.resolve()}),rs(i,HTMLMediaElement.HAVE_CURRENT_DATA,e.u,function(){return M(function(t){return 1==t.g?(function(e){var t=e.h.preferredAudioLanguage;if(""!=t){e.fe(t);var n=e.h.preferredVariantRole;""!=n&&e.fe(t,n)}}(e),nd(e).find(function(e){return"disabled"!=e.mode})?t.A(2):y(t,new Promise(function(t){e.u.ma(i.textTracks,"change",t),new ot(t).N(1)}),2)):r?t.return():(function(e){var t=e.h.preferredTextLanguage,n=e.h.preferForcedSubs;if(""!=t){e.ge(t,"",n);var a=e.h.preferredTextRole;""!=a&&e.ge(t,a,n)}}(e),void S(t))})}),i.error?s.reject(Ed(e)):"none"==i.preload&&(W('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),s.resolve()),e.u.ma(i,"error",function(){s.reject(Ed(e))}),new da(s,function(){return s.reject(new ke(2,7,7001)),Promise.resolve()}).X(function(){e.dc=!0})}(a,e,t)}),this.Fa=new tc(this.O,{Lf:function(e,t,n,i){var r=null;return e==a.O&&(r=n==a.O?a.O:a.W),e==a.W&&(r=n==a.O||t.mediaElement!=i.mediaElement?a.O:n==a.W?a.W:n==a.xb||n==a.ba?a.xb:n==a.zb?a.ce:null),e==a.xb&&(r=n==a.ba&&t.mediaElement==i.mediaElement?a.Yd:a.da),e==a.Yd&&(r=Rd(a.ba,a.Wd,a.da,n,t,i)),e==a.Wd&&(r=Rd(a.ba,a.Qd,a.da,n,t,i)),e==a.Qd&&(r=Rd(a.ba,a.ba,a.da,n,t,i)),e==a.ce&&(r=n==a.zb&&t.mediaElement==i.mediaElement?a.zb:a.da),e!=a.ba&&e!=a.zb||(r=a.da),e==a.da&&(r=i.mediaElement&&t.mediaElement==i.mediaElement?a.W:a.O),r},xf:function(e,t,n){return a.dispatchEvent(qc("onstatechange",(new Map).set("state",e.name))),i.get(e)(t,n)},handleError:function(e){return M(function(t){return 1==t.g?y(t,Qc(a,e),2):t.return(e.mediaElement?a.W:a.O)})},dg:function(e){a.dispatchEvent(qc("onstateidle",(new Map).set("state",e.name)))}}),this.$e=new ot(function(){_n(a.i.variants,a.h.restrictions,a.ec)&&hd(a)}),t&&this.Zb(t,!0)}function Wc(e){null!=e.L&&(e.L.release(),e.L=null)}function qc(e,t){return new _a(e,t)}function Qc(e,t){var n,a,i,r,o,s,c,l,u;return M(function(f){switch(f.g){case 1:return e.l!=Bd&&(e.l=jd),n=e.Yb.map(function(e){return e()}),e.Yb=[],y(f,Promise.all(n),2);case 2:if(e.dispatchEvent(qc("unloading")),t.mimeType=null,t.startTime=null,t.uri=null,t.mediaElement&&e.u.pb(),e.$e.stop(),e.yb&&(e.yb.release(),e.yb=null),e.Vc&&(e.Vc.stop(),e.Vc=null),!e.J){f.A(3);break}return y(f,e.J.stop(),4);case 4:e.J=null,e.Yc=null;case 3:if(!e.s){f.A(5);break}return y(f,e.s.stop(),5);case 5:if(!e.j){f.A(7);break}return y(f,e.j.destroy(),8);case 8:e.j=null;case 7:if(e.H&&(e.H.release(),e.H=null),e.B&&(e.B.release(),e.B=null),!e.G){f.A(9);break}return y(f,e.G.destroy(),10);case 10:e.G=null;case 9:if(e.F&&e.F.onAssetUnload(),!t.mediaElement||!t.mediaElement.src){f.A(11);break}return y(f,new Promise(function(e){return new ot(e).N(.1)}),12);case 12:for(t.mediaElement.removeAttribute("src"),t.mediaElement.load();t.mediaElement.lastChild;)t.mediaElement.removeChild(t.mediaElement.firstChild);case 11:if(!e.m){f.A(13);break}return y(f,e.m.destroy(),14);case 14:e.m=null;case 13:if(e.Xb=null,e.M=null,e.i){for(a=d(e.i.variants),i=a.next();!i.done;i=a.next())for(r=i.value,o=d([r.audio,r.video]),s=o.next();!s.done;s=o.next())(c=s.value)&&c.segmentIndex&&c.segmentIndex.release();for(l=d(e.i.textStreams),s=l.next();!s.done;s=l.next())(u=s.value).segmentIndex&&u.segmentIndex.release()}e.i=null,e.o=new Gc,e.Td=null,fd(e),S(f)}})}function Yc(e,t,n,a){for(var i=(t=d(t)).next();!i.done;i=t.next())if((i=i.value).data&&i.cueTime&&i.frames){var r=i.cueTime+n,o=a;o&&r>o&&(o=r);for(var s=d(i.frames),c=s.next();!c.done;c=s.next())Jc(e,r,o,"org.id3",c.value);e.F&&e.F.onHlsTimedMetadata(i,r)}}function Jc(e,t,n,a,i){t=(new Map).set("startTime",t).set("endTime",n).set("metadataType",a).set("payload",i),e.dispatchEvent(qc("metadata",t))}function Xc(e,t){if(t&&"chapters"==t.kind){t.mode="hidden";var n=new ot(function(){t.mode="hidden"}).Mb().N(.5);e.Yb.push(function(){n.stop()})}}function Zc(e,t){return new Di(t,e.h.drm.updateExpirationTime)}function $c(e,t){e.M=new aa,e.M.g=ra,ia(e.M,t,Math.min(.5,t/2)),fd(e),e.Vc=new ot(function(){ed(e)}).Ca(.25)}function ed(e){switch(e.l){case zd:if(e.g.ended)var t=!0;else{var n=bo(e.g.buffered);t=null!=n&&n>=e.g.duration-1}break;case Vd:e:if(e.g.ended||Uo(e.G))t=!0;else{if(e.i.presentationTimeline.T()){n=e.i.presentationTimeline.ib();var a=bo(e.g.buffered);if(null!=a&&a>=n){t=!0;break e}}t=!1}break;default:t=!1}a=vo(e.g.buffered,e.g.currentTime);var i=t,r=(n=e.M).h.get(n.g);t=n.g,a=i||a>=r?oa:ra,n.g=a,t!=a&&fd(e)}function td(e){if(e.J){var t=va(e.h.manifest);e.g&&"AUDIO"===e.g.nodeName&&(t.disableVideo=!0),e.J.configure(t)}if(e.m&&e.m.configure(e.h.drm),e.j){e.j.configure(e.h.streaming);try{ld(e,e.i)}catch(t){Od(e,t)}e.s&&_d(e),!(t=e.j.l)||t.allowedByApplication&&t.allowedByKeySystem||bd(e)}if(e.D&&e.D.ie(e.h.streaming.forceHTTPS),e.G&&(e.G.configure(e.h.mediaSource),e.G.H=e.h.manifest.segmentRelativeVttTiming,t=e.h.textDisplayFactory,e.Td!=t)){var n=t(),a=e.G,i=a.m;a.m=n,i&&(n.setTextVisibility(i.isTextVisible()),i.destroy()),a.g&&(a.g.i=n),e.Td=t,e.j&&(n=(t=e.j).i.get(et))&&Vs(t,n.stream,!0,0,!0)}e.s&&(e.s.configure(e.h.abr),e.h.abr.enabled?e.s.enable():e.s.disable(),Cd(e)),e.M&&(t=e.h.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),ia(e.M,t,Math.min(.5,t/2))),e.i&&kd(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd)}function nd(e){return Array.from(e.g.textTracks).filter(function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label})}function ad(e){return Array.from(e.g.textTracks).filter(function(e){return"chapters"==e.kind})}function id(e,t){var n,a;return M(function(i){switch(i.g){case 1:return n=Qi(t),(a=Yd[n])?i.return(a):(D(i,2),y(i,qi(t,e.D,e.h.streaming.retryParameters),4));case 4:a=i.h,x(i,3);break;case 2:C(i);case 3:if(a)return i.return(a);throw new ke(1,2,2011,n)}})}function rd(e,t,n,a,i,r,o){var s,c,d,l;return M(function(u){if(1==u.g)return"text/vtt"!=i||o.length?y(u,od(e,t,e.D,e.h.streaming.retryParameters),3):u.A(2);2!=u.g&&(s=u.h,c=sd(e,s,i,o),d=new Blob([c],{type:"text/vtt"}),t=Jo(d),i="text/vtt"),l=document.createElement("track");var f=e.V,p=t;try{if(f.g.enabled){var m=bc(f);m.ot=Cc,m.su=!0;var _=yc(p,vc(m))}else _=p}catch(e){q("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",e),_=p}return l.src=_,l.label=r,l.kind=a,l.srclang=n,e.g.getAttribute("crossorigin")||e.g.setAttribute("crossorigin","anonymous"),e.g.appendChild(l),u.return(l)})}function od(e,t,n,a){var i,r,o;return M(function(s){if(1==s.g){i=Aa,(r=Ca([t],a)).method="GET";var c=e.V;try{c.g.enabled&&gc(c,r,{ot:Cc,su:!0})}catch(e){q("CMCD_TEXT_ERROR","Could not generate text CMCD data.",e)}return y(s,n.request(i,r).promise,2)}return o=s.h,s.return(o.data)})}function sd(e,t,n,a){var i=Zt[n];if(i)return n=i(),e={periodStart:0,segmentStart:0,segmentEnd:e.g.duration,vttOffset:0},t=Ee(t),function(e,t){function n(e){for(var n=e,a=d(t),i=a.next();!i.done;i=a.next())(i=i.value).end&&i.start<e&&(n+=i.end-i.start);return(10>(e=Math.floor(n/3600))?"0":"")+e+":"+(10>(a=Math.floor(n/60%60))?"0":"")+a+":"+(10>(i=Math.floor(n%60))?"0":"")+i+"."+(100>(n=Math.floor(1e3*n%1e3))?10>n?"00":"0":"")+n}function a(e){var t=[],n=700<=e.fontWeight,i="italic"==e.fontStyle,r=e.textDecoration.includes("underline");return n&&t.push("b"),i&&t.push("i"),r&&t.push("u"),n=t.reduce(function(e,t){return e+"<"+t+">"},""),t=t.reduceRight(function(e,t){return e+"</"+t+">"},""),e.lineBreak?"\n":e.nestedCues.length?e.nestedCues.map(a).join(""):n+e.payload+t}var i=e.map(function(e){if(e.nestedCues.length){var t=e.clone();return t.nestedCues=[],t.payload=a(e),t}return e});e="WEBVTT\n\n";for(var r=(i=d(i)).next();!r.done;r=i.next())e+=n((r=r.value).startTime)+" --\x3e "+n(r.endTime)+function(e){var t=[];switch(e.textAlign){case"left":t.push("align:left");break;case"right":t.push("align:right");break;case se:t.push("align:middle");break;case"start":t.push("align:start");break;case"end":t.push("align:end")}switch(e.writingMode){case"vertical-lr":t.push("vertical:lr");break;case"vertical-rl":t.push("vertical:rl")}return t.length?" "+t.join(" "):""}(r)+"\n",e+=r.payload+"\n\n";return e}(t=n.parseMedia(t,e),a);throw new ke(2,2,2014,n)}function cd(e){var t=Hc();return t.streaming.failureCallback=function(t){if(e.T()){var n=null;1001==t.code||1002==t.code?n=1:1003==t.code&&(n=.1),null!=n&&(t.severity=1,e.be(n))}},t.textDisplayFactory=function(){return e.Pc?new dc(e.g,e.Pc):new ic(e.g)},t}function dd(e,t){return M(function(n){if(1==n.g)return y(n,function(e,t){return M(function(n){if(1==n.g)return y(n,function(e,t){return M(function(n){return 1==n.g?y(n,hn(t,0<t.offlineSessionIds.length),2):(Sn(e,t),function(e){e.textStreams=e.textStreams.filter(function(e){return Qt(Vt(e.mimeType,e.codecs))})}(t),y(n,function(e){var t,n,a,i,r,o,s;return M(function(c){switch(c.g){case 1:t=[],n=d(e.imageStreams),a=n.next();case 2:if(a.done){c.A(4);break}if(i=a.value,r=i.mimeType,Bn.has(r)){c.A(5);break}if(!(o=jn.get(r))){Bn.set(r,!1),c.A(5);break}return y(c,function(e){return new Promise(function(t){var n=new Image;n.src=e,"decode"in n?n.decode().then(function(){t(!0)}).catch(function(){t(!1)}):n.onload=n.onerror=function(){t(2===n.height)}})}(o),7);case 7:s=c.h,Bn.set(r,s);case 5:Bn.get(r)&&t.push(i),a=n.next(),c.A(2);break;case 4:e.imageStreams=t,S(c)}})}(t),0))})}(e.j?e.j.l:null,t),2);Pd(t),S(n)})}(e,t),2);ld(e,t),S(n)})}function ld(e,t){if(e.l!=Bd){_n(t.variants,e.h.restrictions,e.ec)&&e.j&&Sd(e);var n=e.m?e.m.g:null;if(n&&e.m.u)for(var a=d(t.variants),i=a.next();!i.done;i=a.next())i=i.value,ud(e,n.keySystem,i.video),ud(e,n.keySystem,i.audio);Md(e,t)}}function ud(e,t,n){if(n)for(var a=(n=d(n.drmInfos)).next();!a.done;a=n.next())if((a=a.value).keySystem==t)for(var i=(a=d(a.initData||[])).next();!i.done;i=a.next())i=i.value,Ei(e.m,i.initDataType,i.initData)}function fd(e){var t=e.Gd();if(e.o&&e.M&&e.B){var n=e.H;n.j=t,Cs(n),e.V&&(n=e.V,t||n.i||(n.i=!0),n.i&&t&&(n.l=!0),n.m=t),md(e)}t=(new Map).set("buffering",t),e.dispatchEvent(qc("buffering",t))}function pd(e){var t=e.g.playbackRate;0!=t&&(e.H&&e.H.set(t),t=qc("ratechange"),e.dispatchEvent(t))}function md(e){if(e.o&&e.M){var t=e.o.g;e.M.g==ra?Bc(t,"buffering"):e.g.paused?Bc(t,"paused"):e.g.ended?Bc(t,"ended"):Bc(t,"playing")}}function _d(e){try{Md(e,e.i)}catch(t){return Od(e,t),!1}var t=e.i.variants.filter(function(e){return Ln(e)});return t=e.La.create(t),e.s.setVariants(Array.from(t.values())),!0}function hd(e){return _d(e)?e.s.chooseVariant():null}function bd(e,t,n){t=void 0===t||t,n=void 0===n?0:n;var a=hd(e);a&&gd(e,a,!0,t,n)}function gd(e,t,n,a,i){var r=e.j.l;if(t==r)a&&Bs(e.j,t,a,i,!0);else{var o=e.o.h;o.h!=t&&(o.h=t,o.g.push({timestamp:Date.now()/1e3,id:t.id,type:"variant",fromAdaptation:n,bandwidth:t.bandwidth})),Bs(e.j,t,a,i,void 0,n),a=null,r&&(a=In(r)),t=In(t),n?yd(e,a,t):Dd(e,a,t)}}function vd(e,t){var n=Array.from(e.g.audioTracks).find(function(e){return e.enabled});t.enabled=!0,t.id!==n.id&&(n.enabled=!1),Dd(e,n=En(n),t=En(t))}function yd(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),e.L&&Ao(e.L,n),Td(e,n=qc("adaptation",t))}function Sd(e){Td(e,qc("trackschanged"))}function Dd(e,t,n){t=(new Map).set("oldTrack",t).set("newTrack",n),e.L&&Ao(e.L,n),Td(e,n=qc("variantchanged",t))}function Id(e){Td(e,qc("textchanged"))}function xd(e){Td(e,qc("texttrackvisibility"))}function Cd(e){Td(e,qc("abrstatuschanged",(new Map).set("newStatus",e.h.abr.enabled)))}function Od(e,t){if(e.l!=Bd)if(function(e,t){if(1002!=t.code&&1011!=t.code||1!=t.category||!navigator.onLine)return!1;var n=e.h.streaming.maxDisabledTime;if(0==n){if(1011!=t.code)return!1;n=1}t=e.Ya().find(function(e){return e.active});for(var a=e.i,i=d(a.variants),r=i.next();!r.done;r=i.next())(r=r.value).id===t.id&&(r.disabledUntilTime=Date.now()/1e3+n);return _n(a.variants,e.h.restrictions,e.ec),!!(t=hd(e))&&(a=e.Na().video.reduce(function(e,t){return e+t.end-t.start},0),gd(e,t,!1,!0,a),e.$e.N(n),!0)}(e,t))t.handled=!0;else{var n=qc("error",(new Map).set("detail",t));e.dispatchEvent(n),n.defaultPrevented&&(t.handled=!0)}}function wd(e,t,n){n=(new Map).set("detail",{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}),e.dispatchEvent(qc(t,n))}function Ed(e){if(!e.g.error)return null;var t=e.g.error.code;if(1==t)return null;var n=e.g.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new ke(2,3,3016,t,n,e.g.error.message)}function Ad(e,t){if(e.j){var n=Object.keys(t),a=1==n.length&&"00"==n[0],i=!1;if(n.length)for(var r=(n=d(e.i.variants)).next();!r.done;r=n.next()){var o=[];(r=r.value).audio&&o.push(r.audio),r.video&&o.push(r.video);for(var s=(o=d(o)).next();!s.done;s=o.next()){var c=s.value;if(s=r.allowedByKeySystem,c.keyIds.size){r.allowedByKeySystem=!0;for(var l=(c=d(c.keyIds)).next();!l.done;l=c.next())l=l.value,l=t[a?"00":l],r.allowedByKeySystem=r.allowedByKeySystem&&!!l&&!Kd.includes(l)}s!=r.allowedByKeySystem&&(i=!0)}}i&&!_d(e)||((t=e.j.l)&&!t.allowedByKeySystem&&bd(e),i&&Sd(e))}}function Ld(e,t,n){e.J&&e.J.onExpirationUpdated&&e.J.onExpirationUpdated(t,n),t=qc("expirationupdated"),e.dispatchEvent(t)}function kd(e,t,n){0<t&&(e.T()||e.Ye(t)),n<(t=e.getDuration())&&(e.T()||e.Ia(n))}function Md(e,t){e=e.m?e.m.Rc():{};var n=Object.keys(e);n=n.length&&"00"==n[0];for(var a=!1,i=!1,r=new Set,o=new Set,s=(t=d(t.variants)).next();!s.done;s=t.next()){var c=[];(s=s.value).audio&&c.push(s.audio),s.video&&c.push(s.video);for(var l=(c=d(c)).next();!l.done;l=c.next())if((l=l.value).keyIds.size)for(var u=(l=d(l.keyIds)).next();!u.done;u=l.next()){u=u.value;var f=e[n?"00":u];f?Kd.includes(f)&&o.add(f):r.add(u)}s.allowedByApplication?s.allowedByKeySystem&&(a=!0):i=!0}if(!a)throw new ke(2,4,4012,e={hasAppRestrictions:i,missingKeys:Array.from(r),restrictedKeyStatuses:Array.from(o)})}function Pd(e){if(!e.variants.some(Ln))throw new ke(2,4,4032)}function Td(e,t){M(function(n){if(1==n.g)return y(n,Promise.resolve(),2);e.l!=Bd&&e.dispatchEvent(t),S(n)})}function Ud(e){for(var t=new Set,n=(e=d(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(an(n.language)):t.add("und");return t}function Fd(e){for(var t=new Map,n=new Map,a=(e=d(e)).next();!a.done;a=e.next()){var i="und",r=[];(a=a.value).language&&(i=an(a.language)),(r="variant"==a.type?a.audioRoles:a.roles)&&r.length||(r=[""]),t.has(i)||t.set(i,new Set);for(var o=(r=d(r)).next();!o.done;o=r.next())o=o.value,t.get(i).add(o),a.label&&(n.has(i)||n.set(i,new Map),n.get(i).set(o,a.label))}var s=[];return t.forEach(function(e,t){for(var a=(e=d(e)).next();!a.done;a=e.next()){a=a.value;var i=null;n.has(t)&&n.get(t).has(a)&&(i=n.get(t).get(a)),s.push({language:t,role:a,label:i})}}),s}function Hd(){return new ke(2,7,7e3)}function Rd(e,t,n,a,i,r){return a==e&&i.mediaElement==r.mediaElement&&i.uri==r.uri&&i.mimeType==r.mimeType?t:n}function Nd(e){return new Promise(function(t,n){e.ob=function(){return n(Hd())},e.cd=function(){return t()},e.onError=function(e){return n(e)},e.ed=function(){return n(Hd())}})}B("shaka.util.CmcdManager.StreamingFormat",{Kg:"d",Sg:"h",eh:"s",Zg:"o"}),B("shaka.util.ConfigUtils",Ac),Ac.convertToConfigObject=kc,Ac.mergeConfigObjects=Lc,B("shaka.util.FairPlayUtils",Pc),Pc.commonFairPlayResponse=function(e,t){if(2===e){try{var n=yt(t.data)}catch(e){return}e=!1,"<ckc>"===(n=n.trim()).substr(0,5)&&"</ckc>"===n.substr(-6)&&(n=n.slice(5,-6),e=!0);try{var a=JSON.parse(n);a.ckc&&(n=a.ckc,e=!0),a.CkcMessage&&(n=a.CkcMessage,e=!0),a.License&&(n=a.License,e=!0)}catch(e){}e&&(t.data=we(At(n)))}},Pc.conaxFairPlayRequest=function(e,t){2===e&&(t.headers["Content-Type"]="application/octet-stream")},Pc.ezdrmFairPlayRequest=function(e,t){2===e&&(t.headers["Content-Type"]="application/octet-stream")},Pc.verimatrixFairPlayRequest=function(e,t){2===e&&(e=Et(e=Ee(t.body)),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.body=It("spc="+e))},Pc.conaxInitDataTransform=function(t,n,a){if("skd"!==n)return t;n=a.serverCertificate,a=Dt(t).split("skd://").pop().split("?").shift(),a=e.atob(a);var i=new ArrayBuffer(2*a.length);i=new Uint16Array(i);for(var r=0,o=a.length;r<o;r++)i[r]=a.charCodeAt(r);return Uc(t,i,n)},Pc.ezdrmInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Uc(e,n=Dt(e).split(";").pop(),t))},Pc.verimatrixInitDataTransform=function(e,t,n){return"skd"!==t?e:(t=n.serverCertificate,Uc(e,n=Dt(e).split("skd://").pop(),t))},Pc.initDataTransform=Uc,Pc.defaultGetContentId=Tc,Pc.isFairPlaySupported=function(){var e;return M(function(t){return 1==t.g?(e={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},D(t,2),y(t,navigator.requestMediaKeySystemAccess("com.apple.fps",[e]),4)):2!=t.g?t.return(!0):(C(t),t.return(!1))})},B("shaka.util.PlayerConfiguration",Fc),Fc.mergeConfigObjects=Rc,Fc.createDefault=Hc,h(Kc,ga),(a=Kc.prototype).destroy=function(){var e,t=this;return M(function(n){switch(n.g){case 1:return t.l==Bd?n.return():(Wc(t),t.l=Bd,e=nc(t.Fa,function(){return{node:t.O,payload:{mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null},jb:!1}}),y(n,new Promise(function(t){e.Jb=function(){},e.cd=function(){t()},e.ob=function(){t()},e.onError=function(){t()},e.ed=function(){t()}}),2));case 2:return y(n,t.Fa.destroy(),3);case 3:if(t.Xc&&(t.Xc.release(),t.Xc=null),t.Nb&&(t.Nb.release(),t.Nb=null),t.u&&(t.u.release(),t.u=null),t.Nd=null,t.h=null,t.o=null,t.Pc=null,t.V=null,!t.D){n.A(4);break}return y(n,t.D.destroy(),5);case 5:t.D=null;case 4:t.s&&(t.s.release(),t.s=null),ga.prototype.release.call(t),S(n)}})},a.Zb=function(e,t){if(t=void 0===t||t,this.l==Bd)return Promise.reject(Hd());var n={mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null};n.mediaElement=e,st()||(t=!1);var a=t?this.xb:this.W;return(e=nc(this.Fa,function(){return{node:a,payload:n,jb:!1}})).Jb=function(){},Nd(e)},a.kf=function(e){this.bf=e},a.detach=function(){var e=this;if(this.l==Bd)return Promise.reject(Hd());var t=nc(this.Fa,function(){return{node:e.O,payload:{mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null},jb:!1}});return t.Jb=function(){},Nd(t)},a.pe=function(e){var t=this;if(e=void 0===e||e,this.l==Bd)return Promise.reject(Hd());this.dc=!1,st()||(e=!1),Wc(this);var n={mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null},a=nc(this.Fa,function(a){var i=a.mediaElement&&e?t.xb:a.mediaElement?t.W:t.O;return n.mediaElement=a.mediaElement,{node:i,payload:n,jb:!1}});return a.Jb=function(){},Nd(a)},a.Eg=function(e){this.fc=e},a.load=function(e,t,n){var a=this;if(this.fc=null,this.dc=!1,this.l==Bd)return Promise.reject(Hd());this.dispatchEvent(qc("loading"));var i={mediaElement:null,mimeType:null,startTime:null,me:NaN,uri:null};i.uri=e,i.me=Date.now()/1e3,n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var r=function(e,t){if(!st())return!0;var n=t.mimeType,a=t.uri||"";if(n||(n=Qi(a),n=Qd[n]),n){if(""==(t.mediaElement||ht()).canPlayType(n))return!1;if(!st()||!(n in Yi)&&!(Qi(a)in Ji)||e.h.streaming.preferNativeHls)return!0;if(ft())return e.h.streaming.useNativeHlsOnSafari}return!1}(this,i)?this.zb:this.ba,o=nc(this.Fa,function(e){return null==e.mediaElement?null:(i.mediaElement=e.mediaElement,{node:r,payload:i,jb:!0})});return this.o=new Gc,this.V=function(e){return new _c({getBandwidthEstimate:function(){return e.s?e.s.getBandwidthEstimate():NaN},Na:function(){return e.Na()},getCurrentTime:function(){return e.g?e.g.currentTime:0},Ya:function(){return e.Ya()},Sc:function(){return e.Sc()},T:function(){return e.T()}},e.h.cmcd)}(this),o.Jb=function(){},new Promise(function(e,t){o.ed=function(){return t(new ke(2,7,7002))},o.cd=function(){e(),a.dispatchEvent(qc("loaded"))},o.ob=function(){return t(Hd())},o.onError=function(e){return t(e)}})},a.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=kc(e,t)),e.streaming&&"forceTransmuxTS"in e.streaming&&(qn("streaming.forceTransmuxTS configuration","Please Use streaming.forceTransmux instead."),e.streaming.forceTransmux=e.streaming.forceTransmuxTS,delete e.streaming.forceTransmuxTS),e.streaming&&e.streaming.lowLatencyMode&&(null==e.streaming.inaccurateManifestTolerance&&(e.streaming.inaccurateManifestTolerance=0),null==e.streaming.rebufferingGoal&&(e.streaming.rebufferingGoal=.01));var n=Rc(this.h,e,cd(this));return td(this),n},a.getConfiguration=function(){var e=cd(this);return Rc(e,this.h,cd(this)),e},a.Af=function(){if(this.g){var e=this.g.buffered.length;e=e?this.g.buffered.end(e-1):0;var t=this.getConfiguration().streaming.bufferingGoal;if(e>=(t=Math.min(this.g.currentTime+t,this.uc().end)))return 1;if(!(e<=this.g.currentTime)&&e<t)return(e-this.g.currentTime)/(t-this.g.currentTime)}return 0},a.qg=function(){for(var e in this.h)delete this.h[e];Rc(this.h,cd(this),cd(this)),td(this)},a.Gf=function(){return this.l},a.Kf=function(){return this.g},a.jc=function(){return this.D},a.Ed=function(){return this.Xb},a.Ee=function(){return this.F?this.F:null},a.T=function(){return this.i?this.i.presentationTimeline.T():!(!this.g||!this.g.src)&&1/0==this.g.duration},a.lb=function(){return!!this.i&&this.i.presentationTimeline.lb()},a.Yf=function(){if(this.i){var e=this.i.variants;return!!e.length&&!e[0].video}return!(!this.g||!this.g.src)&&(this.g.videoTracks?0==this.g.videoTracks.length:0==this.g.videoHeight)},a.uc=function(){if(!this.dc)return{start:0,end:0};if(this.i){var e=this.i.presentationTimeline;return{start:e.Db(),end:e.Oa()}}return this.g&&this.g.src&&(e=this.g.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},a.Wf=function(){this.T()&&(this.g.currentTime=this.uc().end)},a.keySystem=function(){var e=this.drmInfo();return e?e.keySystem:""},a.drmInfo=function(){return this.m?this.m.g:null},a.ic=function(){return this.m?this.m.ic():1/0},a.Rc=function(){return this.m?this.m.Rc():{}},a.Gd=function(){return!!this.M&&this.M.g==ra},a.Sc=function(){return this.g?this.H?this.H.i:1:0},a.zg=function(e){0==e?W("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.H.set(e),this.l==Vd&&(this.s.playbackRateChanged(e),Ns(this.j,1<Math.abs(e))))},a.nf=function(){var e=this.H.Qc();this.l==zd&&this.H.set(e),this.l==Vd&&(this.H.set(e),this.s.playbackRateChanged(e),Ns(this.j,!1))},a.Ya=function(){if(this.i){for(var e=this.j?this.j.l:null,t=[],n=0,a=d(this.i.variants),i=a.next();!i.done;i=a.next())if(Ln(i=i.value)){var r=In(i);r.active=i==e,r.active||1==n||null==e||i.video!=e.video||i.audio!=e.audio||(r.active=!0),r.active&&n++,t.push(r)}return t}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map(function(e){return En(e)}):[]},a.Fb=function(){if(this.i){for(var e=this.j?this.j.o:null,t=[],n=d(this.i.textStreams),a=n.next();!a.done;a=n.next()){var i=xn(a=a.value);i.active=a==e,t.push(i)}return t}return this.g&&this.g.src&&this.g.textTracks?nd(this).map(function(e){return wn(e)}):[]},a.Ef=function(){return this.i?this.i.imageStreams.map(function(e){return Cn(e)}):[]},a.Sf=function(e,t){var n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,S,D,I=this;return M(function(x){return 1==x.g?I.i?(n=I.i.imageStreams.find(function(t){return t.id==e}))?n.segmentIndex?x.A(3):y(x,n.createSegmentIndex(),3):x.return(null):x.A(2):2!=x.g?null==(a=n.segmentIndex.find(t))?x.return(null):(i=n.segmentIndex.get(a),r=i.tilesLayout||n.tilesLayout,(o=/(\d+)x(\d+)/.exec(r))?(s=n.width||0,c=n.height||0,d=parseInt(o[1],10),l=parseInt(o[2],10),u=s/d,f=c/l,p=d*l,m=i.j-i.startTime,_=i.s||m/p,h=i.startTime,g=b=0,1<p&&(v=Math.floor((t-i.startTime)/_),h=i.startTime+v*_,b=v%d*u,g=Math.floor(v/d)*f),S=!1,(D=i.o)&&(S=!0,f=D.height,b=D.positionX,g=D.positionY,u=D.width),x.return({imageHeight:c,imageWidth:s,height:f,positionX:b,positionY:g,startTime:h,duration:_,uris:i.za(),width:u,sprite:S})):x.return(null)):x.return(null)})},a.Re=function(e){if(this.i&&this.j){var t=this.i.textStreams.find(function(t){return t.id==e.id});t&&t!=this.j.o&&(zc(this.o.h,t,!1),js(this.j,t),Id(this),this.wb=t.language)}else if(this.g&&this.g.src&&this.g.textTracks){for(var n=(t=d(t=nd(this))).next();!n.done;n=t.next())On(n=n.value)==e.id?n.mode=this.ia?"showing":"hidden":n.mode="disabled";Id(this)}},a.Se=function(e,t,n){if(t=void 0!==t&&t,n=void 0===n?0:n,this.i&&this.j){this.h.abr.enabled&&W("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var a=this.i.variants.find(function(t){return t.id==e.id});a&&Ln(a)&&(gd(this,a,!1,t,n),this.La=new ta(a),_d(this))}else if(this.g&&this.g.audioTracks)for(n=(t=d(t=Array.from(this.g.audioTracks))).next();!n.done;n=t.next())if(On(n=n.value)==e.id){vd(this,n);break}},a.zf=function(){return Fd(this.Ya())},a.Qf=function(){return Fd(this.Fb())},a.yf=function(){return Array.from(Ud(this.Ya()))},a.Pf=function(){return Array.from(Ud(this.Fb()))},a.fe=function(e,t,n){if(n=void 0===n?0:n,this.i&&this.B){this.La=new na(e,t||"",n,""),t=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},e=this.j.l;var a=this.La.create(this.i.variants);n=null;for(var i=(a=d(a.values())).next();!i.done;i=a.next())i=i.value,(!n||t(n,e)>t(i,e))&&(n=i);n?(t=In(n),this.Se(t,!0)):bd(this)}else if(this.g&&this.g.audioTracks){i=Array.from(this.g.audioTracks),e=an(e),a=n=null;for(var r=(i=d(i)).next();!r.done;r=i.next()){var o=En(r=r.value);an(o.language)==e&&(n=r,t?o.roles.includes(t)&&(a=r):0==o.roles.length&&(a=r))}a?vd(this,a):n&&vd(this,n)}},a.ge=function(e,t,n){if(n=void 0!==n&&n,this.i&&this.B)this.wb=e,this.ac=t||"",this.$b=n,(e=Mn(this.i.textStreams,this.wb,this.ac,this.$b)[0]||null)&&e!=this.j.o&&(zc(this.o.h,e,!1),this.h.streaming.alwaysStreamText||this.Hd())&&(js(this.j,e),Id(this));else{var a=an(e);(e=this.Fb().find(function(e){return an(e.language)==a&&(!t||e.roles.includes(t))&&e.forced==n}))&&this.Re(e)}},a.sg=function(e,t,n){if(t=void 0===t||t,n=void 0===n?0:n,this.i&&this.B){for(var a=null,i=d(this.i.variants),r=i.next();!r.done;r=i.next())if((r=r.value).audio.label==e){a=r;break}null!=a&&(this.La=new na(a.language,"",0,e),bd(this,t,n))}},a.Hd=function(){var e=this.ia;return this.G?this.G.m.isTextVisible():this.g&&this.g.src&&this.g.textTracks?nd(this).some(function(e){return"showing"==e.mode}):e},a.Fe=function(){return this.g&&this.g.src&&this.g.textTracks?ad(this).map(function(e){return wn(e)}):[]},a.Bf=function(e){var t=an(e),n=ad(this).filter(function(e){return an(e.language)==t});if(!n||!n.length)return[];e=[];for(var a=new Set,i=(n=d(n)).next();!i.done;i=n.next())if((i=i.value)&&i.cues)for(var r=(i=d(i.cues)).next();!r.done;r=i.next()){var o=r.value;(r=o.id)&&""!=r||(r=o.startTime+"-"+o.endTime+"-"+o.text),o={id:r,title:o.text,startTime:o.startTime,endTime:o.endTime},a.has(r)||(e.push(o),a.add(r))}return e},a.xg=function(e){if(e=!!e,this.ia!=e){if(this.ia=e,this.l==Vd)this.G.m.setTextVisibility(e),this.h.streaming.alwaysStreamText||(e?this.j.o||0<(e=Mn(this.i.textStreams,this.wb,this.ac,this.$b)).length&&(js(this.j,e[0]),Id(this)):function(e){var t=e.i.get(et);t&&(Zs(t),$s(t).catch(function(){}),e.i.delete(et)),e.o=null}(this.j));else if(this.g&&this.g.src&&this.g.textTracks)for(var t=nd(this),n=(t=d(t)).next();!n.done;n=t.next())"disabled"!=(n=n.value).mode&&(n.mode=e?"showing":"hidden");xd(this)}},a.Nf=function(){if(!this.T())return null;var e=this.Fa.l,t=0;if(this.B)t=this.B.Ic();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.i?new Date(1e3*(this.i.presentationTimeline.i+t)):this.g&&this.g.getStartDate?(e=this.g.getStartDate(),isNaN(e.getTime())?null:new Date(e.getTime()+1e3*t)):null},a.Ge=function(){if(!this.T())return null;if(this.i)return new Date(1e3*this.i.presentationTimeline.i);if(this.g&&this.g.getStartDate){var e=this.g.getStartDate();return isNaN(e.getTime())?null:e}return null},a.Na=function(){if(this.l==Vd)return this.G.Na();var e={total:[],audio:[],video:[],text:[]};return this.l==zd&&(e.total=yo(this.g.buffered)),e},a.getStats=function(){if(this.l!=Vd&&this.l!=zd)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};md(this);var e=this.g,t=e.currentTime/e.duration;if(!isNaN(t)){var n=this.o;t=Math.round(100*t),n.i=isNaN(n.i)?t:Math.max(n.i,t)}if(this.B&&(this.o.M=this.B.re(),this.o.O=this.B.se()),e.getVideoPlaybackQuality){n=e.getVideoPlaybackQuality(),t=this.o;var a=Number(n.totalVideoFrames);t.L=Number(n.droppedVideoFrames),t.J=a,this.o.H=Number(n.corruptedVideoFrames)}n=this.m&&(n=this.m).H?n.H:NaN,this.o.s=n,this.l==Vd&&((n=this.j.l)&&(this.o.B=(this.H?this.H.i:1)*n.bandwidth),n&&n.video&&(t=this.o,a=n.video.height||NaN,t.o=n.video.width||NaN,t.l=a),this.T()&&(n=this.Ge().valueOf()+1e3*this.uc().end,this.o.D=(Date.now()-n)/1e3),this.i&&this.i.presentationTimeline&&(this.o.G=this.i.presentationTimeline.g),n=this.s.getBandwidthEstimate(),this.o.u=n),this.l==zd&&(n=this.o,t=e.videoHeight||NaN,n.o=e.videoWidth||NaN,n.l=t);var i=this.o;e=i.o,n=i.l,t=i.B,a=i.J;for(var r=i.L,o=i.H,s=i.O,c=i.M,l=i.u,u=i.i,f=i.m,p=i.F,m=i.j,_=jc(i.g,"playing"),h=jc(i.g,"paused"),b=jc(i.g,"buffering"),g=i.s,v=i.D,y=i.G,S=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],a=d(e.h),i=a.next();!i.done;i=a.next())n.push(t(i.value));return e.g&&n.push(t(e.g)),n}(i.g),D=[],I=(i=d(i.h.g)).next();!I.done;I=i.next())I=I.value,D.push({timestamp:I.timestamp,id:I.id,type:I.type,fromAdaptation:I.fromAdaptation,bandwidth:I.bandwidth});return{width:e,height:n,streamBandwidth:t,decodedFrames:a,droppedFrames:r,corruptedFrames:o,stallsDetected:s,gapsJumped:c,estimatedBandwidth:l,completionPercent:u,loadLatency:f,manifestTimeSeconds:p,drmTimeSeconds:m,playTime:_,pauseTime:h,bufferingTime:b,licenseTime:g,liveLatency:v,maxSegmentDuration:y,stateHistory:S,switchHistory:D}},a.gf=function(e,t,n,a,i,r,o){o=void 0!==o&&o;var s,c,d,l,u,f,p,m,_,h=this;return M(function(b){switch(b.g){case 1:if(h.l!=Vd&&h.l!=zd)throw new ke(1,7,7004);if(a){b.A(2);break}return y(b,id(h,e),3);case 3:a=b.h;case 2:if(s=[],h.F)try{s=h.F.getServerSideCuePoints()}catch(e){}if(h.l!=zd){b.A(4);break}return o&&(n="forced"),y(b,rd(h,e,t,n,a,r||"",s),5);case 5:if(c=h.Fb(),d=c.find(function(e){return e.language==t&&e.label==(r||"")&&e.kind==n}))return Sd(h),b.return(d);throw new ke(1,2,2012);case 4:if(l=tt,1/0==(u=h.i.presentationTimeline.getDuration()))throw new ke(1,4,4033);if(!s.length){b.A(6);break}return y(b,od(h,e,h.D,h.h.streaming.retryParameters),7);case 7:f=b.h,p=sd(h,f,a,s),m=new Blob([p],{type:"text/vtt"}),e=Jo(m),a="text/vtt";case 6:if(!Qt(Vt((_={id:h.Xd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:Ss(0,u,[e]),mimeType:a||"",codecs:i||"",kind:n,encrypted:!1,drmInfos:[],keyIds:new Set,language:t,label:r||null,type:l.Z,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!o,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}).mimeType,_.codecs)))throw new ke(2,2,2014,a);return h.i.textStreams.push(_),Sd(h),b.return(xn(_))}})},a.hf=function(e,t){var n,a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v=this;return M(function(S){switch(S.g){case 1:if(v.l!=Vd&&v.l!=zd)throw new ke(1,7,7004);if(v.l==zd)throw new ke(1,2,2016);if(t){S.A(2);break}return y(S,id(v,e),3);case 3:t=S.h;case 2:if("text/vtt"!=t)throw new ke(1,2,2017,e);if(n=tt,1/0==(a=v.i.presentationTimeline.getDuration()))throw new ke(1,4,4045);return y(S,od(v,e,v.D,v.h.streaming.retryParameters),4);case 4:if(i=S.h,!(r=Zt[t]))throw new ke(2,2,2014,t);for(o=r(),s={periodStart:0,segmentStart:0,segmentEnd:a,vttOffset:0},c=Ee(i),l=o.parseMedia(c,s),u=[],f={},p=d(l),m=p.next();!m.done;f={Rb:f.Rb},m=p.next())_=m.value,f.Rb=Je([e],[_.payload])[0],h=new po(_.startTime,_.endTime,function(e){return function(){return[e.Rb]}}(f),0,null,null,0,0,1/0),f.Rb.includes("#xywh")&&4===(b=f.Rb.split("#xywh=")[1].split(",")).length&&h.Xe({height:parseInt(b[3],10),positionX:parseInt(b[0],10),positionY:parseInt(b[1],10),width:parseInt(b[2],10)}),u.push(h);return g={id:v.Xd++,originalId:null,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new vs(u),mimeType:t||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",label:null,type:n.Wb,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1"},v.i.imageStreams.push(g),Sd(v),S.return(Cn(g))}})},a.ff=function(e,t,n){var a,i,r,o,s=this;return M(function(c){switch(c.g){case 1:if(s.l!=Vd&&s.l!=zd)throw new ke(1,7,7004);if(n){c.A(2);break}return y(c,id(s,e),3);case 3:n=c.h;case 2:if(a=[],s.F)try{a=s.F.getServerSideCuePoints()}catch(e){}return y(c,rd(s,e,t,"chapters",n,"",a),4);case 4:if(i=c.h,r=s.Fe(),!(o=r.find(function(e){return e.language==t}))){c.A(5);break}return y(c,new Promise(function(e,t){s.u.ma(i,"load",e),s.u.ma(i,"error",function(){t(new ke(1,2,2015))})}),6);case 6:return c.return(o);case 5:throw new ke(1,2,2012)}})},a.je=function(e,t){this.ec.width=e,this.ec.height=t},a.be=function(e){if(this.l==Vd){var t=this.j;if(e=void 0===e?.1:e,t.j.g)t=!1;else if(t.s)t=!1;else{for(var n=d(t.i.values()),a=n.next();!a.done;a=n.next())!(a=a.value).nc||a.sa||a.Ka||(a.nc=!1,Xs(t,a,e));t=!0}}else t=!1;return t},a.Hf=function(){return W("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},a.If=function(){return this.Yc},a.Ze=function(e){this.Pc=e},B("shaka.Player",Kc),Kc.prototype.setVideoContainer=Kc.prototype.Ze,Kc.prototype.getManifestParserFactory=Kc.prototype.If,Kc.prototype.getManifest=Kc.prototype.Hf,Kc.prototype.retryStreaming=Kc.prototype.be,Kc.prototype.setMaxHardwareResolution=Kc.prototype.je,Kc.prototype.addChaptersTrack=Kc.prototype.ff,Kc.prototype.addThumbnailsTrack=Kc.prototype.hf,Kc.prototype.addTextTrackAsync=Kc.prototype.gf,Kc.prototype.getStats=Kc.prototype.getStats,Kc.prototype.getBufferedInfo=Kc.prototype.Na,Kc.prototype.getPresentationStartTimeAsDate=Kc.prototype.Ge,Kc.prototype.getPlayheadTimeAsDate=Kc.prototype.Nf,Kc.prototype.setTextTrackVisibility=Kc.prototype.xg,Kc.prototype.getChapters=Kc.prototype.Bf,Kc.prototype.getChaptersTracks=Kc.prototype.Fe,Kc.prototype.isTextTrackVisible=Kc.prototype.Hd,Kc.prototype.selectVariantsByLabel=Kc.prototype.sg,Kc.prototype.selectTextLanguage=Kc.prototype.ge,Kc.prototype.selectAudioLanguage=Kc.prototype.fe,Kc.prototype.getTextLanguages=Kc.prototype.Pf,Kc.prototype.getAudioLanguages=Kc.prototype.yf,Kc.prototype.getTextLanguagesAndRoles=Kc.prototype.Qf,Kc.prototype.getAudioLanguagesAndRoles=Kc.prototype.zf,Kc.prototype.selectVariantTrack=Kc.prototype.Se,Kc.prototype.selectTextTrack=Kc.prototype.Re,Kc.prototype.getThumbnails=Kc.prototype.Sf,Kc.prototype.getImageTracks=Kc.prototype.Ef,Kc.prototype.getTextTracks=Kc.prototype.Fb,Kc.prototype.getVariantTracks=Kc.prototype.Ya,Kc.prototype.cancelTrickPlay=Kc.prototype.nf,Kc.prototype.trickPlay=Kc.prototype.zg,Kc.prototype.getPlaybackRate=Kc.prototype.Sc,Kc.prototype.isBuffering=Kc.prototype.Gd,Kc.prototype.getKeyStatuses=Kc.prototype.Rc,Kc.prototype.getExpiration=Kc.prototype.ic,Kc.prototype.drmInfo=Kc.prototype.drmInfo,Kc.prototype.keySystem=Kc.prototype.keySystem,Kc.prototype.goToLive=Kc.prototype.Wf,Kc.prototype.seekRange=Kc.prototype.uc,Kc.prototype.isAudioOnly=Kc.prototype.Yf,Kc.prototype.isInProgress=Kc.prototype.lb,Kc.prototype.isLive=Kc.prototype.T,Kc.prototype.getAdManager=Kc.prototype.Ee,Kc.prototype.getAssetUri=Kc.prototype.Ed,Kc.prototype.getNetworkingEngine=Kc.prototype.jc,Kc.prototype.getMediaElement=Kc.prototype.Kf,Kc.prototype.getLoadMode=Kc.prototype.Gf,Kc.prototype.resetConfiguration=Kc.prototype.qg,Kc.prototype.getBufferFullness=Kc.prototype.Af,Kc.prototype.getConfiguration=Kc.prototype.getConfiguration,Kc.prototype.configure=Kc.prototype.configure,Kc.prototype.load=Kc.prototype.load,Kc.prototype.updateStartTime=Kc.prototype.Eg,Kc.prototype.unload=Kc.prototype.pe,Kc.prototype.detach=Kc.prototype.detach,Kc.prototype.attachCanvas=Kc.prototype.kf,Kc.prototype.attach=Kc.prototype.Zb,Kc.probeSupport=function(e){var t,n,a,i,r;return e=void 0===e||e,M(function(o){if(1==o.g)return t={},e?y(o,function(){var e,t,n,a,i,r;return M(function(o){return 1==o.g?(e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),n=[{videoCapabilities:t=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:t}],a=new Map,i=function(e){var t,i,r;return M(function(o){switch(o.g){case 1:if(D(o,2),"org.w3.clearkey"===e&&mt())throw Error("Unsupported keySystem");return y(o,navigator.requestMediaKeySystemAccess(e,n),4);case 4:return t=o.h,r=!!(i=t.getConfiguration().sessionTypes)&&i.includes("persistent-license"),_t("Tizen 3")&&(r=!1),a.set(e,{persistentState:r}),y(o,t.createMediaKeys(),5);case 5:x(o,0);break;case 2:C(o),a.set(e,null),S(o)}})},r=e.map(function(e){return i(e)}),y(o,Promise.all(r),2)):o.return(Na(a))})}(),3):o.A(2);2!=o.g&&(t=o.h);var s={};if(st()){for(var c in Yi)s[c]=!0;for(var u in Ji)s[u]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var f=(u=d(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!f.done;f=u.next())s[f=f.value]=st()?!!Yi[f]:ct(f);for(var p in c)s[p]=st()?!!Ji[p]:ct(c[p]);for(n=s,s={},c=(p=d(p='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(l(Zo)))).next();!c.done;c=p.next())s[c=c.value]=st()?!!Qt(c)||Z(c)||Ht(c):ct(c),s[u=c.split(";")[0]]=s[u]||s[c];for(r in a={manifest:n,media:s,drm:t},i=Wd)a[r]=i[r]();return o.return(a)})},Kc.isBrowserSupported=function(){if(e.Promise||W("A Promise implementation or polyfill is required"),!(e.Promise&&e.Uint8Array&&Array.prototype.forEach)||_t("Trident/"))return!1;var t=mt();return!(t&&13>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!st()||ct("application/x-mpegurl"))},Kc.setAdManagerFactory=function(e){qd=e},Kc.registerSupportPlugin=function(e,t){Wd[e]=t},Kc.prototype.destroy=Kc.prototype.destroy;var Bd=0,jd=1,Vd=2,zd=3;Kc.LoadMode={DESTROYED:Bd,NOT_LOADED:jd,MEDIA_SOURCE:Vd,SRC_EQUALS:zd},Kc.version="v4.3.5-7-g4c71172e-dirty";var Gd=["4","3"];Jn=new function(e){this.g=e,this.i=Qn,this.h=Yn}(new Wn(Number(Gd[0]),Number(Gd[1])));var Kd=["output-restricted","internal-error"],Wd={},qd=null,Qd={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"},Yd={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function Jd(){this.h=[],this.j=this.i=this.g=0}function Xd(e,t,n){var a=this;this.h=e,this.g=t,this.m=n,this.i=!1,this.l=this.g.getVolume(),this.j=new Ta,this.j.C(this.g,google.ima.AdEvent.Type.PAUSED,function(){a.i=!0}),this.j.C(this.g,google.ima.AdEvent.Type.RESUMED,function(){a.i=!1})}function Zd(t,n,a,i){var r=this;this.o=t,this.i=n,this.s=null,this.u=NaN,this.l=i,this.j=null,this.h=new Ta,google.ima.settings.setLocale(a),(t=new google.ima.AdDisplayContainer(this.o,this.i)).initialize(),this.m=new google.ima.AdsLoader(t),this.m.getSettings().setPlayerType("shaka-player"),this.m.getSettings().setPlayerVersion("v4.3.5-7-g4c71172e-dirty"),this.g=null,this.h.ma(this.m,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){!function(t,n){t.l(new _a("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-t.u))),t.g=n.getAdsManager(t.i),t.l(new _a("ima-ad-manager-loaded",(new Map).set("imaAdManager",t.g)));var a=t.g.getCuePoints();if(a.length){n=[];for(var i=(a=d(a)).next();!i.done;i=a.next())n.push({start:i.value,end:null});t.l(new _a("ad-cue-points-changed",(new Map).set("cuepoints",n)))}!function(e){function t(t,n){t=(new Map).set("originalEvent",t),e.l(new _a(n,t))}e.h.C(e.g,google.ima.AdErrorEvent.Type.AD_ERROR,function(t){$d(e,t)}),e.h.C(e.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(t){tl(e,t)}),e.h.C(e.g,google.ima.AdEvent.Type.STARTED,function(t){tl(e,t)}),e.h.C(e.g,google.ima.AdEvent.Type.FIRST_QUARTILE,function(e){t(e,"ad-first-quartile")}),e.h.C(e.g,google.ima.AdEvent.Type.MIDPOINT,function(e){t(e,"ad-midpoint")}),e.h.C(e.g,google.ima.AdEvent.Type.THIRD_QUARTILE,function(e){t(e,"ad-third-quartile")}),e.h.C(e.g,google.ima.AdEvent.Type.COMPLETE,function(e){t(e,"ad-complete")}),e.h.C(e.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(t){nl(e,t)}),e.h.C(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(t){nl(e,t)}),e.h.C(e.g,google.ima.AdEvent.Type.SKIPPED,function(e){t(e,"ad-skipped")}),e.h.C(e.g,google.ima.AdEvent.Type.VOLUME_CHANGED,function(e){t(e,"ad-volume-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.VOLUME_MUTED,function(e){t(e,"ad-muted")}),e.h.C(e.g,google.ima.AdEvent.Type.PAUSED,function(n){e.j&&(e.j.i=!0,t(n,"ad-paused"))}),e.h.C(e.g,google.ima.AdEvent.Type.RESUMED,function(n){e.j&&(e.j.i=!1,t(n,"ad-resumed"))}),e.h.C(e.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,function(n){e.j&&t(n,"ad-skip-state-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.CLICK,function(e){t(e,"ad-clicked")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_PROGRESS,function(e){t(e,"ad-progress")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_BUFFERING,function(e){t(e,"ad-buffering")}),e.h.C(e.g,google.ima.AdEvent.Type.IMPRESSION,function(e){t(e,"ad-impression")}),e.h.C(e.g,google.ima.AdEvent.Type.DURATION_CHANGE,function(e){t(e,"ad-duration-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.USER_CLOSE,function(e){t(e,"ad-closed")}),e.h.C(e.g,google.ima.AdEvent.Type.LOADED,function(e){t(e,"ad-loaded")}),e.h.C(e.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,function(e){t(e,"all-ads-completed")}),e.h.C(e.g,google.ima.AdEvent.Type.LINEAR_CHANGED,function(e){t(e,"ad-linear-changed")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_METADATA,function(e){t(e,"ad-metadata")}),e.h.C(e.g,google.ima.AdEvent.Type.LOG,function(e){t(e,"ad-recoverable-error")}),e.h.C(e.g,google.ima.AdEvent.Type.AD_BREAK_READY,function(e){t(e,"ad-break-ready")}),e.h.C(e.g,google.ima.AdEvent.Type.INTERACTION,function(e){t(e,"ad-interaction")})}(t);try{t.g.init(t.i.offsetWidth,t.i.offsetHeight,el(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.h.C(t.i,"loadeddata",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,el(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),"ResizeObserver"in e?(t.s=new ResizeObserver(function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,el(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),t.s.observe(t.i)):t.h.C(document,"fullscreenchange",function(){t.g.resize(t.i.offsetWidth,t.i.offsetHeight,el(t)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}),t.i.addEventListener("play",function(){t.g.start()},{once:!0})}catch(e){nl(t,null)}}(r,t)}),this.h.C(this.m,google.ima.AdErrorEvent.Type.AD_ERROR,function(e){$d(r,e)}),this.i.onended=function(){r.m.contentComplete()}}function $d(e,t){t.getError(),nl(e,null),e.l(new _a("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function el(e){return document.fullscreenEnabled?!!document.fullscreenElement:!!(e=e.i).webkitSupportsFullscreen&&e.webkitDisplayingFullscreen}function tl(e,t){var n=t.getAd();n?(e.j=new Xd(n,e.g,e.i),t=(new Map).set("ad",e.j).set("sdkAdObject",n).set("originalEvent",t),e.l(new _a("ad-started",t)),e.j.isLinear()&&(e.o.setAttribute("ad-active","true"),e.i.pause())):W("The IMA SDK fired a "+t.type+" event with no associated ad. Unable to play ad!")}function nl(e,t){e.l(new _a("ad-stopped",(new Map).set("originalEvent",t))),e.j&&e.j.isLinear()&&(e.o.removeAttribute("ad-active"),e.i.play())}function al(e,t){this.i=e,this.h=null,this.g=t}function il(e,t,n,a){var i=this;this.s=e,this.l=t,this.j=null,this.G=NaN,this.i=a,this.F=!1,this.u=this.m=this.o=null,this.B="",this.D=[],this.h=new Ta,(e=new google.ima.dai.api.UiSettings).setLocale(n),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,e),this.i(new _a("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,function(e){!function(e,t){e.i(new _a("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-e.G))),t=t.getStreamData().url,e.j.resolve(t),e.j=null,e.F||e.h.C(e.l,"seeked",function(){var t=e.l.currentTime;if(0!=t){e.g.streamTimeForContentTime(t);var n=e.g.previousCuePointForStreamTime(t);n&&!n.played&&(e.o=t,e.l.currentTime=n.start)}})}(i,e)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,function(){i.B.length?i.j.resolve(i.B):i.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),i.j=null}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,function(){}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,function(e){e=e.getAd(),i.m=new al(e,i.l),i.u&&(i.m.h=i.u),i.i(new _a("ad-started",(new Map).set("ad",i.m))),i.s.setAttribute("ad-active","true")}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,function(){i.s.removeAttribute("ad-active");var e=i.l.currentTime;i.o&&i.o>e&&(i.l.currentTime=i.o,i.o=null)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,function(e){i.u=e.getStreamData().adProgressData,i.m&&(i.m.h=i.u)}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,function(){i.i(new _a("ad-first-quartile"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,function(){i.i(new _a("ad-midpoint"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,function(){i.i(new _a("ad-third-quartile"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,function(){i.i(new _a("ad-complete")),i.i(new _a("ad-stopped")),i.s.removeAttribute("ad-active"),i.m=null}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,function(){i.i(new _a("ad-skipped")),i.i(new _a("ad-stopped"))}),this.h.C(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,function(e){var t=e.getStreamData();e=[];for(var n=(t=d(t.cuepoints)).next();!n.done;n=t.next())n=n.value,e.push({start:n.start,end:n.end});i.D=e,i.i(new _a("ad-cue-points-changed",(new Map).set("cuepoints",e)))})}function rl(){ga.call(this),this.g=this.i=null,this.h=new Jd,this.j=navigator.language}function ol(e){return JSON.stringify(e,function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof _a){var n={};for(a in t)(e=t[a])&&"object"==typeof e?"detail"==a&&(n[a]=e):a in Event||(n[a]=e);return n}if(t instanceof Error){var a=new Set(["name","message","stack"]);for(n in t)a.add(n);for(n=(e=d(Object.getOwnPropertyNames(t))).next();!n.done;n=e.next())a.add(n.value);for(e={},n=(a=d(a)).next();!n.done;n=a.next())e[n=n.value]=t[n];t={__type__:"Error",contents:e}}else if(t instanceof TimeRanges){for(a={__type__:"TimeRanges",length:t.length,start:[],end:[]},n=(t=d(yo(t))).next();!n.done;n=t.next())e=(n=n.value).end,a.start.push(n.start),a.end.push(e);t=a}else t=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return t}})}function sl(e){return JSON.parse(e,function(e,t){if("NaN"==t)var n=NaN;else if("-Infinity"==t)n=-1/0;else if("Infinity"==t)n=1/0;else if(t&&"object"==typeof t&&"TimeRanges"==t.__type__)n=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==typeof t&&"Uint8Array"==t.__type__)n=new Uint8Array(t.entries);else if(t&&"object"==typeof t&&"Error"==t.__type__){for(n in e=t.contents,t=Error(e.message),e)t[n]=e[n];n=t}else n=t;return n})}(a=Xd.prototype).getDuration=function(){return this.h.getDuration()},a.getMinSuggestedDuration=function(){return this.h.getMinSuggestedDuration()},a.getRemainingTime=function(){return this.g.getRemainingTime()},a.isPaused=function(){return this.i},a.isSkippable=function(){return 0<=this.h.getSkipTimeOffset()},a.getTimeUntilSkippable=function(){var e=this.h.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},a.canSkipNow=function(){return this.g.getAdSkippableState()},a.skip=function(){return this.g.skip()},a.pause=function(){return this.g.pause()},a.play=function(){return this.g.resume()},a.getVolume=function(){return this.g.getVolume()},a.setVolume=function(e){return this.g.setVolume(e)},a.isMuted=function(){return 0==this.g.getVolume()},a.isLinear=function(){return this.h.isLinear()},a.resize=function(e,t){var n=!1,a=this.m;document.fullscreenEnabled?n=!!document.fullscreenElement:a.webkitSupportsFullscreen&&(n=a.webkitDisplayingFullscreen),this.g.resize(e,t,n?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},a.setMuted=function(e){e?(this.l=this.getVolume(),this.setVolume(0)):this.setVolume(this.l)},a.getSequenceLength=function(){var e=this.h.getAdPodInfo();return null==e?1:e.getTotalAds()},a.getPositionInSequence=function(){var e=this.h.getAdPodInfo();return null==e?1:e.getAdPosition()},a.getTitle=function(){return this.h.getTitle()},a.getDescription=function(){return this.h.getDescription()},a.release=function(){this.g=this.h=null},B("shaka.ads.ClientSideAd",Xd),Xd.prototype.release=Xd.prototype.release,Xd.prototype.getDescription=Xd.prototype.getDescription,Xd.prototype.getTitle=Xd.prototype.getTitle,Xd.prototype.getPositionInSequence=Xd.prototype.getPositionInSequence,Xd.prototype.getSequenceLength=Xd.prototype.getSequenceLength,Xd.prototype.setMuted=Xd.prototype.setMuted,Xd.prototype.resize=Xd.prototype.resize,Xd.prototype.isLinear=Xd.prototype.isLinear,Xd.prototype.isMuted=Xd.prototype.isMuted,Xd.prototype.setVolume=Xd.prototype.setVolume,Xd.prototype.getVolume=Xd.prototype.getVolume,Xd.prototype.play=Xd.prototype.play,Xd.prototype.pause=Xd.prototype.pause,Xd.prototype.skip=Xd.prototype.skip,Xd.prototype.canSkipNow=Xd.prototype.canSkipNow,Xd.prototype.getTimeUntilSkippable=Xd.prototype.getTimeUntilSkippable,Xd.prototype.isSkippable=Xd.prototype.isSkippable,Xd.prototype.isPaused=Xd.prototype.isPaused,Xd.prototype.getRemainingTime=Xd.prototype.getRemainingTime,Xd.prototype.getMinSuggestedDuration=Xd.prototype.getMinSuggestedDuration,Xd.prototype.getDuration=Xd.prototype.getDuration,Zd.prototype.stop=function(){this.g&&this.g.stop(),this.o&&cc(this.o)},Zd.prototype.release=function(){this.stop(),this.s&&this.s.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.m.destroy()},(a=al.prototype).getDuration=function(){return this.h?this.h.duration:-1},a.getMinSuggestedDuration=function(){return this.getDuration()},a.getRemainingTime=function(){return this.h?this.h.duration-this.h.currentTime:-1},a.isPaused=function(){return this.g.paused},a.isSkippable=function(){return this.i.isSkippable()},a.getTimeUntilSkippable=function(){var e=this.i.getSkipTimeOffset();return e=this.getRemainingTime()-e,Math.max(e,0)},a.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},a.skip=function(){this.g.currentTime+=this.getRemainingTime()},a.pause=function(){return this.g.pause()},a.play=function(){return this.g.play()},a.getVolume=function(){return this.g.volume},a.setVolume=function(e){this.g.volume=e},a.isMuted=function(){return this.g.muted},a.isLinear=function(){return!0},a.resize=function(){},a.setMuted=function(e){this.g.muted=e},a.getSequenceLength=function(){var e=this.i.getAdPodInfo();return null==e?1:e.getTotalAds()},a.getPositionInSequence=function(){var e=this.i.getAdPodInfo();return null==e?1:e.getAdPosition()},a.getTitle=function(){return this.i.getTitle()},a.getDescription=function(){return this.i.getDescription()},a.release=function(){this.g=this.h=this.i=null},B("shaka.ads.ServerSideAd",al),al.prototype.release=al.prototype.release,al.prototype.getDescription=al.prototype.getDescription,al.prototype.getTitle=al.prototype.getTitle,al.prototype.getPositionInSequence=al.prototype.getPositionInSequence,al.prototype.getSequenceLength=al.prototype.getSequenceLength,al.prototype.setMuted=al.prototype.setMuted,al.prototype.resize=al.prototype.resize,al.prototype.isLinear=al.prototype.isLinear,al.prototype.isMuted=al.prototype.isMuted,al.prototype.setVolume=al.prototype.setVolume,al.prototype.getVolume=al.prototype.getVolume,al.prototype.play=al.prototype.play,al.prototype.pause=al.prototype.pause,al.prototype.skip=al.prototype.skip,al.prototype.canSkipNow=al.prototype.canSkipNow,al.prototype.getTimeUntilSkippable=al.prototype.getTimeUntilSkippable,al.prototype.isSkippable=al.prototype.isSkippable,al.prototype.isPaused=al.prototype.isPaused,al.prototype.getRemainingTime=al.prototype.getRemainingTime,al.prototype.getMinSuggestedDuration=al.prototype.getMinSuggestedDuration,al.prototype.getDuration=al.prototype.getDuration,il.prototype.stop=function(){this.B="",this.o=null,this.D=[]},il.prototype.release=function(){this.stop(),this.h&&this.h.release()},il.prototype.onCueMetadataChange=function(e){if(e.key&&e.data){var t={};t[e.key]=e.data,this.g.onTimedMetadata(t)}},h(rl,ga),(a=rl.prototype).setLocale=function(e){this.j=e},a.initClientSide=function(t,n){var a=this;if(!e.google||!google.ima||!google.ima.AdsLoader)throw new ke(2,10,1e4);this.i&&this.i.release(),this.i=new Zd(t,n,this.j,function(e){if(e&&e.type)switch(e.type){case"ads-loaded":a.h.h.push(e.loadTime);break;case"ad-started":a.h.g++;break;case"ad-complete":a.h.i++;break;case"ad-skipped":a.h.j++}a.dispatchEvent(e)})},a.release=function(){this.i&&(this.i.release(),this.i=null),this.g&&(this.g.release(),this.g=null),ga.prototype.release.call(this)},a.onAssetUnload=function(){this.i&&this.i.stop(),this.g&&this.g.stop(),this.dispatchEvent(new _a("ad-stopped")),this.h=new Jd},a.requestClientSideAds=function(e){if(!this.i)throw new ke(1,10,10001);var t=this.i;t.u=Date.now()/1e3,t.m.requestAds(e)},a.initServerSide=function(t,n){var a=this;if(!e.google||!google.ima||!google.ima.dai)throw new ke(2,10,10002);this.g&&this.g.release(),this.g=new il(t,n,this.j,function(e){if(e&&e.type)switch(e.type){case"ads-loaded":a.h.h.push(e.loadTime);break;case"ad-started":a.h.g++;break;case"ad-complete":a.h.i++;break;case"ad-skipped":a.h.j++}a.dispatchEvent(e)})},a.requestServerSideStream=function(e,t){if(t=void 0===t?"":t,!this.g)throw new ke(1,10,10003);e.adTagParameters||(e.adTagParameters={});var n=e.adTagParameters;return(n.mpt||n.mpv)&&W('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.adTagParameters.mpt="shaka-player",e.adTagParameters.mpv="v4.3.5-7-g4c71172e-dirty",(n=this.g).j?e=Promise.reject(new ke(1,10,10004)):(e instanceof google.ima.dai.api.LiveStreamRequest&&(n.F=!0),n.j=new at,n.g.requestStream(e),n.B=t||"",n.G=Date.now()/1e3,e=n.j),e},a.replaceServerSideAdTagParameters=function(e){if(!this.g)throw new ke(1,10,10003);(e.mpt||e.mpv)&&W('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),e.mpt="Shaka Player",e.mpv="v4.3.5-7-g4c71172e-dirty",this.g.g.replaceAdTagParameters(e)},a.getServerSideCuePoints=function(){if(!this.g)throw new ke(1,10,10003);return this.g.D},a.getStats=function(){var e=this.h;return{loadTimes:e.h,started:e.g,playedCompletely:e.i,skipped:e.j}},a.onDashTimedMetadata=function(e){if(this.g&&"urn:google:dai:2018"==e.schemeIdUri){var t=e.schemeIdUri,n=e.eventElement?e.eventElement.getAttribute("messageData"):null;this.g.g.processMetadata(t,n,e.startTime)}},a.onHlsTimedMetadata=function(e,t){this.g&&this.g.g.processMetadata("ID3",e.data,t)},a.onCueMetadataChange=function(e){this.g&&this.g.onCueMetadataChange(e)},B("shaka.ads.AdManager",rl),rl.prototype.onCueMetadataChange=rl.prototype.onCueMetadataChange,rl.prototype.onHlsTimedMetadata=rl.prototype.onHlsTimedMetadata,rl.prototype.onDashTimedMetadata=rl.prototype.onDashTimedMetadata,rl.prototype.getStats=rl.prototype.getStats,rl.prototype.getServerSideCuePoints=rl.prototype.getServerSideCuePoints,rl.prototype.replaceServerSideAdTagParameters=rl.prototype.replaceServerSideAdTagParameters,rl.prototype.requestServerSideStream=rl.prototype.requestServerSideStream,rl.prototype.initServerSide=rl.prototype.initServerSide,rl.prototype.requestClientSideAds=rl.prototype.requestClientSideAds,rl.prototype.onAssetUnload=rl.prototype.onAssetUnload,rl.prototype.release=rl.prototype.release,rl.prototype.initClientSide=rl.prototype.initClientSide,rl.prototype.setLocale=rl.prototype.setLocale,rl.ADS_LOADED="ads-loaded",rl.AD_STARTED="ad-started",rl.AD_FIRST_QUARTILE="ad-first-quartile",rl.AD_MIDPOINT="ad-midpoint",rl.AD_THIRD_QUARTILE="ad-third-quartile",rl.AD_COMPLETE="ad-complete",rl.AD_STOPPED="ad-stopped",rl.AD_SKIPPED="ad-skipped",rl.AD_VOLUME_CHANGED="ad-volume-changed",rl.AD_MUTED="ad-muted",rl.AD_PAUSED="ad-paused",rl.AD_RESUMED="ad-resumed",rl.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",rl.CUEPOINTS_CHANGED="ad-cue-points-changed",rl.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",rl.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",rl.AD_CLICKED="ad-clicked",rl.AD_PROGRESS="ad-progress",rl.AD_BUFFERING="ad-buffering",rl.AD_IMPRESSION="ad-impression",rl.AD_DURATION_CHANGED="ad-duration-changed",rl.AD_CLOSED="ad-closed",rl.AD_LOADED="ad-loaded",rl.ALL_ADS_COMPLETED="all-ads-completed",rl.AD_LINEAR_CHANGED="ad-linear-changed",rl.AD_METADATA="ad-metadata",rl.AD_RECOVERABLE_ERROR="ad-recoverable-error",rl.AD_BREAK_READY="ad-break-ready",rl.AD_INTERACTION="ad-interaction",qd=function(){return new rl};var cl="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),dl="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),ll=["loop","playbackRate"],ul=["pause","play"],fl={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10},pl={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},ml={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},_l=[["getConfiguration","configure"]],hl=[["isTextTrackVisible","setTextTrackVisibility"]],bl="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),gl=["attach","attachCanvas","detach","load","unload"];function vl(e,t,n,a,i,r,o){var s=this;this.G=e,this.M=o,this.j=new ot(t),this.O=n,this.u=!1,this.s=a,this.F=i,this.J=r,this.h=this.m=!1,this.L="",this.o=null,this.B=function(){return xl(s)},this.D=function(e,t){switch((e=sl(t)).type){case"event":var n=e.targetName,a=ha(e.event);s.s(n,a);break;case"update":for(a in n=e.update)for(var i in e=s.g[a]||{},n[a])e[i]=n[a][i];s.u&&(s.O(),s.u=!1);break;case"asyncComplete":if(a=e.id,i=e.error,e=s.i[a],delete s.i[a],e)if(i){for(n in a=new ke(i.severity,i.category,i.code),i)a[n]=i[n];e.reject(a)}else e.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.l=null,kl.add(this)}function yl(e,t,n){Al=n,n.addUpdateListener(e.B),n.addMessageListener("urn:x-cast:com.google.shaka.v2",e.D),xl(e),Ol(e,{type:"init",initState:t,appData:e.o}),e.l.resolve()}function Sl(e,t){var n=8003;switch(t.code){case"cancel":n=8004;break;case"timeout":n=8005;break;case"receiver_unavailable":n=8006}e.l.reject(new ke(2,8,n,t))}function Dl(e,t){var n=e.J();e.l=new at,e.u=!0,yl(e,n,t)}function Il(e){var t=Al;t.removeUpdateListener(e.B),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.D)}function xl(e){var t=!!Al&&"connected"==Al.status;if(e.h&&!t){for(var n in e.F(),e.g)e.g[n]={};Cl(e)}e.h=t,e.L=t?Al.receiver.friendlyName:"",e.j.Mb()}function Cl(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new ke(1,7,7e3))}}function Ol(e,t){t=ol(t);var n=Al;try{n.sendMessage("urn:x-cast:com.google.shaka.v2",t,function(){},Q)}catch(a){throw t=new ke(2,8,8005,a),n=new _a("error",(new Map).set("detail",t)),e.s("player",n),e.Bb(),t}}(a=vl.prototype).destroy=function(){return kl.delete(this),Cl(this),Al&&Il(this),this.j&&(this.j.stop(),this.j=null),this.F=this.s=null,this.h=this.m=!1,this.D=this.B=this.l=this.i=this.g=this.o=null,Promise.resolve()},a.ta=function(){return this.h},a.$d=function(){return this.L},a.init=function(){if(this.G.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.Mb();var t=new chrome.cast.SessionRequest(this.G,[],null,this.M,null);t=new chrome.cast.ApiConfig(t,function(e){for(var t=d(kl),n=t.next();!n.done;n=t.next())Dl(n.value,e)},function(e){for(var t=d(kl),n=t.next();!n.done;n=t.next())n=n.value,El="available"==e,n.j.Mb()},"origin_scoped"),chrome.cast.initialize(t,function(){},function(){}),El&&this.j.N(wl),(t=Al)&&t.status!=chrome.cast.SessionStatus.STOPPED?Dl(this,t):Al=null}else e.__onGCastApiAvailable!==Ml&&(Ll=e.__onGCastApiAvailable||null,e.__onGCastApiAvailable=Ml)},a.he=function(e){this.o=e,this.h&&Ol(this,{type:"appData",appData:this.o})},a.cast=function(e){var t=this;return M(function(n){if(!t.m)throw new ke(1,8,8e3);if(!El)throw new ke(1,8,8001);if(t.h)throw new ke(1,8,8002);return t.l=new at,chrome.cast.requestSession(function(n){return yl(t,e,n)},function(e){return Sl(t,e)}),y(n,t.l,0)})},a.Bb=function(){if(this.h){if(Cl(this),Al){Il(this);try{Al.stop(function(){},function(){})}catch(e){}Al=null}xl(this)}},a.get=function(e,t){var n=this;if("video"==e){if(ul.includes(t))return function(){return n.Pe.apply(n,[e,t].concat(l(P.apply(0,arguments))))}}else if("player"==e){if(ml[t]&&!this.get("player","isLive")())return function(){};if(bl.includes(t))return function(){return n.Pe.apply(n,[e,t].concat(l(P.apply(0,arguments))))};if(gl.includes(t))return function(){return n.ng.apply(n,[e,t].concat(l(P.apply(0,arguments))))};if(fl[t]||pl[t])return function(){return n.g[e][t]}}return this.g[e][t]},a.set=function(e,t,n){this.g[e][t]=n,Ol(this,{type:"set",targetName:e,property:t,value:n})},a.Pe=function(e,t){Ol(this,{type:"call",targetName:e,methodName:t,args:P.apply(2,arguments)})},a.ng=function(e,t){var n=P.apply(2,arguments),a=new at,i=this.H.toString();this.H++,this.i[i]=a;try{Ol(this,{type:"asyncCall",targetName:e,methodName:t,args:n,id:i})}catch(e){a.reject(e)}return a};var wl=.02,El=!1,Al=null,Ll=null,kl=new Set;function Ml(t){if(Ll?e.__onGCastApiAvailable=Ll:delete e.__onGCastApiAvailable,Ll=null,t)for(var n=d(kl),a=n.next();!a.done;a=n.next())a.value.init();"function"==typeof e.__onGCastApiAvailable&&e.__onGCastApiAvailable(t)}function Pl(e,t,n,a){a=void 0!==a&&a,ga.call(this);var i=this;this.i=e,this.h=t,this.m=this.o=this.j=this.s=this.l=null,this.D=n,this.B=a,this.u=new Map,this.g=new vl(n,function(){return Fl(i)},function(){return Hl(i)},function(e,t){return Bl(i,e,t)},function(){return Rl(i)},function(){return Ul(i)},a),function(e){e.g.init(),e.m=new Ta;for(var t=d(cl),n=t.next();!n.done;n=t.next())e.m.C(e.i,n.value,function(t){e.g.ta()||(t=ha(t),e.j.dispatchEvent(t))});for(var a in ba)e.m.C(e.h,ba[a],function(t){e.g.ta()||e.o.dispatchEvent(t)});for(var i in e.l={},t={},e.i)t.Sb=i,Object.defineProperty(e.l,t.Sb,{configurable:!1,enumerable:!0,get:function(t){return function(){return Nl(e,t.Sb)}}(t),set:function(t){return function(n){var a=t.Sb;e.g.ta()?e.g.set("video",a,n):e.i[a]=n}}(t)}),t={Sb:t.Sb};e.s={},Tl(e,function(t){Object.defineProperty(e.s,t,{configurable:!1,enumerable:!0,get:function(){return function(e,t){if(e.u.has(t)&&(t=e.u.get(t)),"addEventListener"==t)return function(t,n,a){return e.o.addEventListener(t,n,a)};if("removeEventListener"==t)return function(t,n,a){return e.o.removeEventListener(t,n,a)};if("getMediaElement"==t)return function(){return e.l};if("getSharedConfiguration"==t)return e.g.get("player","getConfiguration");if("getNetworkingEngine"==t)return function(){return e.h.jc()};if("getDrmEngine"==t)return function(){return e.h.m};if("getAdManager"==t)return function(){return e.h.Ee()};if("setVideoContainer"==t)return function(t){return e.h.Ze(t)};if(e.g.ta()){if("getManifest"==t||"drmInfo"==t)return function(){return W(t+"() does not work while casting!"),null};if("attach"==t||"detach"==t)return function(){return W(t+"() does not work while casting!"),Promise.resolve()}}return e.g.ta()&&0==Object.keys(e.g.g.video).length&&(fl[t]||pl[t])||!e.g.ta()?e.h[t].bind(e.h):e.g.get("player",t)}(e,t)}})}),function(e){var t=new Map;Tl(e,function(n,a){t.has(a)?(a=t.get(a),n.length<a.length?e.u.set(n,a):e.u.set(a,n)):t.set(a,n)})}(e),e.j=new ga,e.j.Wc=e.l,e.o=new ga,e.o.Wc=e.s}(this)}function Tl(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!r.has(e)}var a,i=e.h,r=new Set;for(a in i)n(a)&&(r.add(a),t(a,i[a]));for(e=Object.getPrototypeOf(i),a=Object.getPrototypeOf({});e&&e!=a;){for(var o=d(Object.getOwnPropertyNames(e)),s=o.next();!s.done;s=o.next())n(s=s.value)&&(r.add(s),t(s,i[s]));e=Object.getPrototypeOf(e)}}function Ul(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.Ed(),startTime:null};e.i.pause();for(var n=d(ll),a=n.next();!a.done;a=n.next())a=a.value,t.video[a]=e.i[a];for(e.i.ended||(t.startTime=e.i.currentTime),a=(n=d(_l)).next();!a.done;a=n.next()){var i=a.value;a=i[1],i=e.h[i[0]](),t.player[a]=i}for(a=(n=d(hl)).next();!a.done;a=n.next())a=(i=a.value)[1],i=e.h[i[0]](),t.playerAfterLoad[a]=i;return t}function Fl(e){var t=new _a("caststatuschanged");e.dispatchEvent(t)}function Hl(e){var t=new _a(e.l.paused?"pause":"play");e.j.dispatchEvent(t)}function Rl(e){for(var t=d(_l),n=t.next();!n.done;n=t.next()){var a=n.value;n=a[1],a=e.g.get("player",a[0])(),e.h[n](a)}var i=e.g.get("player","getAssetUri")();n=e.g.get("video","ended"),t=Promise.resolve();var r=e.i.autoplay;a=null,n||(a=e.g.get("video","currentTime")),i&&(e.i.autoplay=!1,t=e.h.load(i,a));var o={};for(a=(n=d(ll)).next();!a.done;a=n.next())a=a.value,o[a]=e.g.get("video",a);t.then(function(){if(e.i){for(var t=d(ll),n=t.next();!n.done;n=t.next())n=n.value,e.i[n]=o[n];for(n=(t=d(hl)).next();!n.done;n=t.next()){var a=n.value;n=a[1],a=e.g.get("player",a[0])(),e.h[n](a)}e.i.autoplay=r,i&&e.i.play()}},function(t){t=new _a("error",t=(new Map).set("detail",t)),e.h.dispatchEvent(t)})}function Nl(e,t){if("addEventListener"==t)return function(t,n,a){return e.j.addEventListener(t,n,a)};if("removeEventListener"==t)return function(t,n,a){return e.j.removeEventListener(t,n,a)};if(e.g.ta()&&0==Object.keys(e.g.g.video).length){var n=e.i[t];if("function"!=typeof n)return n}return e.g.ta()?e.g.get("video",t):("function"==typeof(t=e.i[t])&&(t=t.bind(e.i)),t)}function Bl(e,t,n){e.g.ta()&&("video"==t?e.j.dispatchEvent(n):"player"==t&&e.o.dispatchEvent(n))}function jl(e,t,n,a){ga.call(this);var i=this;this.g=e,this.h=t,this.j=new Ta,this.H={video:e,player:t},this.D=n||function(){},this.J=a||function(e){return e},this.i=null,this.F=!1,this.o=!0,this.m=0,this.B=!1,this.u=!0,this.s=this.l=null,this.G=new ot(function(){Kl(i)}),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=function(){return Vl(e)},t.onSenderDisconnected=function(){return Vl(e)},t.onSystemVolumeChanged=function(){var t=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();t&&Yl(e,{type:"update",update:{video:{volume:t.level,muted:t.muted}}},e.l),Yl(e,{type:"event",targetName:"video",event:{type:"volumechange"}},e.l)},e.s=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.s.onMessage=function(t){return function(e,t){var n=sl(t.data);switch(n.type){case"PLAY":e.g.play(),Jl(e);break;case"PAUSE":e.g.pause(),Jl(e);break;case"SEEK":t=n.currentTime;var a=n.resumeState;null!=t&&(e.g.currentTime=Number(t)),a&&"PLAYBACK_START"==a?(e.g.play(),Jl(e)):a&&"PLAYBACK_PAUSE"==a&&(e.g.pause(),Jl(e));break;case"STOP":e.h.pe().then(function(){e.h&&Jl(e)});break;case"GET_STATUS":ql(e,Number(n.requestId));break;case"VOLUME":t=(a=n.volume).level,a=a.muted;var i=e.g.volume,r=e.g.muted;null!=t&&(e.g.volume=Number(t)),null!=a&&(e.g.muted=a),i==e.g.volume&&r==e.g.muted||Jl(e);break;case"LOAD":e.m=0,e.B=!1,e.u=!1,t=n.media,a=n.currentTime,i=e.J(t.contentId),r=n.autoplay||!0,e.D(t.customData),r&&(e.g.autoplay=!0),e.h.load(i,a).then(function(){e.h&&ql(e)}).catch(function(t){var a="LOAD_FAILED";7==t.category&&7e3==t.code&&(a="LOAD_CANCELLED"),Yl(e,{requestId:Number(n.requestId),type:a},e.s)});break;default:Yl(e,{requestId:Number(n.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},e.s)}}(e,t)},e.l=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.l.onMessage=function(t){return function(e,t){var n=sl(t.data);switch(n.type){case"init":e.m=0,e.B=!1,e.u=!0,function(e,t,n){var a,i,r,o,s,c,d,l,u,f;M(function(p){switch(p.g){case 1:for(a in t.player)i=t.player[a],e.h[a](i);return e.D(n),r=e.g.autoplay,t.manifest?(e.g.autoplay=!1,D(p,5),y(p,e.h.load(t.manifest,t.startTime),7)):y(p,Promise.resolve(),3);case 7:x(p,3);break;case 5:return o=C(p),s=(new Map).set("detail",o),c=new _a("error",s),e.h&&e.h.dispatchEvent(c),p.return();case 3:if(!e.h)return p.return();for(d in t.video)l=t.video[d],e.g[d]=l;for(u in t.playerAfterLoad)f=t.playerAfterLoad[u],e.h[u](f);e.g.autoplay=r,t.manifest&&(e.g.play(),Jl(e)),S(p)}})}(e,n.initState,n.appData),Kl(e);break;case"appData":e.D(n.appData);break;case"set":var a=n.targetName,i=n.property;if(n=n.value,"video"==a){if(t=cast.receiver.CastReceiverManager.getInstance(),"volume"==i){t.setSystemVolumeLevel(n);break}if("muted"==i){t.setSystemVolumeMuted(n);break}}e.H[a][i]=n;break;case"call":(a=e.H[n.targetName])[n.methodName].apply(a,n.args);break;case"asyncCall":a=n.targetName,i=n.methodName,"player"==a&&"load"==i&&(e.m=0,e.B=!1);var r=n.id,o=t.senderId;n=(t=e.H[a])[i].apply(t,n.args),"player"==a&&"load"==i&&(n=n.then(function(){e.u=!0})),n.then(function(){return Ql(e,o,r,null)},function(t){return Ql(e,o,r,t)})}}(e,t)},t.start();for(var n=(t=d(cl)).next();!n.done;n=t.next())e.j.C(e.g,n.value,function(t){return Gl(e,"video",t)});for(var a in ba)e.j.C(e.h,ba[a],function(t){return Gl(e,"player",t)});cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.je(3840,2160):e.h.je(1920,1080),e.j.C(e.g,"loadeddata",function(){e.B=!0}),e.j.C(e.h,"loading",function(){e.o=!1,zl(e)}),e.j.C(e.g,"playing",function(){e.o=!1,zl(e)}),e.j.C(e.g,"pause",function(){zl(e)}),e.j.C(e.h,"unloading",function(){e.o=!0,zl(e)}),e.j.C(e.g,"ended",function(){new ot(function(){e.g&&e.g.ended&&(e.o=!0,zl(e))}).N(Zl)})}(this)}function Vl(e){e.m=0,e.u=!0,e.F=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,zl(e)}function zl(e){var t;M(function(n){return 1==n.g?y(n,Promise.resolve(),2):e.h?(t=new _a("caststatuschanged"),e.dispatchEvent(t),Wl(e)||Jl(e),void S(n)):n.return()})}function Gl(e,t,n){e.h&&(Kl(e),Yl(e,{type:"event",targetName:t,event:n},e.l))}function Kl(e){e.G.N(Xl);for(var t={video:{},player:{}},n=d(dl),a=n.next();!a.done;a=n.next())a=a.value,t.video[a]=e.g[a];if(e.h.T())for(var i in ml)0==e.m%ml[i]&&(t.player[i]=e.h[i]());for(var r in fl)0==e.m%fl[r]&&(t.player[r]=e.h[r]());for(var o in(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),Yl(e,{type:"update",update:t},e.l),pl)0==e.m%pl[o]&&((t={player:{}}).player[o]=e.h[o](),Yl(e,{type:"update",update:t},e.l));e.B&&(e.m+=1),Wl(e)}function Wl(e){return!(!e.u||!e.g.duration&&!e.h.T()||(ql(e),e.u=!1,0))}function ql(e,t){var n={contentId:e.h.Ed(),streamType:e.h.T()?"LIVE":"BUFFERED",contentType:""};e.h.T()||(n.duration=e.g.duration),e.i&&(n.metadata=e.i),Jl(e,void 0===t?0:t,n)}function Ql(e,t,n,a){e.h&&Yl(e,{type:"asyncComplete",id:n,error:a},e.l,t)}function Yl(e,t,n,a){e.F&&(e=ol(t),a?n.getCastChannel(a).send(e):n.broadcast(e))}function Jl(e,t,n){n=void 0===n?null:n;var a={mediaSessionId:0,playbackRate:e.g.playbackRate,playerState:e.o?$l:e.h.Gd()?tu:e.g.paused?nu:eu,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}};n&&(a.media=n),Yl(e,{requestId:void 0===t?0:t,type:"MEDIA_STATUS",status:[a]},e.s)}h(Pl,ga),(a=Pl.prototype).destroy=function(e){return e&&this.g.Bb(),this.m&&(this.m.release(),this.m=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,ga.prototype.release.call(this),Promise.all(e)},a.Vf=function(){return this.l},a.Mf=function(){return this.s},a.mf=function(){return this.g.m&&El},a.ta=function(){return this.g.ta()},a.$d=function(){return this.g.$d()},a.cast=function(){var e,t=this;return M(function(n){return 1==n.g?(e=Ul(t),y(n,t.g.cast(e),2)):t.h?y(n,t.h.pe(),0):n.return()})},a.he=function(e){this.g.he(e)},a.yg=function(){!function(e){if(e.h){var t=e.J();chrome.cast.requestSession(function(n){return yl(e,t,n)},function(t){return Sl(e,t)})}}(this.g)},a.Bb=function(){this.g.Bb()},a.pf=function(e,t){t=void 0!==t&&t;var n=this;return M(function(a){if(1==a.g)return e==n.D&&t==n.B?a.return():(n.D=e,n.B=t,n.g.Bb(),y(a,n.g.destroy(),2));n.g=null,n.g=new vl(e,function(){return Fl(n)},function(){return Hl(n)},function(e,t){return Bl(n,e,t)},function(){return Rl(n)},function(){return Ul(n)},t),n.g.init(),S(a)})},B("shaka.cast.CastProxy",Pl),Pl.prototype.changeReceiverId=Pl.prototype.pf,Pl.prototype.forceDisconnect=Pl.prototype.Bb,Pl.prototype.suggestDisconnect=Pl.prototype.yg,Pl.prototype.setAppData=Pl.prototype.he,Pl.prototype.cast=Pl.prototype.cast,Pl.prototype.receiverName=Pl.prototype.$d,Pl.prototype.isCasting=Pl.prototype.ta,Pl.prototype.canCast=Pl.prototype.mf,Pl.prototype.getPlayer=Pl.prototype.Mf,Pl.prototype.getVideo=Pl.prototype.Vf,Pl.prototype.destroy=Pl.prototype.destroy,h(jl,ga),(a=jl.prototype).isConnected=function(){return this.F},a.Zf=function(){return this.o},a.vg=function(e){this.i=e},a.tf=function(){this.i=null},a.wg=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=e},a.ug=function(e){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:e}]},a.tg=function(e){this.i||(this.i={}),this.i.artist=e,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},a.destroy=function(){var e,t=this;return M(function(n){if(1==n.g)return t.j&&(t.j.release(),t.j=null),e=[],t.h&&(e.push(t.h.destroy()),t.h=null),t.G&&(t.G.stop(),t.G=null),t.g=null,t.H=null,t.D=null,t.F=!1,t.o=!0,t.l=null,t.s=null,ga.prototype.release.call(t),y(n,Promise.all(e),2);cast.receiver.CastReceiverManager.getInstance().stop(),S(n)})},B("shaka.cast.CastReceiver",jl),jl.prototype.destroy=jl.prototype.destroy,jl.prototype.setContentArtist=jl.prototype.tg,jl.prototype.setContentImage=jl.prototype.ug,jl.prototype.setContentTitle=jl.prototype.wg,jl.prototype.clearContentMetadata=jl.prototype.tf,jl.prototype.setContentMetadata=jl.prototype.vg,jl.prototype.isIdle=jl.prototype.Zf,jl.prototype.isConnected=jl.prototype.isConnected;var Xl=.5,Zl=5,$l="IDLE",eu="PLAYING",tu="BUFFERING",nu="PAUSED";function au(e,t,n){var a=function(e){for(var t=[],n=(e=d(e)).next();!n.done;n=e.next())(n=ru(n.value))&&t.push(n);return t}(e),i=null;e=[];var r=[],o=new Set(a.map(function(e){return e.keyId}));if(o.delete(null),1<o.size)throw new ke(2,4,4010);if(t||(r=a.filter(function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.ee||(i=e.init||i,!1)})).length&&(e=function(e,t,n,a){for(var i=[],r=(t=d(t)).next();!r.done;r=t.next()){var o=n[(r=r.value).ee];if(o){var s;if(s=ai(r.node,"urn:microsoft:playready","pro")){s=At(s.textContent);var c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);s=[{initData:ti(s,c,new Set,0),initDataType:"cenc",keyId:r.keyId}]}else s=null;if(c=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===r.ee)if(0==(c=a).size)c=null;else{var l=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);c=[{initData:ti(new Uint8Array([]),l,c,1),initDataType:"cenc",keyId:r.keyId}]}s=Xe(o,r.init||e||s||c),(o=su.get(o))&&(s.licenseServerUri=o(r)),i.push(s)}}return i}(i,r,n,o),0==e.length&&(e=[Xe("",i)])),a.length&&(t||!r.length))for(e=[],n=(t=d(Object.values(n))).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(Xe(n,i));if(o=Array.from(o)[0]||null)for(n=(t=d(e)).next();!n.done;n=t.next())for(a=(n=d(n.value.initData)).next();!a.done;a=n.next())a.value.keyId=o;return{ze:o,th:i,drmInfos:e,De:!0}}function iu(e){return(e=ai(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=Ae(e),a=n.getUint32(t,!0);if(a!=e.byteLength)return[];e:{for(e=t+6,t=[];e<n.byteLength-1;){a=n.getUint16(e,!0),e+=2;var i=n.getUint16(e,!0);if(e+=2,0!=(1&i)||i+e>n.byteLength){n=[];break e}var r=Ee(n,e,i);t.push({type:a,value:r}),e+=i}n=t}return n}(e=At(e.textContent)).filter(function(e){return e.type===ou})[0])&&(e=vi(e=St(e.value,!0),"WRMHEADER"))?function(e){for(var t=(e=d(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=d(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""}function ru(e){var t=e.getAttribute("schemeIdUri"),n=oi(e,"urn:mpeg:cenc:2013","default_KID"),a=ri(e,"urn:mpeg:cenc:2013","pssh").map(ci);if(!t)return null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new ke(2,4,4009);var i=[];try{i=a.map(function(e){return{initDataType:"cenc",initData:At(e),keyId:null}})}catch(e){throw new ke(2,4,4007)}return{node:e,ee:t,keyId:n,init:0<i.length?i:null}}var ou=1,su=(new Map).set("com.widevine.alpha",function(e){return(e=ai(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""}).set("com.microsoft.playready",iu).set("com.microsoft.playready.recommendation",iu).set("com.microsoft.playready.software",iu).set("com.microsoft.playready.hardware",iu).set("org.w3.clearkey",function(e){return(e=ai(e.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===e.getAttribute("Lic_type")&&e.textContent?e.textContent:""});function cu(t,n,a,i,r){var o={RepresentationID:n,Number:a,Bandwidth:i,Time:r};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(t,n,a,i){if("$$"==t)return"$";var r=o[n];if(null==r)return t;switch("RepresentationID"==n&&a&&(a=void 0),"Time"==n&&(r=Math.round(r)),i){default:t=r.toString();break;case"o":t=r.toString(8);break;case"x":t=r.toString(16);break;case"X":t=r.toString(16).toUpperCase()}return a=e.parseInt(a,10)||1,Array(Math.max(0,a-t.length)+1).join("0")+t})}function du(e,t){var n=lu(e,t,"timescale"),a=1;n&&(a=_i(n)||1);var i=lu(e,t,"duration");n=_i(i||""),"image"==e.I.contentType&&(n=bi(i||"")),n&&(n/=a);var r=lu(e,t,"startNumber");i=Number(lu(e,t,"presentationTimeOffset"))||0;var o=hi(r||"");if(null!=r&&null!=o||(o=1),r=uu(e,t,"SegmentTimeline"),t=null,r){t=a,e=e.U.duration||1/0,r=ii(r,"S");for(var s=[],c=-i,d=0;d<r.length;++d){var l=r[d],u=r[d+1],f=li(l,"t",hi),p=li(l,"d",hi);if(l=li(l,"r",mi),null!=f&&(f-=i),!p)break;if(f=null!=f?f:c,0>(l=l||0))if(u){if(null==(u=li(u,"t",hi)))break;if(f>=u)break;l=Math.ceil((u-f)/p)-1}else{if(1/0==e)break;if(f/t>=e)break;l=Math.ceil((e*t-f)/p)-1}for(0<s.length&&f!=c&&(s[s.length-1].end=f/t),u=0;u<=l;++u)c=f+p,s.push({start:f/t,end:c/t,Cg:f}),f=c}t=s}return{timescale:a,ha:n,Lb:o,Sa:i/a||0,qe:i,timeline:t}}function lu(e,t,n){return[t(e.I),t(e.ea),t(e.aa)].filter(Ye).map(function(e){return e.getAttribute(n)}).reduce(function(e,t){return e||t})}function uu(e,t,n){return[t(e.I),t(e.ea),t(e.aa)].filter(Ye).map(function(e){return ni(e,n)}).reduce(function(e,t){return e||t})}function fu(e,t,n,a,i,r){if(r=void 0===r?0:r,oi(e,"http://www.w3.org/1999/xlink","href")){var o=function(e,t,n,a,i,r){for(var o=oi(e,"http://www.w3.org/1999/xlink","href"),s=oi(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",c=d(Array.from(e.attributes)),l=c.next();!l.done;l=c.next())"http://www.w3.org/1999/xlink"==(l=l.value).namespaceURI&&e.removeAttributeNS(l.namespaceURI,l.localName);if(5<=r)return la(new ke(2,4,4028));if("onLoad"!=s)return la(new ke(2,4,4027));var u=Je([a],[o]);return i.request(0,Ca(u,t)).X(function(a){if(!(a=yi(a.data,e.tagName)))return la(new ke(2,4,4001,o));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;a.childNodes.length;){var s=a.childNodes[0];a.removeChild(s),e.appendChild(s)}for(s=(a=d(Array.from(a.attributes))).next();!s.done;s=a.next())e.setAttributeNode(s.value.cloneNode(!1));return fu(e,t,n,u[0],i,r+1)})}(e,t,n,a,i,r);return n&&(o=o.X(void 0,function(){return fu(e,t,n,a,i,r)})),o}o=[];for(var s=d(Array.from(e.childNodes)),c=s.next();!c.done;c=s.next())(c=c.value)instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==oi(c,"http://www.w3.org/1999/xlink","href")?e.removeChild(c):"SegmentTimeline"!=c.tagName&&o.push(fu(c,t,n,a,i,r)));return ma(o).X(function(){return e})}function pu(e){this.h=Ae(e),this.g=new ja(this.h,0)}function mu(e){var t=_u(e);if(7<t.length)throw new ke(2,3,3002);for(var n=0,a=(t=d(t)).next();!a.done;a=t.next())n=256*n+a.value;t=_u(e);e:{for(var i=(a=d(hu)).next();!i.done;i=a.next())if(Ce(t,new Uint8Array(i.value))){a=!0;break e}a=!1}if(a)t=e.h.byteLength-e.g.$();else{if(8==t.length&&224&t[1])throw new ke(2,3,3001);for(i=a=0;i<t.length;i++){var r=t[i];a=0==i?r&(1<<8-t.length)-1:256*a+r}t=a}return t=e.g.$()+t<=e.h.byteLength?t:e.h.byteLength-e.g.$(),a=Ae(e.h,e.g.$(),t),e.g.skip(t),new bu(n,a)}function _u(e){var t=e.g.$(),n=e.g.Ra();if(0==n)throw new ke(2,3,3002);return n=8-Math.floor(Math.log2(n)),e.g.skip(n-1),Ee(e.h,t,n)}pu.prototype.ga=function(){return this.g.ga()};var hu=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function bu(e,t){this.id=e,this.g=t}function gu(e){if(8<e.g.byteLength)throw new ke(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new ke(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++)t=256*t+e.g.getUint8(n);return t}function vu(e){var t=new pu(e.g);if(179!=(e=mu(t)).id)throw new ke(2,3,3013);if(e=gu(e),183!=(t=mu(t)).id)throw new ke(2,3,3012);t=new pu(t.g);for(var n=0;t.ga();){var a=mu(t);if(241==a.id){n=gu(a);break}}return{Dg:e,mg:n}}function yu(e,t){if(!(t=uu(e,t,"Initialization")))return null;var n=e.I.xa,a=t.getAttribute("sourceURL");a&&(n=Je(e.I.xa,[a])),a=0;var i=null;return(t=li(t,"range",pi))&&(a=t.start,i=t.end),new fo(function(){return n},a,i,Cu(e))}function Su(e,t,n,a,i,r,o){var s,c,d,l,u,f,p,m,_,h,b,g,v,S,D;return M(function(I){if(1==I.g)return s=e.presentationTimeline,c=!e.Wa||!e.U.Ke,d=e.U.start,l=e.U.duration,u=e.I.mimeType.split("/")[1],p=null,m=[(f=t)(a,i,r),"webm"==u?f(n.za(),n.Ba,n.ka):null],f=null,y(I,Promise.all(m),2);if(_=I.h,h=_[0],b=_[1]||null,v=d-o,S=d,D=l?d+l:1/0,"mp4"==u)var x=function(e,t,n,a,i,r,o){var s,c=(new Ga).P("sidx",function(e){s=function(e,t,n,a,i,r,o){var s=[];o.reader.skip(4);var c=o.reader.K();if(0==c)throw new ke(2,3,3005);if(0==o.version)var d=o.reader.K(),l=o.reader.K();else d=o.reader.ab(),l=o.reader.ab();o.reader.skip(2);var u=o.reader.Zd();for(e=e+o.size+l,l=0;l<u;l++){var f=o.reader.K(),p=(2147483648&f)>>>31;f&=2147483647;var m=o.reader.K();if(o.reader.skip(4),1==p)throw new ke(2,3,3006);s.push(new po(d/c+n,(d+m)/c+n,function(){return r},e,e+f-1,t,n,a,i)),d+=m,e+=f}return o.parser.stop(),s}(t,a,i,r,o,n,e)});if(e&&c.parse(e),s)return s;throw new ke(2,3,3004)}(h,i,a,n,v,S,D);else{if(440786851!=mu(x=new pu(b)).id)throw new ke(2,3,3008);var C=mu(x);if(408125543!=C.id)throw new ke(2,3,3009);x=C.g.byteOffset,C=new pu(C.g);for(var O=null;C.ga();){var w=mu(C);if(357149030==w.id){O=w;break}}if(!O)throw new ke(2,3,3010);for(O=new pu(O.g),w=1e6,C=null;O.ga();){var E=mu(O);if(2807729==E.id)w=gu(E);else if(17545==E.id)if(4==E.g.byteLength)C=E.g.getFloat32(0);else{if(8!=E.g.byteLength)throw new ke(2,3,3003);C=E.g.getFloat64(0)}}if(null==C)throw new ke(2,3,3011);if(C*=O=w/1e9,475249515!=(w=mu(new pu(h))).id)throw new ke(2,3,3007);x=function(e,t,n,a,i,r,o,s,c){function d(){return i}var l=[];e=new pu(e.g);for(var u=null,f=null;e.ga();){var p=mu(e);if(187==p.id){var m=vu(p);m&&(p=n*m.Dg,m=t+m.mg,null!=u&&l.push(new po(u+o,p+o,d,f,m-1,r,o,s,c)),u=p,f=m)}}return null!=u&&l.push(new po(u+o,a+o,d,f,null,r,o,s,c)),l}(w,x,O,C,a,n,v,S,D)}return g=x,s.Ib(g),p=new vs(g),c&&p.Xa(S,D,!0),I.return(p)})}function Du(e){return e.wc}function Iu(e){var t=uu(e,Du,"RepresentationIndex");return e=pi((e=lu(e,Du,"indexRange"))||""),t&&(e=li(t,"range",pi,e)),e}function xu(e,t){var n=e.I.mimeType.split("/")[1];if(e.I.contentType!=et&&"mp4"!=n&&"webm"!=n)throw new ke(2,4,4006);if("webm"==n&&!t)throw new ke(2,4,4005)}function Cu(e){var t=e.I;return{bandwidth:e.bandwidth,audioSamplingRate:t.audioSamplingRate,codecs:t.codecs,contentType:t.contentType,frameRate:t.frameRate||null,height:t.height||null,mimeType:t.mimeType,channelsCount:t.bd,pixelAspectRatio:t.pixelAspectRatio||null,width:t.width||null}}function Ou(e){return e.bb}function wu(e){return e.xc}function Eu(){this.l=[],this.g=[],this.h=[],this.j=[],this.i=[],this.m=new Set}function Au(e){var t,n,a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,S,D,I,x,C,O;return M(function(w){switch(w.g){case 1:if(t=tt,1==e.length)return w.return(e[0]);for(n=e.map(function(e){return e.filter(function(e){return e.type==t.Hc})}),a=e.map(function(e){return e.filter(function(e){return e.type==t.wa})}),i=e.map(function(e){return e.filter(function(e){return e.type==t.Z})}),r=e.map(function(e){return e.filter(function(e){return e.type==t.Wb})}),o=d(i),s=o.next();!s.done;s=o.next())s.value.push(Wu(t.Z));for(c=d(r),l=c.next();!l.done;l=c.next())l.value.push(Wu(t.Wb));return y(w,Lu([],n,0,Uu,Hu),2);case 2:return u=w.h,y(w,Lu([],a,0,Uu,Hu),3);case 3:return f=w.h,y(w,Lu([],i,0,Uu,Hu),4);case 4:return p=w.h,y(w,Lu([],r,0,Uu,Hu),5);case 5:if(m=w.h,_=0,f.length&&u.length)for(v=d(u),S=v.next();!S.done;S=v.next())for(D=S.value,I=d(f),x=I.next();!x.done;x=I.next())C=x.value,O=_++,C.variantIds.push(O),D.variantIds.push(O);else for(h=f.concat(u),b=d(h),g=b.next();!g.done;g=b.next())g.value.variantIds=[_++];return w.return(f.concat(u).concat(p).concat(m))}})}function Lu(e,t,n,a,i){var r,o,s,c,l,u,f,p,m,_,h,b,g,v,S,D,I,x;return M(function(C){switch(C.g){case 1:for(r=tt,o=[],s=0;s<t.length;s++)s>=n?o.push(new Set(t[s])):o.push(new Set);c=d(e),l=c.next();case 2:if(l.done){C.A(4);break}return y(C,function(e,t,n,a,i){return M(function(r){return 1==r.g?(Ru(t,e),e.matchedStreams?e.segmentIndex?y(r,ku(e,n),2):r.A(2):r.return(!1)):(Pu(e,n,a,i),r.return(!0))})}(l.value,t,n,i,o),5);case 5:if(!C.h)throw new ke(2,4,4037);l=c.next(),C.A(2);break;case 4:for(u=d(o),f=u.next();!f.done;f=u.next())for(p=f.value,m=d(p),_=m.next();!_.done;_=m.next())h=_.value,(b=Mu(h,t,a,i,o))&&e.push(b);for(g=d(o),f=g.next();!f.done;f=g.next())for(v=f.value,S={},D=d(v),_=D.next();!_.done;S={Va:S.Va},_=D.next())if(S.Va=_.value,I=S.Va.type==r.Z&&!S.Va.language,x=S.Va.type==r.Wb&&!S.Va.tilesLayout,!I&&!x&&e.some(function(e){return function(t){return t.mimeType==e.Va.mimeType&&Gt(t.codecs)==Gt(e.Va.codecs)}}(S)))throw new ke(2,4,4037);return C.return(e)}})}function ku(e,t){var n,a,i,r,o,s,c;return M(function(l){if(1==l.g){for(n=[],a=e.matchedStreams,i=d(a),r=i.next();!r.done;r=i.next())o=r.value,n.push(o.createSegmentIndex()),o.trickModeVideo&&!o.trickModeVideo.segmentIndex&&n.push(o.trickModeVideo.createSegmentIndex());return y(l,Promise.all(n),2)}if(e.segmentIndex instanceof Is)for(s=0;s<a.length;s++)(c=a[s]).segmentIndex&&s>=t&&e.segmentIndex.l.push(c.segmentIndex);S(l)})}function Mu(e,t,n,a,i){var r=n(e);return Ru(t,r),r.createSegmentIndex&&(r.createSegmentIndex=function(){return M(function(e){return r.segmentIndex?e.A(0):(r.segmentIndex=new Is,y(e,ku(r,0),0))})}),r.matchedStreams?(Pu(r,0,a,i),r):null}function Pu(e,t,n,a){for(var i=e.matchedStreams,r=0;r<i.length;r++)if(r>=t){var o=i[r];n(e,o);var s=!0;"audio"==e.type&&0==rn(e.language,o.language)&&(s=!1),s&&a[r].delete(o)}}function Tu(e){var t=Object.assign({},e);return t.originalId=null,t.createSegmentIndex=function(){return Promise.resolve()},t.closeSegmentIndex=function(){if(t.segmentIndex&&(t.segmentIndex.release(),t.segmentIndex=null),t.matchedStreams)for(var e=d(t.matchedStreams),n=e.next();!n.done;n=e.next())(n=n.value).segmentIndex&&(n.segmentIndex.release(),n.segmentIndex=null)},t.segmentIndex=null,t.emsgSchemeIdUris=[],t.keyIds=new Set,t.closedCaptions=null,t.trickModeVideo=null,t}function Uu(e){return(e=Object.assign({},e)).keyIds=new Set,e.segments=[],e.variantIds=[],e.closedCaptions=null,e}function Fu(e,t){var n,a;e.roles=Array.from(new Set(e.roles.concat(t.roles))),t.emsgSchemeIdUris&&(e.emsgSchemeIdUris=Array.from(new Set(e.emsgSchemeIdUris.concat(t.emsgSchemeIdUris)))),e.keyIds=(n=e.keyIds,a=t.keyIds,new Set([].concat(l(n),l(a)))),null==e.originalId?e.originalId=t.originalId:e.originalId+=","+(t.originalId||"");var i=Fi(e.drmInfos,t.drmInfos);if(t.drmInfos.length&&e.drmInfos.length&&!i.length)throw new ke(2,4,4038);if(e.drmInfos=i,e.encrypted=e.encrypted||t.encrypted,t.closedCaptions){e.closedCaptions||(e.closedCaptions=new Map);for(var r=(i=d(t.closedCaptions)).next();!r.done;r=i.next()){var o=d(r.value);r=o.next().value,o=o.next().value,e.closedCaptions.set(r,o)}}t.trickModeVideo?(e.trickModeVideo||(e.trickModeVideo=Tu(t.trickModeVideo),e.trickModeVideo.createSegmentIndex=function(){return e.trickModeVideo.segmentIndex=e.segmentIndex.clone(),Promise.resolve()}),Fu(e.trickModeVideo,t.trickModeVideo)):e.trickModeVideo&&Fu(e.trickModeVideo,t)}function Hu(e,t){e.roles=Array.from(new Set(e.roles.concat(t.roles)));var n=t.keyIds;if(n=new Set([].concat(l(e.keyIds),l(n))),e.keyIds=n,e.encrypted=e.encrypted&&t.encrypted,e.segments.push.apply(e.segments,l(t.segments)),t.closedCaptions)for(e.closedCaptions||(e.closedCaptions=new Map),n=(t=d(t.closedCaptions)).next();!n.done;n=t.next()){var a=d(n.value);n=a.next().value,a=a.next().value,e.closedCaptions.set(n,a)}}function Ru(e,t){for(var n=[],a=(e=d(e)).next();!a.done;a=e.next()){for(var i=t,r={audio:Nu,video:Nu,text:Bu,image:ju}[i.type],o={audio:Vu,video:zu,text:Gu,image:Ku}[i.type],s=null,c=(a=d(a.value)).next();!c.done;c=a.next())!r(i,c=c.value)||s&&!o(i,s,c)||(s=c);if(!(i=s))return;n.push(i)}t.matchedStreams=n}function Nu(e,t){var n;return!(n=t.mimeType!=e.mimeType||Gt(t.codecs)!=Gt(e.codecs))&&(n=e.drmInfos)&&(e=e.drmInfos,t=t.drmInfos,n=!(!e.length||!t.length||0<Fi(e,t).length)),!n}function Bu(e,t){return!!e.language&&(!t.language||0!=rn(e.language,t.language)&&t.kind==e.kind)}function ju(e){return!!e.tilesLayout}function Vu(e,t,n){if(e.id==n.id)return!0;var a=rn(e.language,t.language),i=rn(e.language,n.language);return i>a||!(i<a)&&(e.roles.length?(a=t.roles.filter(function(t){return e.roles.includes(t)}),(i=n.roles.filter(function(t){return e.roles.includes(t)})).length>a.length||!(i.length<a.length)&&n.roles.length<t.roles.length):!((n.roles.length||!t.roles.length)&&(n.roles.length&&!t.roles.length||(t.primary||!n.primary)&&(t.primary&&!n.primary||(a=Qu(e.channelsCount,t.channelsCount,n.channelsCount))!=Ju&&(a==Zu||(a=Qu(e.audioSamplingRate,t.audioSamplingRate,n.audioSamplingRate))!=Ju&&(a==Zu||!e.bandwidth||Yu(e.bandwidth,t.bandwidth,n.bandwidth)!=Ju))))))}function zu(e,t,n){if(e.id==n.id)return!0;var a=Qu(e.width*e.height,t.width*t.height,n.width*n.height);if(a==Ju)return!0;if(a==Zu)return!1;if(e.frameRate){if((a=Qu(e.frameRate,t.frameRate,n.frameRate))==Ju)return!0;if(a==Zu)return!1}return!(!e.bandwidth||Yu(e.bandwidth,t.bandwidth,n.bandwidth)!=Ju)}function Gu(e,t,n){if(e.id==n.id)return!0;var a=rn(e.language,t.language),i=rn(e.language,n.language);if(i>a)return!0;if(i<a)return!1;if(!t.primary&&n.primary)return!0;if(t.primary&&!n.primary)return!1;if(e.roles.length){if(a=t.roles.filter(function(t){return e.roles.includes(t)}),(i=n.roles.filter(function(t){return e.roles.includes(t)})).length>a.length)return!0;if(i.length<a.length)return!1}else{if(!n.roles.length&&t.roles.length)return!0;if(n.roles.length&&!t.roles.length)return!1}return n.mimeType==e.mimeType&&n.codecs==e.codecs&&(t.mimeType!=e.mimeType||t.codecs!=e.codecs)}function Ku(e,t,n){return e.id==n.id||Qu(e.width*e.height,t.width*t.height,n.width*n.height)==Ju}function Wu(e){return{id:0,originalId:"",primary:!1,type:e,mimeType:"",codecs:"",language:"",label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function qu(e){return{id:0,originalId:"",createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new vs([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",label:null,type:e,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null}}function Qu(e,t,n){if(t==e&&e!=n)return Zu;if(n==e&&e!=t)return Ju;if(t>e){if(n<=e||n-e<t-e)return Ju;if(n-e>t-e)return Zu}else{if(n>e)return Zu;if(e-n<e-t)return Ju;if(e-n>e-t)return Zu}return Xu}function Yu(e,t,n){return t=Math.abs(e-t),(e=Math.abs(e-n))<t?Ju:t<e?Zu:Xu}Eu.prototype.release=function(){for(var e=d(this.g.concat(this.h,this.j,this.i)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();this.g=[],this.h=[],this.j=[],this.i=[],this.l=[]};var Ju=1,Xu=0,Zu=-1;function $u(){var e=this;this.h=this.g=null,this.m=[],this.i=null,this.G=1,this.l={},this.L={},this.j=new Eu,this.F=0,this.H=new j(5),this.D=new ot(function(){!function(e){var t,n;M(function(a){switch(a.g){case 1:return t=0,D(a,2),y(a,ef(e),4);case 4:t=a.h,x(a,3);break;case 2:n=C(a),e.h&&(n.severity=1,e.h.onError(n));case 3:if(!e.h)return a.return();rf(e,t),S(a)}})}(e)}),this.o=new Sa,this.s=null,this.J=[],this.u=1/0,this.B=!1}function ef(e){var t,n,a,i,r,o,s;return M(function(c){return 1==c.g?(t=Ca(e.m,e.g.retryParameters),n=e.h.networkingEngine,e.h.modifyManifestRequest(t,{format:"d"}),a=Date.now(),i=n.request(0,t),Da(e.o,i),y(c,i.promise,2)):3!=c.g?(r=c.h,e.h?(r.uri&&!e.m.includes(r.uri)&&e.m.unshift(r.uri),y(c,function(e,t,n){var a,i,r,o;return M(function(s){if(1==s.g){if(!(a=yi(t,"MPD")))throw new ke(2,4,4001,n);return e.g.dash.disableXlinkProcessing?s.return(tf(e,a,n)):(i=e.g.dash.xlinkFailGracefully,r=fu(a,e.g.retryParameters,i,n,e.h.networkingEngine),Da(e.o,r),y(s,r.promise,2))}return o=s.h,s.return(tf(e,o,n))})}(e,r.data,r.uri),3)):c.return(0)):(o=Date.now(),s=(o-a)/1e3,e.H.sample(1,s),c.return(s))})}function tf(e,t,n){var a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,I,O,w,E,A,L,k,P,T,U,F,H,R;return M(function(N){switch(N.g){case 1:if((a=e.g.dash.manifestPreprocessor)&&a(t),i=[n],0<(r=ii(t,"Location").map(ci).filter(Ye)).length&&(o=Je(i,r),i=e.m=o),s=ii(t,"BaseURL"),c=s.map(ci),l=Je(i,c),u=0,s&&s.length&&(u=li(s[0],"availabilityTimeOffset",bi)||0),f=e.g.dash.ignoreMinBufferTime,p=0,f||(p=li(t,"minBufferTime",fi)||0),e.F=li(t,"minimumUpdatePeriod",fi,-1),m=li(t,"availabilityStartTime",ui),_=li(t,"timeShiftBufferDepth",fi),h=e.g.dash.ignoreSuggestedPresentationDelay,b=null,h||(b=li(t,"suggestedPresentationDelay",fi)),g=e.g.dash.ignoreMaxSegmentDuration,v=null,g||(v=li(t,"maxSegmentDuration",fi)),I=t.getAttribute("type")||"static",e.i)for(O=e.i.presentationTimeline,w=d(Object.values(e.l)),E=w.next();!E.done;E=w.next())(A=E.value).segmentIndex&&A.segmentIndex.fb(O.Pa());else L=e.g.defaultPresentationDelay||1.5*p,O=new $o(m,null!=b?b:L,e.g.dash.autoCorrectDrift);return O.yc("static"==I),O.T()&&!isNaN(e.g.availabilityWindowOverride)&&(_=e.g.availabilityWindowOverride),null==_&&(_=1/0),O.le(_),k=t.getAttribute("profiles")||"",P={Wa:"static"!=I,presentationTimeline:O,aa:null,U:null,ea:null,I:null,bandwidth:0,Ie:!1,Ab:u,profiles:k.split(",")},T=function(e,t,n,a){var i=li(a,"mediaPresentationDuration",fi),r=[],o=0;a=ii(a,"Period");for(var s=0;s<a.length;s++){var c=a[s],d=a[s+1],l=li(c,"start",fi,o),u=c.id,f=li(c,"duration",fi),p=null;if(d){var m=li(d,"start",fi);null!=m&&(p=m-l)}else null!=i&&(p=i-l);if(null==p&&(p=f),!(null!==e.s&&null!==u&&null!==l&&l<e.s)||e.J.includes(u)||s+1==a.length){if(null!==l&&(null===e.s||l>e.s)&&(e.s=l),o=nf(e,t,n,{start:l,duration:p,node:c,Ke:null==p||!d}),r.push(o),t.aa.id&&p&&(e.L[t.aa.id]=p),null==p){o=null;break}o=l+p}}return e.J=r.map(function(e){return e.id}),null!=i?{periods:r,duration:i,Be:!1}:{periods:r,duration:o,Be:!0}}(e,P,l,t),U=T.duration,F=T.periods,"static"!=I&&T.Be||O.Ia(U||1/0),e.u&&!e.B&&e.h.isAutoLowLatencyMode()&&(e.h.enableLowLatencyMode(),e.B=e.h.isLowLatencyMode()),e.B?O.Te(e.u):e.u&&W("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),O.Rd(v||1),y(N,function(e,t,n){var a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,D,I,x,C,O,w,E,A,L,k,P,T;return M(function(M){switch(M.g){case 1:if(a=tt,function(e){for(var t=(e=d(e)).next();!t.done;t=e.next()){for(var n=[],a=d((t=t.value).Kc),i=a.next();!i.done;i=a.next()){i=i.value;for(var r=!1,o=d(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.channelsCount==s.channelsCount&&i.language==s.language&&i.bandwidth==s.bandwidth&&i.label==s.label&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&ne(i.roles,s.roles)&&i.audioSamplingRate==s.audioSamplingRate&&i.primary==s.primary&&(r=!0);r||n.push(i)}t.Kc=n}}(t),function(e){for(var t=(e=d(e)).next();!t.done;t=e.next()){for(var n=[],a=d((t=t.value).hd),i=a.next();!i.done;i=a.next()){i=i.value;for(var r=!1,o=d(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.width==s.width&&i.frameRate==s.frameRate&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&i.label==s.label&&ne(i.roles,s.roles)&&Ba(i.closedCaptions,s.closedCaptions)&&i.bandwidth==s.bandwidth&&(r=!0);r||n.push(i)}t.hd=n}}(t),function(e){for(var t=(e=d(e)).next();!t.done;t=e.next()){for(var n=[],a=d((t=t.value).textStreams),i=a.next();!i.done;i=a.next()){i=i.value;for(var r=!1,o=d(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.language==s.language&&i.label==s.label&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&i.bandwidth==s.bandwidth&&ne(i.roles,s.roles)&&(r=!0);r||n.push(i)}t.textStreams=n}}(t),function(e){for(var t=(e=d(e)).next();!t.done;t=e.next()){for(var n=[],a=d((t=t.value).imageStreams),i=a.next();!i.done;i=a.next()){i=i.value;for(var r=!1,o=d(n),s=o.next();!s.done;s=o.next())s=s.value,i.id!=s.id&&i.width==s.width&&i.codecs==s.codecs&&i.mimeType==s.mimeType&&(r=!0);r||n.push(i)}t.imageStreams=n}}(t),!n&&1==t.length){i=t[0],e.g=i.Kc,e.h=i.hd,e.j=i.textStreams,e.i=i.imageStreams,M.A(2);break}for(r=-1,o=0;o<t.length;o++)s=t[o],e.m.has(s.id)||(e.m.add(s.id),-1==r&&(r=o));if(-1==r)return M.return();for(c=t.map(function(e){return e.Kc}),l=t.map(function(e){return e.hd}),u=t.map(function(e){return e.textStreams}),f=t.map(function(e){return e.imageStreams}),p=d(u),m=p.next();!m.done;m=p.next())m.value.push(qu(a.Z));for(_=d(f),h=_.next();!h.done;h=_.next())h.value.push(qu(a.Wb));return y(M,Lu(e.g,c,r,Tu,Fu),3);case 3:return y(M,Lu(e.h,l,r,Tu,Fu),4);case 4:return y(M,Lu(e.j,u,r,Tu,Fu),5);case 5:return y(M,Lu(e.i,f,r,Tu,Fu),2);case 2:if(b=0,g=[],e.h.length&&e.g.length)for(O=d(e.g),w=O.next();!w.done;w=O.next())for(E=w.value,A=d(e.h),L=A.next();!L.done;L=A.next())k=L.value,P=Fi(E.drmInfos,k.drmInfos),E.drmInfos.length&&k.drmInfos.length&&!P.length||(T=b++,g.push({id:T,language:E.language,primary:E.primary,audio:E,video:k,bandwidth:(E.bandwidth||0)+(k.bandwidth||0),drmInfos:P,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(v=e.h.concat(e.g),D=d(v),I=D.next();!I.done;I=D.next())x=I.value,C=b++,g.push({id:C,language:x.language,primary:x.primary,audio:x.type==a.Hc?x:null,video:x.type==a.wa?x:null,bandwidth:x.bandwidth||0,drmInfos:x.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});e.l=g,S(M)}})}(e.j,F,P.Wa),2);case 2:if(e.i){e.i.variants=e.j.l,e.i.textStreams=e.j.j.slice(),e.i.imageStreams=e.j.i,e.h.filter(e.i),N.A(3);break}if(e.i={presentationTimeline:O,variants:e.j.l,textStreams:e.j.j.slice(),imageStreams:e.j.i,offlineSessionIds:[],minBufferTime:p||0,sequenceMode:e.g.dash.sequenceMode},!O.cf()){N.A(4);break}return H=ii(t,"UTCTiming"),y(N,function(e,t,n){var a,i,r,o,s,c,l,u;return M(function(f){switch(f.g){case 1:a=n.map(function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}),i=e.g.dash.clockSyncUri,!a.length&&i&&a.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),r=d(a),o=r.next();case 2:if(o.done){f.A(4);break}switch(s=o.value,D(f,5),c=s.scheme,l=s.value,c){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return f.A(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return f.A(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return u=Date.parse(l),f.return(isNaN(u)?0:u-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":W("NTP UTCTiming scheme is not supported");break;default:W("Unrecognized scheme in UTCTiming element",c)}f.A(9);break;case 7:return y(f,sf(e,t,l,"HEAD"),10);case 10:return f.return(f.h);case 8:return y(f,sf(e,t,l,"GET"),11);case 11:return f.return(f.h);case 9:x(f,3);break;case 5:C(f);case 3:o=r.next(),f.A(2);break;case 4:return W("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),f.return(0)}})}(e,l,H),5);case 5:if(R=N.h,!e.h)return N.return();O.Ue(R);case 4:O.Md();case 3:e.h.makeTextStreamsForClosedCaptions(e.i),S(N)}})}function nf(e,t,n,a){t.aa=of(a.node,null,n),t.U=a,t.aa.Ab=t.Ab,t.aa.id||(t.aa.id="__shaka_period_"+a.start);var i=ii(a.node,"EventStream");n=t.presentationTimeline.Pa();for(var r=(i=d(i)).next();!r.done;r=i.next())cf(e,a.start,a.duration,r.value,n);if(n=ii(a.node,"AdaptationSet").map(function(n){return function(e,t,n){function a(e){switch(e){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}t.ea=of(n,t.aa,null);var i,r=!1,o=ii(n,"Role"),s=o.map(function(e){return e.getAttribute("value")}).filter(Ye),c=void 0,u=t.ea.contentType==et;u&&(c="subtitle");for(var f=(o=d(o)).next();!f.done;f=o.next()){var p=(f=f.value).getAttribute("schemeIdUri");if(null==p||"urn:mpeg:dash:role:2011"==p)switch(f=f.getAttribute("value"),f){case"main":r=!0;break;case"caption":case"subtitle":c=f}}o=null,f=!1;for(var m=(p=d(p=ii(n,"EssentialProperty"))).next();!m.done;m=p.next()){var _=(m=m.value).getAttribute("schemeIdUri");"http://dashif.org/guidelines/trickmode"==_?o=m.getAttribute("value"):"urn:mpeg:mpegB:cicp:TransferCharacteristics"==_?i=a(parseInt(m.getAttribute("value"),10)):f=!0}for(m=(p=d(p=ii(n,"SupplementalProperty"))).next();!m.done;m=p.next())"urn:mpeg:mpegB:cicp:TransferCharacteristics"==(m=m.value).getAttribute("schemeIdUri")&&(i=a(parseInt(m.getAttribute("value"),10)));p=ii(n,"Accessibility");var h=new Map;for(m=(p=d(p)).next();!m.done;m=p.next())if(m=(_=m.value).getAttribute("schemeIdUri"),_=_.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==m)if(m=1,null!=_)for(var b=d(_=_.split(";")),g=b.next();!g.done;g=b.next()){var v=g.value,D=g=void 0;v.includes("=")?(g=(v=v.split("="))[0].startsWith("CC")?v[0]:"CC"+v[0],D=v[1]||"und"):(g="CC"+m,2==_.length?m+=2:m++,D=v),h.set(g,an(D))}else h.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==m)if(m=1,null!=_)for(g=(_=d(_.split(";"))).next();!g.done;g=_.next())v=b=void 0,(g=g.value).includes("=")?(b="svc"+(g=g.split("="))[0],v=g[1].split(",")[0].split(":").pop()):(b="svc"+m,m++,v=g),h.set(b,an(v));else h.set("svc1","und");else"urn:mpeg:dash:role:2011"==m&&null!=_&&(s.push(_),"captions"==_&&(c="caption"));if(f)return null;var I=au(f=ii(n,"ContentProtection"),e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),x=an(n.getAttribute("lang")||"und"),C=n.getAttribute("label");if((f=ii(n,"Label"))&&f.length&&(f=f[0]).textContent&&(C=f.textContent),n=(f=ii(n,"Representation")).map(function(n){return(n=function(e,t,n,a,i,r,o,s,c,l){if(t.I=of(l,t.ea,null),e.u=Math.min(e.u,t.I.Ab),!function(e){var t=e.wc?1:0;return t+=e.bb?1:0,0==(t+=e.xc?1:0)?e.contentType==et||"application"==e.contentType:(1!=t&&(e.wc&&(e.bb=null),e.xc=null),!0)}(t.I))return null;var u=t.U.start;t.bandwidth=li(l,"bandwidth",_i)||0;var f=t.I.contentType,p=f==et||"application"==f;f="image"==f;try{var m=function(t,n,a){return function(e,t,n,a){var i,r,o,s,c;return M(function(d){return 1==d.g?(i=Aa,r=Hs(t,n,a,e.g.retryParameters),o=e.h.networkingEngine,s=o.request(i,r),Da(e.o,s),y(d,s.promise,2)):(c=d.h,d.return(c.data))})}(e,t,n,a)};if(t.I.wc)var _=function(e,t){var n=Number(lu(e,Du,"presentationTimeOffset"))||0,a=lu(e,Du,"timescale"),i=1;a&&(i=_i(a)||1);var r=n/i||0,o=yu(e,Du);!function(e,t){if(xu(e,t),!Iu(e))throw new ke(2,4,4002)}(e,o);var s=ya(e);return{Cb:function(){var e=uu(s,Du,"RepresentationIndex"),n=s.I.xa;return e&&(e=e.getAttribute("sourceURL"))&&(n=Je(s.I.xa,[e])),e=Iu(s),Su(s,t,o,n,e.start,e.end,r)}}}(t,m);else if(t.I.bb)_=function(e,t){var n=yu(e,Ou),a=function(e){var t=function(e){return[e.I.bb,e.ea.bb,e.aa.bb].filter(Ye).map(function(e){return ii(e,"SegmentURL")}).reduce(function(e,t){return 0<e.length?e:t}).map(function(t){return t.getAttribute("indexRange")&&!e.Ie&&(e.Ie=!0),{cg:t.getAttribute("media"),start:(t=li(t,"mediaRange",pi,{start:0,end:null})).start,end:t.end}})}(e),n=(e=du(e,Ou)).Lb;0==n&&(n=1);var a=0;return e.ha?a=e.ha*(n-1):e.timeline&&0<e.timeline.length&&(a=e.timeline[0].start),{ha:e.ha,startTime:a,Lb:n,Sa:e.Sa,timeline:e.timeline,Gb:t}}(e);if(!a.ha&&!a.timeline&&1<a.Gb.length)throw new ke(2,4,4002);if(!a.ha&&!e.U.duration&&!a.timeline&&1==a.Gb.length)throw new ke(2,4,4002);if(a.timeline&&0==a.timeline.length)throw new ke(2,4,4002);var i=null,r=null;e.aa.id&&e.I.id&&(r=t[e.aa.id+","+e.I.id])&&(i=r.segmentIndex);var o=function(e,t,n,a,i){var r=a.Gb.length;a.timeline&&a.timeline.length!=a.Gb.length&&(r=Math.min(a.timeline.length,a.Gb.length));for(var o=e-a.Sa,s=t?e+t:1/0,c=[],d=a.startTime,l={},u=0;u<r;l={pd:l.pd},u++){var f,p=a.Gb[u];l.pd=Je(n,[p.cg]),f=null!=a.ha?d+a.ha:a.timeline?a.timeline[u].end:d+t,c.push(new po(e+d,e+f,function(e){return function(){return e.pd}}(l),p.start,p.end,i,o,e,s)),d=f}return c}(e.U.start,e.U.duration,e.I.xa,a,n);return t=!i,i?i.Hb(o,e.presentationTimeline.Pa()):i=new vs(o),e.presentationTimeline.Ib(o),e.Wa&&e.U.Ke||i.Xa(e.U.start,e.U.duration?e.U.start+e.U.duration:1/0,t),r&&(r.segmentIndex=i),{Cb:function(){return i&&0!=i.g.length||i.pc(o),Promise.resolve(i)}}}(t,e.l);else if(t.I.xc)_=function(e,t,n,a,i,r){var o=function(e){var t=lu(e,wu,"initialization");if(!t)return null;var n=e.I.id,a=e.bandwidth||null,i=e.I.xa;return new fo(function(){var e=cu(t,n,null,a,null);return Je(i,[e])},0,null,Cu(e))}(e),s=function(e){var t=du(e,wu),n=lu(e,wu,"media");return e=lu(e,wu,"index"),{ha:t.ha,timescale:t.timescale,Lb:t.Lb,Sa:t.Sa,qe:t.qe,timeline:t.timeline,Pd:n,oc:e}}(e);!function(e){var t=e.oc?1:0;if(t+=e.timeline?1:0,0==(t+=e.ha?1:0))throw new ke(2,4,4002);if(1!=t&&(e.oc&&(e.timeline=null),e.ha=null),!e.oc&&!e.Pd)throw new ke(2,4,4002)}(s);var c=ya(e);if(s.oc)return xu(e,o),{Cb:function(){var e=cu(s.oc,c.I.id,null,c.bandwidth||null,null);return e=Je(c.I.xa,[e]),Su(c,t,o,e,0,null,s.Sa)}};if(s.ha)return a||"image"===e.ea.contentType||(e.presentationTimeline.Rd(s.ha),e.presentationTimeline.Sd(e.U.start)),{Cb:function(){return function(e,t,n,a,i){function r(e){var n=(e-m)*p,i=n+t.Sa,r=n+l;return n=r+p,(r=new po(r,Math.min(n,s()),function(){var t=cu(h,g,e,b,i*_);return Je(v,[t])},0,null,a,y,l,s())).j=n,r}function o(){var e=[Math.max(c.Pa(),l),Math.min(c.ib(),s())].map(function(e){return e-l});return[Math.ceil(e[0]/p),Math.ceil(e[1]/p)-1].map(function(e){return e+m})}function s(){var e=null!=u&&i[u]||f;return e?l+e:1/0}var c=e.presentationTimeline,l=e.U.start,u=e.aa.id,f=e.U.duration,p=t.ha,m=t.Lb,_=t.timescale,h=t.Pd,b=e.bandwidth||null,g=e.I.id,v=e.I.xa,y=l-t.Sa,S=o();e=e.Wa?Math.max(S[0],S[1]-n+1):S[0],S=S[1],n=[];for(var D=e;D<=S;++D){var I=r(D);n.push(I)}var x=new vs(n);if(n=c.ib()<s(),D=c.T(),n||D){var C=Math.max(e,S+1);x.gd(p,function(){var e=c.Pa();x.fb(e);var t=d(o());t.next(),t=t.next().value;for(var n=[];C<=t;){var a=r(C);n.push(a),C++}return e>s()&&!n.length?null:n})}return Promise.resolve(x)}(c,s,i,o,r)}};var l=null;a=a=null,e.aa.id&&e.I.id&&(a=n[a=e.aa.id+","+e.I.id])&&(l=a.segmentIndex);var u=function(e,t,n){var a=e.U.start,i=e.U.duration,r=a-t.Sa;i=i?a+i:1/0;for(var o=[],s={},c=0;c<t.timeline.length;s={od:s.od,sd:s.sd,vd:s.vd,ld:s.ld,xd:s.xd,md:s.md},c++){var d=t.timeline[c],l=d.start,u=d.Cg;d=d.end,s.vd=c+t.Lb,s.xd=u+t.qe,s.sd=e.I.id,s.ld=e.bandwidth||null,s.od=t.Pd,s.md=e.I.xa,o.push(new po(a+l,a+d,function(e){return function(){var t=cu(e.od,e.sd,e.vd,e.ld||null,e.xd);return Je(e.md,[t]).map(function(e){return e.toString()})}}(s),0,null,n,r,a,i))}return o}(c,s,o);n=e.U.start;var f=e.U.duration?e.U.start+e.U.duration:1/0,p=1/0!=f;return l?(p&&new vs(u).Xa(n,f,!0),l.Hb(u,e.presentationTimeline.Pa())):l=new vs(u),e.presentationTimeline.Ib(u),p&&l.Xa(n,f),a&&e.Wa&&(a.segmentIndex=l),{Cb:function(){return l&&0!=l.g.length||l.pc(u),Promise.resolve(l)}}}(t,m,e.l,!!e.i,e.g.dash.initialSegmentLimit,e.L);else{var h=t.I.xa,b=t.U.duration||0;_={Cb:function(){return Promise.resolve(Ss(u,b,h))}}}}catch(e){if((p||f)&&4002==e.code)return null;throw e}m=function(e,t,n,a){var i=au(e,n,a);if(t.De)e=1==t.drmInfos.length&&!t.drmInfos[0].keySystem,n=0==i.drmInfos.length,(0==t.drmInfos.length||e&&!n)&&(t.drmInfos=i.drmInfos),t.De=!1;else if(0<i.drmInfos.length&&(t.drmInfos=t.drmInfos.filter(function(e){return i.drmInfos.some(function(t){return t.keySystem==e.keySystem})}),0==t.drmInfos.length))throw new ke(2,4,4008);return i.ze||t.ze}(m=ii(l,"ContentProtection"),n,e.g.dash.ignoreDrmInfo,e.g.dash.keySystemsByURI),m=new Set(m?[m]:[]);var g=!1;ii(l,"SupplementalProperty").some(function(e){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==e.getAttribute("schemeIdUri")&&"JOC"==e.getAttribute("value")})&&(g=!0);var v,D,I=!1;if(p&&(I=s.includes("forced_subtitle")||s.includes("forced-subtitle")),f&&((l=ii(l,"EssentialProperty").find(function(e){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(e.getAttribute("schemeIdUri"))}))&&(v=l.getAttribute("value")),!v))return null;l=t.I.codecs,t.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(l.includes("hvc1.2.4.L153.B0")||l.includes("hev1.2.4.L153.B0"))&&(D="PQ");var x=t.I.id?t.aa.id+","+t.I.id:"",C={id:e.G++,originalId:t.I.id,createSegmentIndex:function(){var n,a;return M(function(i){if(1==i.g)return(n=x&&t.Wa&&e.l[x]?e.l[x]:C).segmentIndex?i.A(0):(a=n,y(i,_.Cb(),3));a.segmentIndex=i.h,S(i)})},closeSegmentIndex:function(){C.segmentIndex&&(C.segmentIndex.release(),C.segmentIndex=null)},segmentIndex:null,mimeType:t.I.mimeType,codecs:t.I.codecs,frameRate:t.I.frameRate,pixelAspectRatio:t.I.pixelAspectRatio,bandwidth:t.bandwidth,width:t.I.width,height:t.I.height,kind:a,encrypted:0<n.drmInfos.length,drmInfos:n.drmInfos,keyIds:m,language:i,label:r,type:t.ea.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:t.I.emsgSchemeIdUris,roles:s,forced:I,channelsCount:t.I.bd,audioSamplingRate:t.I.audioSamplingRate,spatialAudio:g,closedCaptions:c,hdr:D,tilesLayout:v,matchedStreams:[]};return x&&t.Wa&&!e.l[x]&&(e.l[x]=C),C}(e,t,I,c,x,C,r,s,h,n))&&(n.hdr=n.hdr||i),n}).filter(function(e){return!!e}),0==n.length){if(o="image"==t.ea.contentType,e.g.dash.ignoreEmptyAdaptationSet||u||o)return null;throw new ke(2,4,4003)}if(!t.ea.contentType||"application"==t.ea.contentType)for(t.ea.contentType=df(n[0].mimeType,n[0].codecs),p=(u=d(n)).next();!p.done;p=u.next())p.value.type=t.ea.contentType;for(p=(u=d(n)).next();!p.done;p=u.next())for(p=p.value,_=(m=d(I.drmInfos)).next();!_.done;_=m.next())(_=_.value).keyIds=_.keyIds&&p.keyIds?new Set([].concat(l(_.keyIds),l(p.keyIds))):_.keyIds||p.keyIds;return u=f.map(function(e){return e.getAttribute("id")}).filter(Ye),{id:t.ea.id||"__fake__"+e.G++,contentType:t.ea.contentType,language:x,uh:r,streams:n,drmInfos:I.drmInfos,oe:o,pg:u}}(e,t,n)}).filter(Ye),t.Wa){for(a=[],r=(i=d(n)).next();!r.done;r=i.next())for(var o=(r=d(r.value.pg)).next();!o.done;o=r.next())a.push(o.value);if(a.length!=new Set(a).size)throw new ke(2,4,4018)}for(a=n.filter(function(e){return!e.oe}),i=(n=d(n=n.filter(function(e){return e.oe}))).next();!i.done;i=n.next()){r=(i=i.value).oe.split(" ");for(var s=(o=d(a)).next();!s.done;s=o.next()){var c=s.value;if(r.includes(c.id)){s={};for(var u=(c=d(c.streams)).next();!u.done;s={Gc:s.Gc},u=c.next())s.Gc=u.value,s.Gc.trickModeVideo=i.streams.find(function(e){return function(t){return Gt(e.Gc.codecs)==Gt(t.codecs)}}(s))}}}if(i=e.g.disableAudio?[]:af(a,"audio"),o=e.g.disableVideo?[]:af(a,"video"),r=e.g.disableText?[]:af(a,et),n=e.g.disableThumbnails?[]:af(a,"image"),!o.length&&!i.length)throw new ke(2,4,4004);for(a=[],s=(i=d(i)).next();!s.done;s=i.next())a.push.apply(a,l(s.value.streams));for(i=[],s=(o=d(o)).next();!s.done;s=o.next())i.push.apply(i,l(s.value.streams));for(o=[],s=(r=d(r)).next();!s.done;s=r.next())o.push.apply(o,l(s.value.streams));for(r=[],s=(n=d(n)).next();!s.done;s=n.next())r.push.apply(r,l(s.value.streams));return{id:t.aa.id,Kc:a,hd:i,textStreams:o,imageStreams:r}}function af(e,t){return e.filter(function(e){return e.contentType==t})}function rf(e,t){0>e.F||e.D.N(Math.max(3,e.F-t,V(e.H)))}function of(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,bd:null,audioSamplingRate:null,Ab:0},n=n||t.xa;for(var a=ii(e,"BaseURL"),i=a.map(ci),r=e.getAttribute("contentType")||t.contentType,o=e.getAttribute("mimeType")||t.mimeType,s=e.getAttribute("codecs")||t.codecs,c=li(e,"frameRate",gi)||t.frameRate,l=e.getAttribute("sar")||t.pixelAspectRatio,u=ii(e,"InbandEventStream"),f=t.emsgSchemeIdUris.slice(),p=(u=d(u)).next();!p.done;p=u.next())p=p.value.getAttribute("schemeIdUri"),f.includes(p)||f.push(p);u=function(e){for(var t=(e=d(e)).next();!t.done;t=e.next()){var n=t.value;if((t=n.getAttribute("schemeIdUri"))&&(n=n.getAttribute("value")))switch(t){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(t=parseInt(n,10)))continue;return t;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(t=parseInt(n,16)))continue;for(e=0;t;)1&t&&++e,t>>=1;return e;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(t=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(n=parseInt(n,10))&&0<n&&n<t.length)return t[n]}}return null}(u=ii(e,"AudioChannelConfiguration"))||t.bd,p=li(e,"audioSamplingRate",hi)||t.audioSamplingRate,r||(r=df(o,s));var m=ni(e,"SegmentBase"),_=ni(e,"SegmentTemplate"),h=m&&li(m,"availabilityTimeOffset",bi)||0,b=_&&li(_,"availabilityTimeOffset",bi)||0;return a=a&&a.length&&li(a[0],"availabilityTimeOffset",bi)||0,a=t.Ab+a+h+b,{xa:Je(n,i),wc:m||t.wc,bb:ni(e,"SegmentList")||t.bb,xc:_||t.xc,width:li(e,"width",hi)||t.width,height:li(e,"height",hi)||t.height,contentType:r,mimeType:o,codecs:s,frameRate:c,pixelAspectRatio:l,emsgSchemeIdUris:f,id:e.getAttribute("id"),bd:u,audioSamplingRate:p,Ab:a}}function sf(e,t,n,a){var i,r,o,s,c,d;return M(function(l){if(1==l.g)return i=Je(t,[n]),(r=Ca(i,e.g.retryParameters)).method=a,o=e.h.networkingEngine.request(4,r),Da(e.o,o),y(l,o.promise,2);if(s=l.h,"HEAD"==a){if(!s.headers||!s.headers.date)return l.return(0);c=s.headers.date}else c=yt(s.data);return d=Date.parse(c),isNaN(d)?l.return(0):l.return(d-Date.now())})}function cf(e,t,n,a,i){for(var r=a.getAttribute("schemeIdUri")||"",o=a.getAttribute("value")||"",s=li(a,"timescale",hi)||1,c=(a=d(ii(a,"Event"))).next();!c.done;c=a.next()){var l=li(c=c.value,"presentationTime",hi)||0,u=li(c,"duration",hi)||0;u=(l=l/s+t)+u/s,null!=n&&(l=Math.min(l,t+n),u=Math.min(u,t+n)),u<i||(c={schemeIdUri:r,value:o,startTime:l,endTime:u,id:c.getAttribute("id")||"",eventElement:c},e.h.onTimelineRegionAdded(c))}}function df(e,t){return Qt(Vt(e,t))?et:e.split("/")[0]}function lf(e,t,n,a){this.h=e,this.type=t,this.g=n,this.segments=a||null}function uf(e,t,n,a){this.id=e,this.name=t,this.g=n,this.value=void 0===a?null:a}function ff(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function pf(e,t){if(!(e=e.getAttribute(t)))throw new ke(2,4,4023,t);return e.value}function mf(e,t,n){n=void 0===n?[]:n,this.g=t,this.i=e,this.h=n}function _f(e,t){this.name=e,this.value=t}function hf(e,t){return e.filter(function(e){return e.name==t})}function bf(e,t){return e.filter(function(e){return pf(e,"TYPE")==t})}function gf(e,t){return(e=hf(e,t)).length?e[0]:null}function vf(e,t){var n=0;return n=void 0===n?0:n,(e=gf(e,t))?Number(e.value):n}function yf(e,t){return Je([e],[t])[0]}function Sf(e){this.h=e,this.g=0}function Df(e){If(e,/[ \t]+/gm)}function If(e,t){return t.lastIndex=e.g,t=null==(t=t.exec(e.h))?null:{position:t.index,length:t[0].length,results:t},e.g==e.h.length||null==t||t.position!=e.g?null:(e.g+=t.length,t.results)}function xf(e){return e.g==e.h.length?null:(e=If(e,/[^ \t\n]*/gm))?e[0]:null}function Cf(){this.g=0}function Of(e,t,n){var a=(t=(t=yt(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(a[0]))throw new ke(2,4,4015);t=0;for(var i=!0,r=d(a),o=r.next();!o.done;o=r.next())if(o=o.value,/^#(?!EXT)/m.test(o)||i)i=!1;else{if(o=wf(e,o),--e.g,Ef.includes(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(i=!0)}for(r=[],i=!0,o=0;o<a.length;o++){var s=a[o],c=a[o+1];if(/^#(?!EXT)/m.test(s)||i)i=!1;else{if(s=wf(e,s),Af.includes(s.name)){if(1!=t)throw new ke(2,4,4017);var l=a.splice(o,a.length-o);a=n,i=[],o=[],c=[],s=null;for(var u=(l=d(l)).next();!u.done;u=l.next())u=u.value,/^(#EXT)/.test(u)?(u=wf(e,u),Ef.includes(u.name)?r.push(u):"EXT-X-MAP"==u.name?s=u:"EXT-X-PART"==u.name?c.push(u):"EXT-X-PRELOAD-HINT"==u.name?"PART"==ff(u,"TYPE")?c.push(u):"MAP"==ff(u,"TYPE")&&(u.name="EXT-X-MAP",s=u):o.push(u)):/^#(?!EXT)/m.test(u)||(u=yf(a,u.trim()),s&&o.push(s),i.push(new mf(u,o,c)),o=[],c=[]);return c.length&&(s&&o.push(s),i.push(new mf("",o,c))),new lf(n,t,r,i)}r.push(s),"EXT-X-STREAM-INF"==s.name&&(s.g.push(new _f("URI",c)),i=!0)}}return new lf(n,t,r)}function wf(e,t){e=e.g++;var n=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!n)throw new ke(2,4,4016,t);t=n[1];var a,i=n[2];if(n=[],i){var r;(r=If(i=new Sf(i),/^([^,=]+)(?:,|$)/g))&&(a=r[1]);for(var o=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;r=If(i,o);)n.push(new _f(r[1],r[2]||r[3])),Df(i)}return new uf(e,t,n,a)}(a=$u.prototype).configure=function(e){this.g=e},a.start=function(e,t){var n,a=this;return M(function(i){if(1==i.g)return a.B=t.isLowLatencyMode(),a.m=[e],a.h=t,y(i,ef(a),2);if(n=i.h,a.h&&rf(a,n),!a.h)throw new ke(2,7,7001);return i.return(a.i)})},a.stop=function(){for(var e=d(Object.values(this.l)),t=e.next();!t.done;t=e.next())(t=t.value).segmentIndex&&t.segmentIndex.release();return this.j&&this.j.release(),this.g=this.h=null,this.m=[],this.i=null,this.l={},this.j=null,null!=this.D&&(this.D.stop(),this.D=null),this.o.destroy()},a.update=function(){var e,t=this;return M(function(n){return 1==n.g?(D(n,2),y(n,ef(t),4)):2!=n.g?x(n,0):(e=C(n),t.h&&e?(t.h.onError(e),void S(n)):n.return())})},a.onExpirationUpdated=function(){},B("shaka.dash.DashParser",$u),Ji.mpd=function(){return new $u},Yi["application/dash+xml"]=function(){return new $u},Yi["video/vnd.mpeg.dash.mpd"]=function(){return new $u},uf.prototype.toString=function(){var e="#"+this.name,t=this.g?this.g.map(function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)}):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},uf.prototype.getAttribute=function(e){var t=this.g.filter(function(t){return t.name==e});return t.length?t[0]:null};var Ef="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP".split(" "),Af="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function Lf(){}function kf(e){try{var t=Mf(e);return fa({uri:e,Ne:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return la(e)}}function Mf(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw new ke(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw new ke(2,1,1004,t);var a=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=a.split(";"),a=n[0];var i=!1;return 1<n.length&&"base64"==n[n.length-1]&&(i=!0,n.pop()),{data:i?At(t):It(t),contentType:a}}function Pf(){var e=this;this.g=this.i=null,this.Fa=1,this.o=new Map,this.u=new Map,this.F=new Map,this.F.set("video",new Map),this.F.set("audio",new Map),this.F.set(et,new Map),this.F.set("image",new Map),this.va=new Set,this.h=new Map,this.j=null,this.M="",this.W=new Cf,this.O=0,this.B=-1,this.L=1/0,this.La=!1,this.m=new ot(function(){!function(e){var t,n;M(function(a){return 1==a.g?e.i?(D(a,2),y(a,e.update(),4)):a.return():2!=a.g?(rp(e)&&(t=e.O,e.m.N(t)),x(a,0)):(n=C(a),e.i?(n.severity=1,e.i.onError(n),e.m.N(.1),void S(a)):a.return())})}(e)}),this.ia=pp,this.D=null,this.ca=0,this.H=1/0,this.V=this.da=0,this.G=new Sa,this.J=new Map,this.s=new Map,this.ba=new Map,this.l=!1}function Tf(e,t){return rp(e)?e.F.get(t.type):t.ad}function Uf(e,t){var n,a,i,r,o,s,c,d,u,f,p,m,_,h,b;return M(function(g){if(1==g.g)return n=t.Jc,a=new Pe(n),e.l&&t.Mc&&Fe(a,new Ke("_HLS_skip=YES")),y(g,ip(e,a.toString()),2);if(i=g.h,!t.stream.segmentIndex)return g.return();if(1!=(r=Of(e.W,i.data,i.uri)).type)throw new ke(2,4,4017);var v,D;o=hf(r.g,"EXT-X-DEFINE"),s=Rf(e,o),c=t.stream,d=Tf(e,t),u=Qf(r,c.mimeType),f=u.keyIds,p=u.drmInfos,v=c.keyIds,D=f,v.size===D.size&&[].concat(l(v)).every(function(e){return D.has(e)})||(c.keyIds=f,c.drmInfos=p,e.i.newDrmInfo(c)),m=tp(e,r,c.type,d,s),c.segmentIndex.Hb(m,e.j.Pa()),m.length&&(_=vf(r.g,"EXT-X-MEDIA-SEQUENCE"),h=d.get(_),c.segmentIndex.fb(h)),b=m[m.length-1],gf(r.g,"EXT-X-ENDLIST")&&(t.mc=!0,t.Za=b.endTime),S(g)})}function Ff(e,t,n){t.stream.segmentIndex.offset(n),t.Za+=n;for(var a=(t=d(e=Tf(e,t))).next();!a.done;a=t.next()){var i=d(a.value);a=i.next().value,i=i.next().value,e.set(a,i+n)}}function Hf(e){if(rp(e)){if(e.O=e.H,e.ia==_p){var t=zf(e);e.g.hls.useSafariBehaviorForLive&&(t=e.j.m),isNaN(e.g.availabilityWindowOverride)||(t=e.g.availabilityWindowOverride),e.j.le(t)}}else e.j.Ia(zf(e));e.j.Md()}function Rf(e,t){for(var n=new Map,a=(t=d(t)).next();!a.done;a=t.next()){var i=a.value;a=ff(i,"NAME");var r=ff(i,"VALUE");i=ff(i,"IMPORT"),a&&r&&n.set(a,r),i&&(a=e.o.get(i))&&n.set(i,a)}return n}function Nf(e,t){var n=[];e.g.disableVideo||n.push(e.g.hls.defaultVideoCodec),e.g.disableAudio||n.push(e.g.hls.defaultAudioCodec),n=ff(t,"CODECS",n.join(",")).split(/\s*,\s*/),e=new Set,t=[];for(var a=(n=d(n)).next();!a.done;a=n.next()){var i=Wt(a=a.value)[0];e.has(i)||(t.push(a),e.add(i))}return t}function Bf(e){return an(e=ff(e,"LANGUAGE")||"und")}function jf(e,t){var n=pf(t,"GROUP-ID"),a="",i=pf(t,"TYPE").toLowerCase();"subtitles"==i&&(i=et);var r=i;if(r!=et&&n&&e.s.has(n)&&(a=e.s.get(n)),i=np(pf(t,"URI"),e.o),e.h.has(i))return e.h.get(i);var o=Bf(t),s=ff(t,"NAME"),c="YES"==ff(t,"DEFAULT"),d="audio"==r&&(d=ff(t,"CHANNELS"))?parseInt(d.split("/")[0],10):null,l="audio"==r&&!!(l=ff(t,"CHANNELS"))&&l.includes("/JOC");return a=Vf(e,i,a,r,o,c,s,d,null,ff(t,"CHARACTERISTICS"),t="YES"==ff(t,"FORCED"),l),e.u.has(n)?e.u.get(n).push(a):e.u.set(n,[a]),e.h.has(i)?e.h.get(i):(e.h.set(i,a),a)}function Vf(e,t,n,a,i,r,o,s,c,l,u,f){var p=yf(e.M,t),m=qf(e,n,a,i,r,o,s,c,l,u,f);Zo.includes(m.mimeType)&&(m.codecs="");var _={stream:m,type:a,Ac:t,Jc:p,Za:0,ad:new Map,Mc:!1,mc:!1,Dd:-1,Ld:!1},h=null,b=new AbortController;return m.createSegmentIndex=function(){return h||(b=new AbortController,h=new Promise(function(p){p(function(p){var h,b,g,v,D,I,x,C,O,w,E,A,L;return M(function(k){if(1==k.g)return y(k,ip(e,_.Jc),2);if(3!=k.g)return h=k.h,p.aborted?k.return():(b=h.uri,g=Of(e.W,h.data,b),v=rp(e),y(k,Wf(e,g,t,b,n,a,i,r,o,s,c,l,u,f),3));if(D=k.h,p.aborted)return k.return();if(I=D.stream,rp(e)&&!v&&Xf(e),_.Jc=b,_.Za=D.Za,_.Mc=D.Mc,_.mc=D.mc,_.ad=D.ad,_.Ld=!0,m.segmentIndex=I.segmentIndex,m.encrypted=I.encrypted,m.drmInfos=I.drmInfos,m.keyIds=I.keyIds,m.mimeType=I.mimeType,Zo.includes(m.mimeType)&&(m.codecs=""),m.drmInfos.length&&e.i.newDrmInfo(m),a==(x=tt).wa||a==x.Hc)for(C=d(e.h.values()),O=C.next();!O.done;O=C.next())(w=O.value).Ld||w.type!=a||(w.stream.mimeType=I.mimeType,Zo.includes(w.stream.mimeType)&&(w.stream.codecs=""));(function(e){if(!e.D)return!1;for(var t=[],n=[],a=(e=d(e.D.variants)).next();!a.done;a=e.next())(a=a.value).video&&t.push(a.video),a.audio&&n.push(a.audio);return!(0<t.length&&!t.some(function(e){return e.segmentIndex})||0<n.length&&!n.some(function(e){return e.segmentIndex}))})(e)&&(e.La?Kf(e,[_]):(e.La=!0,E=Array.from(e.h.values()),A=E.filter(function(e){return e.stream.segmentIndex}),Kf(e,A),Hf(e),0<(L=e.O)&&e.m.N(L))),S(k)})}(b.signal))}))},m.closeSegmentIndex=function(){h&&!m.segmentIndex&&b.abort(),m.segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null),h=null},_}function zf(e){for(var t=1/0,n=(e=d(e.h.values())).next();!n.done;n=e.next())(n=n.value).stream.segmentIndex&&"text"!=n.stream.type&&(t=Math.min(t,n.Za));return t}function Gf(e,t){for(var n=[],a=(t=d(t)).next();!a.done;a=t.next())(a=a.value).segmentIndex&&ys(a.segmentIndex,function(e){n.push(e)});e.j.Ib(n)}function Kf(e,t){if(!rp(e))for(var n=zf(e),a=d(t),i=a.next();!i.done;i=a.next())i.value.stream.segmentIndex.Xa(0,n);for(i=(n=d(t)).next();!i.done;i=n.next())i=i.value.stream,Zo.includes(i.mimeType)&&(i.codecs="");Gf(e,t.map(function(e){return e.stream})),e.g.hls.ignoreManifestProgramDateTime?function(e,t){for(var n=-1==e.B,a=d(t),i=a.next();!i.done;i=a.next()){var r=(i=i.value).stream.segmentIndex,o=Tf(e,i);if(r=r.g[0]||null)for(var s=(o=d(o)).next();!s.done;s=o.next()){var c=(s=d(s.value)).next().value;if(s.next().value==r.startTime){n&&(e.B=Math.max(e.B,c)),i.Dd=c;break}}}if(!(0>e.B))for(i=(t=d(t)).next();!i.done;i=t.next())(a=(n=i.value).stream.segmentIndex)&&(a.g.splice(0,e.B-n.Dd),(a=a.g[0]||null)&&Ff(e,n,-a.startTime))}(e,t):function(e,t){if(1/0==e.L)for(var n=(t=d(t)).next();!n.done;n=t.next()){var a=n.value.stream.segmentIndex.g[0]||null;null!=a&&null!=a.g&&(e.L=Math.min(e.L,a.g))}if(1/0!=(t=e.L))for(n=(a=d(e.h.values())).next();!n.done;n=a.next()){var i=(n=n.value).stream.segmentIndex;null!=i&&(null==(i=i.g[0]||null).g?K("Missing EXT-X-PROGRAM-DATE-TIME for stream",n.Ac,"Expect AV sync issues!"):Ff(e,n,i.g-t-i.startTime))}}(e,t)}function Wf(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){var _,h,b,g,v,S,D,I,x,C,O,w,E,A,L;return M(function(k){if(1==k.g){if(1!=t.type)throw new ke(2,4,4017);return _=hf(t.g,"EXT-X-DEFINE"),h=Rf(e,_),Jf(e,t),m?k.A(2):y(k,function(e,t,n,a,i){var r,o,s,c,d,l,u,f,p,m;return M(function(_){return 1==_.g?(r=Aa,o=Math.trunc((a.segments.length-1)/2),s=np(a.segments[o].i,i),c=new Pe(s),d=c.ra.split(".").pop(),l=up[t],(u=l[d])||(u=cp[d])||(u=ap(t,n))?_.return(u):((f=Ca([s],e.g.retryParameters)).method="HEAD",y(_,sp(e,f,r),2))):(p=_.h,(m=p.headers["content-type"])?_.return(m.split(";")[0]):_.return(t==et?"text/vtt":up[t].mp4))})}(e,r,i,t,h),3)}if(2!=k.g&&(m=k.h),b=Qf(t,m),g=b.drmInfos,v=b.keyIds,S=b.encrypted,D=b.jf,S&&!g.length&&!D)throw new ke(2,4,4026);return I=rp(e)?e.F.get(r):new Map,x=e.l,C=tp(e,t,r,I,h),x!=e.l&&Jf(e,t),O=C[C.length-1].endTime,w=new vs(C),A=!!(E=gf(t.g,"EXT-X-SERVER-CONTROL"))&&null!=E.getAttribute("CAN-SKIP-UNTIL"),(L=qf(e,i,r,o,s,c,d,l,u,f,p)).segmentIndex=w,L.encrypted=S,L.drmInfos=g,L.keyIds=v,L.mimeType=m,k.return({stream:L,type:r,Ac:n,Jc:a,Za:O,Mc:A,mc:!1,Dd:-1,ad:I,Ld:!1})})}function qf(e,t,n,a,i,r,o,s,c,d,l){var u=ap(n,t)||(n==et?"text/vtt":up[n].mp4);return{id:e.Fa++,originalId:r,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:null,mimeType:u,codecs:t,kind:n==et?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:a,label:r,type:n,primary:i,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:c?c.split(","):[],forced:d,channelsCount:o,audioSamplingRate:null,spatialAudio:l,closedCaptions:s,hdr:void 0,tilesLayout:void 0}}function Qf(e,t){var n=[];if(e.segments)for(var a=(e=d(e.segments)).next();!a.done;a=e.next())a=hf(a.value.g,"EXT-X-KEY"),n.push.apply(n,l(a));a=e=!1;for(var i=[],r=new Set,o=(n=d(n)).next();!o.done;o=n.next()){var s=pf(o=o.value,"METHOD");if("NONE"!=s)if(e=!0,"AES-128"==s)a=!0;else if(s=ff(o,"KEYFORMAT")||"identity",o=(s=fp[s])?s(o,t):null){if(o.keyIds)for(var c=(s=d(o.keyIds)).next();!c.done;c=s.next())r.add(c.value);i.push(o)}}return{drmInfos:i,keyIds:r,encrypted:e,jf:a}}function Yf(t,n,a){if(!e.crypto||!e.crypto.subtle)throw W("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new ke(2,4,4042);var i=0,r=ff(n,"IV","");if(r){var o=Lt(r.substr(2));if(16!=o.byteLength)throw new ke(2,4,4043)}else i=vf(a.g,"EXT-X-MEDIA-SEQUENCE");var s=Ca([n=yf(a.h,pf(n,"URI"))],t.g.retryParameters),c={method:"AES-128",iv:o,firstMediaSequenceNumber:i,fetchKey:function(){var n,a,i;return M(function(r){if(1==r.g)return y(r,sp(t,s,6),2);if(3!=r.g){if(!(n=r.h).data||16!=n.data.byteLength)throw new ke(2,4,4044);return a={name:"AES-CBC"},i=c,y(r,e.crypto.subtle.importKey("raw",n.data,a,!0,["decrypt"]),3)}i.cryptoKey=r.h,c.fetchKey=void 0,S(r)})}};return c}function Jf(e,t){var n=gf(t.g,"EXT-X-PLAYLIST-TYPE"),a=gf(t.g,"EXT-X-ENDLIST");if(a=n&&"VOD"==n.value||a,n=n&&"EVENT"==n.value&&!a,n=!a&&!n,a)op(e,pp);else{if(op(e,n?_p:mp),!(a=gf(t.g,"EXT-X-TARGETDURATION")))throw new ke(2,4,4024,"EXT-X-TARGETDURATION");a=Number(a.value),n=gf(t.g,"EXT-X-PART-INF"),e.l&&n?(e.da=Number(pf(n,"PART-TARGET")),e.H=Math.min(e.da,e.H),t=gf(t.g,"EXT-X-SERVER-CONTROL"),e.V=t?Number(pf(t,"PART-HOLD-BACK")):0):e.H=Math.min(a,e.H),e.ca=Math.max(a,e.ca)}}function Xf(e){var t=e.g.defaultPresentationDelay?e.g.defaultPresentationDelay:e.V?e.V:e.ca*e.g.hls.liveSegmentsDelay;e.j.We(0),e.j.Ve(t),e.j.yc(!1)}function Zf(e,t,n,a){return(n=gf(n,"EXT-X-MAP"))?(t=[a=np(yf(t,pf(n,"URI")),a),ff(n,"BYTERANGE","")].join("-"),e.ba.has(t)||(n=function(e,t){var n=0,a=null;return(t=ff(t,"BYTERANGE"))&&(n=t.split("@"),a=Number(n[0]),a=(n=Number(n[1]))+a-1),new fo(function(){return[e]},n,a)}(a,n),e.ba.set(t,n)),e.ba.get(t)):null}function $f(e,t,n,a,i,r,o,s,c){var l=a.g,u=np(a.i,r),f=gf(l,"EXTINF"),p=r=0,m=null;a.h.length&&!e.l&&W("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var _=null;if(!e.g.hls.ignoreManifestProgramDateTime){var h=gf(l,"EXT-X-PROGRAM-DATE-TIME");h&&h.value&&(_=ui(h.value))}if(h=mo,gf(l,"EXT-X-GAP")&&(h=2),!f){if(0==a.h.length)throw new ke(2,4,4024,"EXTINF");if(!e.l)return null}var b=[];if(e.l)for(var g={},v=0;v<a.h.length;g={qd:g.qd},v++){var y=a.h[v],S=0==v?n:b[b.length-1],D=0==v?i:S.endTime,I=Number(ff(y,"DURATION"))||e.da;if(I){I=D+I;var x=0,C=null;"EXT-X-PRELOAD-HINT"==y.name?x=(x=ff(y,"BYTERANGE-START"))?Number(x):0:(x=(C=d(ep(S,x=ff(y,"BYTERANGE")))).next().value,C=C.next().value),(S=ff(y,"URI"))&&(g.qd=yf(o,S),S=mo,"YES"==ff(y,"GAP")&&(S=2),b.push(new po(D,I,function(e){return function(){return[e.qd]}}(g),x,C,t,0,0,1/0,[],"",null,null,S)))}}return r=f?i+Number(f.value.split(",")[0]):b[b.length-1].endTime,(e=gf(l,"EXT-X-BYTERANGE"))?(p=(m=d(ep(n,e.value))).next().value,m=m.next().value):b.length&&(p=b[0].Ba,m=b[b.length-1].ka),n="",e=null,"image"==s&&(n="1x1",s=gf(l,"EXT-X-TILES"))&&(n=pf(s,"LAYOUT"),(s=ff(s,"DURATION"))&&(e=Number(s))),new po(i,r,function(){return u.length?[u]:[]},p,m,t,0,0,1/0,b,n,e,_,h,c)}function ep(e,t){var n=0,a=null;return t&&(n=t.split("@"),t=Number(n[0]),a=(n=n[1]?Number(n[1]):e.ka+1)+t-1),[n,a]}function tp(e,t,n,a,i){var r=t.segments,o=void 0,s=vf(t.g,"EXT-X-DISCONTINUITY-SEQUENCE"),c=vf(t.g,"EXT-X-MEDIA-SEQUENCE"),l=gf(t.g,"EXT-X-SKIP"),u=c+(l=l?Number(ff(l,"SKIPPED-SEGMENTS")):0),f=0;rp(e)&&a.has(u)&&(f=a.get(u));for(var p=[],m=null,_=0;_<r.length;_++){var h=r[_],b=0==_?f:m.endTime;u=c+l+_,gf(t.g,"EXT-X-DISCONTINUITY")&&s++;for(var g=d(h.g),v=g.next();!v.done;v=g.next())"EXT-X-KEY"==(v=v.value).name&&"AES-128"==pf(v,"METHOD")&&(o=Yf(e,v,t));a.set(u,b),g=Zf(e,t.h,h.g,i),!e.l&&e.i.isAutoLowLatencyMode()&&(e.i.enableLowLatencyMode(),e.l=e.i.isLowLatencyMode()),(m=h=$f(e,g,m,h,b,i,t.h,n,o))&&(h.m=s,e.g.hls.ignoreManifestProgramDateTime&&null!=e.B&&u<e.B||p.push(h))}if(e=p.some(function(e){return null!=e.g}))for(t={},n=0;n<p.length;t={Qb:t.Qb,Pb:t.Pb,Bc:t.Bc,Ta:t.Ta,Ob:t.Ob},n++)if(t.Ta=p[n],null==t.Ta.g)for(t.Pb=0,t.Qb=n,a=function(e){return function(){var t=p[e.Qb];if(t){if(null!=t.g)return t.g+e.Pb;e.Pb-=t.endTime-t.startTime,e.Qb+=1}return null}}(t),t.Ob=0,t.Bc=n,i=function(e){return function(){var t=p[e.Bc];if(t){if(t!=e.Ta&&(e.Ob+=t.endTime-t.startTime),null!=t.g)return t.g+e.Ob;--e.Bc}return null}}(t);null==t.Ta.g;)t.Ta.g=i(),null==t.Ta.g&&(t.Ta.g=a());if(e)for(t=(e=d(p)).next();!t.done;t=e.next())for(t=(n=t.value).g,a=(n=d(n.i)).next();!a.done;a=n.next())(a=a.value).g=t,t+=a.endTime-a.startTime;return p}function np(e,t){var n=(e=String(e).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(n)for(var a=(n=d(n)).next();!a.done;a=n.next()){var i=(a=a.value).slice(2,a.length-1),r=t.get(i);if(!r)throw new ke(2,4,4039,i);e=e.replace(a,r)}return e}function ap(e,t){if(e==et){if("vtt"==t||"wvtt"==t)return"text/vtt";if(t&&""!==t)return"application/mp4"}return"image"!=e||t&&"jpeg"!=t?"audio"==e&&"mp4a.40.34"==t?"audio/mpeg":null:"image/jpeg"}function ip(e,t){return t=Ca([t],e.g.retryParameters),e.i.modifyManifestRequest(t,{format:"h"}),sp(e,t,0)}function rp(e){return e.ia!=pp}function op(e,t){e.ia=t,e.j&&e.j.yc(!rp(e)),rp(e)||e.m.stop()}function sp(e,t,n){if(!e.G)throw new ke(2,7,7001);return t=e.i.networkingEngine.request(n,t),Da(e.G,t),t.promise}B("shaka.net.DataUriPlugin",Lf),Lf.parse=kf,xa("data",kf),(a=Pf.prototype).configure=function(e){this.g=e},a.start=function(e,t){var n,a=this;return M(function(i){return 1==i.g?(a.i=t,a.l=t.isLowLatencyMode(),y(i,ip(a,e),2)):3!=i.g?(n=i.h,a.M=n.uri,y(i,function(e,t,n){var a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,I,x,O,w,E,A,L,k,P,T,U,F,H,R,N;return M(function(B){switch(B.g){case 1:for(var j=d(hf((a=Of(e.W,t,e.M)).g,"EXT-X-DEFINE")),V=j.next();!V.done;V=j.next()){var z=V.value;V=ff(z,"NAME"),z=ff(z,"VALUE"),V&&z&&(e.o.has(V)||e.o.set(V,z))}if(i=[],r=[],o=[],1==a.type)return O=e.g.hls.mediaPlaylistFullMimeType,a.segments.length&&(w=new Pe(a.segments[0].i),E=w.ra.split(".").pop(),(A=cp[E])?O=A:"ts"!==E&&"mp4"!==E&&(dp[E]?(A=dp[E],L=e.g.hls.defaultAudioCodec,O=A+'; codecs="'+L+'"'):lp[E]&&(A=lp[E],k=e.g.hls.defaultVideoCodec,O=A+'; codecs="'+k+'"'))),P=O.split(";")[0],T=P.split("/")[0],U=Kt(O),F=new Map,y(B,Wf(e,a,n,n,U,T,"",!0,"Media Playlist",null,F,null,!1,!1,P),5);for(s=hf(a.g,"EXT-X-MEDIA"),c=hf(a.g,"EXT-X-STREAM-INF"),l=hf(a.g,"EXT-X-IMAGE-STREAM-INF"),u=hf(a.g,"EXT-X-SESSION-KEY"),V=(j=d(c)).next();!V.done;V=j.next()){var G=V.value;z=ff(G,"AUDIO"),V=ff(G,"VIDEO");var K=ff(G,"SUBTITLES");if(G=Nf(e,G),K){var W=$e(et,G);e.s.set(K,W),te(G,W)}z&&((K=$e("audio",G))||(K=e.g.hls.defaultAudioCodec),e.s.set(z,K)),V&&((z=$e("video",G))||(z=e.g.hls.defaultVideoCodec),e.s.set(V,z))}for(f=hf(a.g,"EXT-X-SESSION-DATA"),p=d(f),m=p.next();!m.done;m=p.next())_=m.value,h=ff(_,"DATA-ID"),b=ff(_,"URI"),g=ff(_,"LANGUAGE"),v=ff(_,"VALUE"),I=(new Map).set("id",h),b&&I.set("uri",yf(e.M,b)),g&&I.set("language",g),v&&I.set("value",v),x=new _a("sessiondata",I),e.i&&e.i.onEvent(x);for(function(e,t){t=t.filter(function(e){var t=ff(e,"URI")||"";return"SUBTITLES"!=ff(e,"TYPE")&&""!=t});for(var n=(t=d(t)).next();!n.done;n=t.next())jf(e,n.value)}(e,s),V=(j=d(j=bf(s,"CLOSED-CAPTIONS"))).next();!V.done;V=j.next())V=Bf(K=V.value),z=pf(K,"GROUP-ID"),K=pf(K,"INSTREAM-ID"),e.J.get(z)||e.J.set(z,new Map),e.J.get(z).set(K,V);return i=function(e,t,n){var a=[],i=new Set;if(0<n.length)for(var r=(n=d(n)).next();!r.done;r=n.next()){var o=pf(r=r.value,"METHOD");if("NONE"!=o&&"AES-128"!=o&&(o=ff(r,"KEYFORMAT")||"identity",r=(o=fp[o])?o(r,""):null)){if(r.keyIds)for(var s=(o=d(r.keyIds)).next();!s.done;s=o.next())i.add(s.value);a.push(r)}}return t=t.map(function(t){var n=ff(t,"FRAME-RATE"),r=Number(ff(t,"AVERAGE-BANDWIDTH"))||Number(pf(t,"BANDWIDTH")),o=ff(t,"RESOLUTION"),s=(o=d(o?o.split("x"):[null,null])).next().value,c=o.next().value,l=ff(t,"VIDEO-RANGE");t=function(e,t){var n=Nf(e,t),a=ff(t,"AUDIO"),i=ff(t,"VIDEO"),r=a||i;r=r&&e.u.has(r)?e.u.get(r):[],a={audio:a?r:[],video:i?r:[]},i=!1;var o=pf(t,"URI"),s=a.audio.find(function(e){return e&&e.Ac==o}),c=$e("video",n),d=$e("audio",n);return d&&!c?r="audio":!r.length&&d&&c?(r="video",n=[[c,d].join()]):a.audio.length&&s?(r="audio",i=!0):r=a.video.length&&!a.audio.length?"audio":"video",i||(e=function(e,t,n,a){var i=np(pf(t,"URI"),e.o);return e.h.has(i)?e.h.get(i):(t=ff(t,"CLOSED-CAPTIONS"),t="video"==a&&t&&"NONE"!=t?e.J.get(t):null,a=Vf(e,i,n=Ze(a,n),a,"und",!1,null,null,t,null,!1,!1),e.h.has(i)?e.h.get(i):(e.h.set(i,a),a))}(e,t,n,r),a[e.stream.type]=[e]),a}(e,t),o=t.audio;for(var u=d(t=t.video),f=u.next();!f.done;f=u.next())(f=f.value.stream)&&(f.width=Number(s)||void 0,f.height=Number(c)||void 0,f.frameRate=Number(n)||void 0,f.hdr=l||void 0);for(n=e.g.disableAudio,o.length&&!n||(o=[null]),n=e.g.disableVideo,t.length&&!n||(t=[null]),n=[],s=(o=d(o)).next();!s.done;s=o.next())for(s=s.value,l=(c=d(t)).next();!l.done;l=c.next()){var p=l.value;(l=s?s.stream:null)&&(l.drmInfos=a,l.keyIds=i),(u=p?p.stream:null)&&(u.drmInfos=a,u.keyIds=i),f=s?s.stream.drmInfos:null;var m=p?p.stream.drmInfos:null;p=(p?p.Ac:"")+" - "+(s?s.Ac:""),l&&u&&f.length&&m.length&&!(0<Fi(f,m).length)||e.va.has(p)||(l={id:e.Fa++,language:l?l.language:"und",primary:!!l&&l.primary||!!u&&u.primary,audio:l,video:u,bandwidth:r,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},n.push(l),e.va.add(p))}return n}).reduce(qe,[]),t.filter(function(e){return null!=e})}(e,c,u),r=function(e,t){var n=bf(t,"SUBTITLES");t=n.map(function(t){if(e.g.disableText)return null;try{return jf(e,t).stream}catch(t){if(e.g.hls.ignoreTextStreamFailures)return null;throw t}});for(var a=(n=d(n)).next();!a.done;a=n.next()){var i=pf(a.value,"GROUP-ID");if((a=e.s.get(i))&&(i=e.u.get(i)))for(var r=(i=d(i)).next();!r.done;r=i.next())r.value.stream.codecs=a}return t.filter(function(e){return e})}(e,s),y(B,function(e,t){var n,a;return M(function(i){return 1==i.g?(n=t.map(function(t){var n,a;return M(function(i){if(1==i.g)return e.g.disableThumbnails?i.return(null):(D(i,2),y(i,function(e,t){var n,a,i,r,o,s,c,d,l,u;return M(function(f){return 1==f.g?(n=np(pf(t,"URI"),e.o),a=ff(t,"CODECS","jpeg")||"",e.h.has(n)?f.return(e.h.get(n)):(i=Bf(t),r=ff(t,"NAME"),o=ff(t,"CHARACTERISTICS"),s=Vf(e,n,a,"image",i,!1,r,null,null,o,!1,!1),e.h.has(n)?f.return(e.h.get(n)):(c=ff(t,"RESOLUTION"))?y(f,s.stream.createSegmentIndex(),3):f.A(2))):(2!=f.g&&(d=s.stream.segmentIndex.get(0),l=d.tilesLayout)&&(s.stream.width=Number(c.split("x")[0])*Number(l.split("x")[0]),s.stream.height=Number(c.split("x")[1])*Number(l.split("x")[1])),(u=ff(t,"BANDWIDTH"))&&(s.stream.bandwidth=Number(u)),e.h.set(n,s),f.return(s))})}(e,t),4));if(2!=i.g)return n=i.h,i.return(n.stream);if(a=C(i),e.g.hls.ignoreImageStreamFailures)return i.return(null);throw a})}),y(i,Promise.all(n),2)):(a=i.h,i.return(a.filter(function(e){return e})))})}(e,l),4);case 4:o=B.h,B.A(3);break;case 5:H=B.h,e.h.set(n,H),i.push({id:0,language:"und",disabledUntilTime:0,primary:!0,audio:"audio"==T?H.stream:null,video:"video"==T?H.stream:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!e.i)throw new ke(2,7,7001);e.j=new $o(null,0),e.j.yc(!0),1==a.type&&(rp(e)&&(Xf(e),R=e.O,e.m.N(R)),N=Array.from(e.h.values()),Kf(e,N),Hf(e)),e.D={presentationTimeline:e.j,variants:i,textStreams:r,imageStreams:o,offlineSessionIds:[],minBufferTime:0,sequenceMode:!0},e.i.makeTextStreamsForClosedCaptions(e.D),S(B)}})}(a,n.data,e),3)):i.return(a.D)})},a.stop=function(){this.m&&(this.m.stop(),this.m=null);var e=[];return this.G&&(e.push(this.G.destroy()),this.G=null),this.g=this.i=null,this.va.clear(),this.D=null,this.h.clear(),this.u.clear(),this.s.clear(),this.o.clear(),Promise.all(e)},a.update=function(){var e,t,n,a,i,r,o,s,c=this;return M(function(u){if(1==u.g){if(!rp(c))return u.return();for(e=[],t=Array.from(c.h.values()),n=t.filter(function(e){return e.stream.segmentIndex}),a=d(n),i=a.next();!i.done;i=a.next())r=i.value,e.push(Uf(c,r));return y(u,Promise.all(e),2)}Gf(c,n.map(function(e){return e.stream})),o=n.some(function(e){return 0==e.mc}),n.length&&!o&&(op(c,hp.ef),s=t.map(function(e){return e.Za}),c.j.Ia(Math.min.apply(Math,l(s))),c.i.updateDuration()),S(u)})},a.onExpirationUpdated=function(){},B("shaka.hls.HlsParser",Pf);var cp={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},dp={mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t"},lp={mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},up={audio:dp,video:lp,text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"txt/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},fp={"com.apple.streamingkeydelivery":function(t,n){if("video/mp2t"==n)throw new ke(2,4,4040);if(e.shakaMediaKeysPolyfill)throw new ke(2,4,4041);return Xe("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=pf(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?(t=Xe("com.widevine.alpha",[{initDataType:"cenc",initData:t=Ee((t=Mf(t=pf(e,"URI"))).data)}]),(e=ff(e,"KEYID"))&&(t.keyIds=new Set([e.toLowerCase().substr(2)])),t):null},"com.microsoft.playready":function(e){var t=pf(e,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(t)?Xe("com.microsoft.playready",[{initDataType:"cenc",initData:e=ti(e=Ee((e=Mf(e=pf(e,"URI"))).data),t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]):null},identity:function(e){return e=pf(e,"METHOD"),["SAMPLE-AES","SAMPLE-AES-CTR"].includes(e)?Xe("org.w3.clearkey",null):null}},pp="VOD",mp="EVENT",_p="LIVE",hp={ef:pp,Og:mp,Tg:_p};function bp(e,t,n,a,i,r){if(200<=n&&299>=n&&202!=n)return{uri:i||a,Ne:a,data:t,status:n,headers:e,fromCache:!!e["x-shaka-from-cache"]};i=null;try{i=Dt(t)}catch(e){}throw new ke(401==n||403==n?2:1,1,1001,a,n,i,e,r)}function gp(){}function vp(e,t,n,a,i){var r=new Cp;Ra(t.headers).forEach(function(e,t){r.append(t,e)});var o=new Ip,s={we:!1,af:!1};if(e=function(e,t,n,a,i,r,o){var s,c,d,l,u,f,p,m,_,h,b,g;return M(function(v){switch(v.g){case 1:return s=Dp,c=xp,f=u=0,p=Date.now(),D(v,2),y(v,s(e,n),4);case 4:return d=v.h,r(yp(d.headers)),m=d.clone().body.getReader(),h=(_=d.headers.get("Content-Length"))?parseInt(_,10):0,new c({start:function(e){!function t(){var n,a;return M(function(r){switch(r.g){case 1:return D(r,2),y(r,m.read(),4);case 4:n=r.h,x(r,3);break;case 2:return C(r),r.return();case 3:if(n.done){r.A(5);break}if(u+=n.value.byteLength,!o){r.A(5);break}return y(r,o(n.value),5);case 5:(100<(a=Date.now())-p||n.done)&&(i(a-p,u-f,h-u),f=u,p=a),n.done?e.close():(e.enqueue(n.value),t()),S(r)}})}()}}),y(v,d.arrayBuffer(),5);case 5:l=v.h,x(v,3);break;case 2:if(b=C(v),a.we)throw new ke(1,1,7001,e,t);if(a.af)throw new ke(1,1,1003,e,t);throw new ke(1,1,1002,e,b,t);case 3:return g=yp(d.headers),v.return(bp(g,l,d.status,e,d.url,t))}})}(e,n,{body:t.body||void 0,headers:r,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},s,a,i,t.streamDataCallback),e=new da(e,function(){return s.we=!0,o.abort(),Promise.resolve()}),t=t.retryParameters.timeout){var c=new ot(function(){s.af=!0,o.abort()});c.N(t/1e3),e.finally(function(){c.stop()})}return e}function yp(e){var t={};return e.forEach(function(e,n){t[n.trim()]=e}),t}function Sp(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)}_t("Tizen 3")||_t("Tizen 2")||ut()||(Ji.m3u8=function(){return new Pf},Yi["application/x-mpegurl"]=function(){return new Pf},Yi["application/vnd.apple.mpegurl"]=function(){return new Pf}),B("shaka.net.HttpFetchPlugin",gp),gp.isSupported=Sp,gp.parse=vp;var Dp=e.fetch,Ip=e.AbortController,xp=e.ReadableStream,Cp=e.Headers;function Op(){}function wp(e,t,n,a,i){var r=new Ap,o=Date.now(),s=0;return new da(new Promise(function(c,d){r.open(t.method,e,!0),r.responseType="arraybuffer",r.timeout=t.retryParameters.timeout,r.withCredentials=t.allowCrossSiteCredentials,r.onabort=function(){d(new ke(1,1,7001,e,n))};var l=!1;for(var u in r.onreadystatechange=function(){if(2==r.readyState&&!l){var e=Ep(r);i(e),l=!0}},r.onload=function(){var t=Ep(r),a=r.response;try{var i=bp(t,a,r.status,e,r.responseURL,n);c(i)}catch(e){d(e)}},r.onerror=function(t){d(new ke(1,1,1002,e,t,n))},r.ontimeout=function(){d(new ke(1,1,1003,e,n))},r.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(a(t-o,e.loaded-s,e.total-e.loaded),s=e.loaded,o=t)},t.headers)r.setRequestHeader(u.toLowerCase(),t.headers[u]);r.send(t.body)}),function(){return r.abort(),Promise.resolve()})}function Ep(e){var t=e.getAllResponseHeaders().trim().split("\r\n");e={};for(var n=(t=d(t)).next();!n.done;n=t.next())e[(n=n.value.split(": "))[0].toLowerCase()]=n.slice(1).join(": ");return e}Sp()&&(xa("http",vp,2,!0),xa("https",vp,2,!0),xa("blob",vp,2,!0)),B("shaka.net.HttpXHRPlugin",Op),Op.parse=wp;var Ap=e.XMLHttpRequest;function Lp(e,t,n,a){this.g=e,this.i=t,this.groupId=n,this.h=a}function kp(e){return e.za().map(function(e){return"{"+encodeURI(e)+"}"}).join("")+":"+e.Ba+":"+e.ka}function Mp(e,t){return Hs(e.g.za(),e.g.Ba,e.g.ka,t.streaming.retryParameters)}function Pp(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function Tp(e,t){e.i+=t;var n=e.l;return e.l++,e.g.set(n,t),n}function Up(e){var t=this;this.o=e,this.j=new Map,this.i=new Ma(function(){return Fp(t).catch(function(){})}),this.h=[],this.m=function(){},this.l=function(){},this.g=new Pp}function Fp(e){var t=e.h.map(function(e){return e()});return e.h=[],Promise.all(t)}function Hp(e,t,n,a,i,r){Pa(e.i);var o=(e.j.get(t)||Promise.resolve()).then(function(){var t,o,s,c,d,l,u;return M(function(f){if(1==f.g)return y(f,function(e,t){var n,a,i,r;return M(function(o){return 1==o.g?(n=Aa,a=e.o.request(n,t),i=function(){return a.abort()},e.h.push(i),y(o,a.promise,2)):(r=o.h,te(e.h,i),o.return(r.data))})}(e,n),2);if(t=f.h,e.i.g)throw new ke(2,9,7001);if(i)for(c in o=Ee(t),(s=new ei(o)).data)d=Number(c),l=s.data[d],u=s.g[d],e.l(l,u);e.g.close(a,t.byteLength);var p=e.g;return e.m(0==p.i?0:p.j/p.i,e.g.h),f.return(r(t))})});e.j.set(t,o)}function Rp(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new at,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function Np(e,t){return new Promise(function(n,a){var i=e.h.openCursor();i.onerror=a,i.onsuccess=function(){var e;return M(function(a){if(1==a.g)return null==i.result?(n(),a.return()):(e=i.result,y(a,t(e.key,e.value,e),2));e.continue(),S(a)})}})}function Bp(e){this.h=e,this.g=[]}function jp(e,t){return Vp(e,t,"readwrite")}function Vp(e,t,n){var a=new Rp(n=e.h.transaction([t],n),t);return e.g.push(a),a.promise().then(function(){te(e.g,a)},function(){te(e.g,a)}),a}function zp(e,t,n){this.h=new Bp(e),this.i=t,this.g=n}function Gp(e){return Promise.reject(new ke(2,9,9011,"Cannot add new value to "+e))}function Kp(e,t,n,a){t=(e=jp(e.h,t)).store();for(var i={},r=(n=d(n)).next();!r.done;i={Ec:i.Ec},r=n.next())i.Ec=r.value,t.delete(i.Ec).onsuccess=function(e){return function(){return a(e.Ec)}}(i);return e.promise()}function Wp(e,t,n){var a,i,r,o,s,c,l;return M(function(u){if(1==u.g){for(a=Vp(e.h,t,"readonly"),i=a.store(),r={},o=[],s={},c=d(n),l=c.next();!l.done;s={Vb:s.Vb,Tb:s.Tb},l=c.next())s.Tb=l.value,s.Vb=i.get(s.Tb),s.Vb.onsuccess=function(e){return function(){null==e.Vb.result&&o.push(e.Tb),r[e.Tb]=e.Vb.result}}(s);return y(u,a.promise(),2)}if(o.length)throw new ke(2,9,9012,"Could not find values for "+o);return u.return(n.map(function(e){return r[e]}))})}function qp(e){this.g=new Bp(e)}function Qp(){this.g=new Map}function Yp(e){var t=null;if(e.g.forEach(function(e,n){e.getCells().forEach(function(e,a){e.hasFixedKeySpace()||t||(t={path:{Aa:n,ja:a},ja:e})})}),t)return t;throw new ke(2,9,9013,"Could not find a cell that supports add-operations")}function Jp(e,t,n){if(!(e=e.g.get(t)))throw new ke(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new ke(2,9,9013,"Could not find cell with name "+n);return t}function Xp(e,t){Zp.set(e,t)}xa("http",wp,1,!0),xa("https",wp,1,!0),xa("blob",wp,1,!0),Pp.prototype.close=function(e,t){if(this.g.has(e)){var n=this.g.get(e);this.g.delete(e),this.j+=n,this.h+=t}},Up.prototype.destroy=function(){return this.i.destroy()},Rp.prototype.abort=function(){var e=this;return M(function(t){if(1==t.g){try{e.i.abort()}catch(e){}return D(t,2),y(t,e.g,4)}if(2!=t.g)return x(t,0);C(t),S(t)})},Rp.prototype.store=function(){return this.h},Rp.prototype.promise=function(){return this.g},Bp.prototype.destroy=function(){return Promise.all(this.g.map(function(e){return e.abort()}))},(a=zp.prototype).destroy=function(){return this.h.destroy()},a.hasFixedKeySpace=function(){return!0},a.addSegments=function(){return Gp(this.i)},a.removeSegments=function(e,t){return Kp(this,this.i,e,t)},a.getSegments=function(e){var t,n=this;return M(function(a){return 1==a.g?y(a,Wp(n,n.i,e),2):(t=a.h,a.return(t.map(function(e){return n.xe(e)})))})},a.addManifests=function(){return Gp(this.g)},a.updateManifest=function(){return Promise.reject(new ke(2,9,9016,"Cannot modify values in "+this.g))},a.updateManifestExpiration=function(e,t){var n=jp(this.h,this.g),a=n.store();return a.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,a.put(n,e))},n.promise()},a.removeManifests=function(e,t){return Kp(this,this.g,e,t)},a.getManifests=function(e){var t,n=this;return M(function(a){return 1==a.g?y(a,Wp(n,n.g,e),2):(t=a.h,a.return(Promise.all(t.map(function(e){return n.cc(e)}))))})},a.getAllManifests=function(){var e,t,n=this;return M(function(a){return 1==a.g?(e=Vp(n.h,n.g,"readonly"),t=new Map,y(a,Np(e,function(e,a){var i;return M(function(r){if(1==r.g)return y(r,n.cc(a),2);i=r.h,t.set(e,i),S(r)})}),2)):3!=a.g?y(a,e.promise(),3):a.return(t)})},a.xe=function(e){return e},a.cc=function(e){return Promise.resolve(e)},a.add=function(e,t){var n,a,i,r,o,s,c,l=this;return M(function(u){if(1==u.g){for(n=jp(l.h,e),a=n.store(),i=[],r={},o=d(t),s=o.next();!s.done;r={Fc:r.Fc},s=o.next())c=s.value,r.Fc=a.add(c),r.Fc.onsuccess=function(e){return function(){i.push(e.Fc.result)}}(r);return y(u,n.promise(),2)}return u.return(i)})},qp.prototype.destroy=function(){return this.g.destroy()},qp.prototype.getAll=function(){var e,t,n=this;return M(function(a){return 1==a.g?(e=Vp(n.g,"session-ids","readonly"),t=[],y(a,Np(e,function(e,n){t.push(n)}),2)):3!=a.g?y(a,e.promise(),3):a.return(t)})},qp.prototype.add=function(e){for(var t=jp(this.g,"session-ids"),n=t.store(),a=(e=d(e)).next();!a.done;a=e.next())n.add(a.value);return t.promise()},qp.prototype.remove=function(e){var t,n=this;return M(function(a){return 1==a.g?y(a,Np(t=jp(n.g,"session-ids"),function(t,n,a){e.includes(n.sessionId)&&a.delete()}),2):y(a,t.promise(),0)})},Qp.prototype.destroy=function(){for(var e=[],t=d(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Qp.prototype.init=function(){var e=this;Zp.forEach(function(t,n){(t=t())&&e.g.set(n,t)});for(var t=[],n=d(this.g.values()),a=n.next();!a.done;a=n.next())t.push(a.value.init());return Promise.all(t)},B("shaka.offline.StorageMuxer",Qp),Qp.unregister=function(e){Zp.delete(e)},Qp.register=Xp,Qp.prototype.destroy=Qp.prototype.destroy;var Zp=new Map;function $p(){zp.apply(this,arguments)}function em(e,t){!function(e){var t=e.streams.filter(function(e){return"audio"==e.contentType});if(e=e.streams.filter(function(e){return"video"==e.contentType}),!t.every(function(e){return e.variantIds})||!e.every(function(e){return e.variantIds})){for(var n=d(t),a=n.next();!a.done;a=n.next())a.value.variantIds=[];for(a=(n=d(e)).next();!a.done;a=n.next())a.value.variantIds=[];if(n=0,e.length&&!t.length){var i=n++,r=d(e);for(a=r.next();!a.done;a=r.next())a.value.variantIds.push(i)}if(!e.length&&t.length)for(i=n++,a=(r=d(t)).next();!a.done;a=r.next())a.value.variantIds.push(i);if(e.length&&t.length)for(a=(t=d(t)).next();!a.done;a=t.next())for(a=a.value,r=(i=d(e)).next();!r.done;r=i.next()){r=r.value;var o=n++;a.variantIds.push(o),r.variantIds.push(o)}}}(e);for(var n=d(e.streams),a=n.next();!a.done;a=n.next());return e.streams.map(function(n){return function(e,t,n){var a=e.initSegmentUri?tm(e.initSegmentUri):null,i=t+e.presentationTimeOffset,r=t+n;return{id:e.id,originalId:null,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:a,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(e){var n=tm(e.uri);return{startTime:t+e.startTime,endTime:t+e.endTime,dataKey:n,initSegmentKey:a,appendWindowStart:t,appendWindowEnd:r,timestampOffset:i,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}(n,e.startTime,t)})}function tm(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new ke(2,9,9004,"Could not parse uri "+e)}function nm(){zp.apply(this,arguments)}function am(e,t,n){return{id:e.id,originalId:e.originalId,primary:e.primary,type:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:e.pixelAspectRatio,hdr:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,encrypted:e.encrypted,keyIds:new Set([e.keyId]),segments:e.segments.map(function(a){return{startTime:t+a.startTime,endTime:t+a.endTime,initSegmentKey:e.initSegmentKey,appendWindowStart:t,appendWindowEnd:n,timestampOffset:t-e.presentationTimeOffset,dataKey:a.dataKey,tilesLayout:""}}),variantIds:e.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0}}function im(){zp.apply(this,arguments)}function rm(){this.m=this.j=this.i=this.h=this.g=this.l=null}function om(e,t,n,a){this.g=e,this.i=t,this.h=n,this.l=a,this.j=["offline:",e,"/",t,"/",n,"/",a].join("")}function sm(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var a=e[3];return a&&null!=t?new om(t,n,a,Number(e[4])):null}function cm(e,t){this.h=e,this.g=t}function dm(e,t){var n=new $o(null,0);n.Ia(t.duration);var a=t.streams.filter(function(e){return"audio"==e.type}),i=t.streams.filter(function(e){return"video"==e.type});a=function(e,t,n,a){for(var i=new Set,r=d(t),o=r.next();!o.done;o=r.next()){var s=d(o.value.variantIds);for(o=s.next();!o.done;o=s.next())i.add(o.value)}for(o=(r=d(n)).next();!o.done;o=r.next())for(o=(s=d(o.value.variantIds)).next();!o.done;o=s.next())i.add(o.value);for(r=new Map,o=(i=d(i)).next();!o.done;o=i.next())o=o.value,r.set(o,{id:o,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(i=(t=d(t)).next();!i.done;i=t.next())for(o=lm(e,i=i.value,a),i=(s=d(i.variantIds)).next();!i.done;i=s.next())(i=r.get(i.value)).language=o.language,i.primary=i.primary||o.primary,i.audio=o;for(t=(n=d(n)).next();!t.done;t=n.next())for(t=lm(e,i=t.value,a),i=(o=d(i.variantIds)).next();!i.done;i=o.next())(i=r.get(i.value)).primary=i.primary||t.primary,i.video=t;return r}(e,a,i,n),i=t.streams.filter(function(e){return e.type==et}).map(function(t){return lm(e,t,n)});var r=t.streams.filter(function(e){return"image"==e.type}).map(function(t){return lm(e,t,n)}),o=t.drmInfo?[t.drmInfo]:[];if(t.drmInfo)for(var s=d(a.values()),c=s.next();!c.done;c=s.next())(c=c.value).audio&&c.audio.encrypted&&(c.audio.drmInfos=o),c.video&&c.video.encrypted&&(c.video.drmInfos=o);return{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,variants:Array.from(a.values()),textStreams:i,imageStreams:r,sequenceMode:t.sequenceMode||!1}}function lm(e,t,n){var a=t.segments.map(function(t){return function(e,t){var n=new om("segment",e.h,e.g,t.dataKey);return new po(t.startTime,t.endTime,function(){return[n.toString()]},0,null,null!=t.initSegmentKey?function(e,t){var n=new om("segment",e.h,e.g,t);return new fo(function(){return[n.toString()]},0,null)}(e,t.initSegmentKey):null,t.timestampOffset,t.appendWindowStart,t.appendWindowEnd,[],t.tilesLayout||"")}(e,t)});return n.Ib(a),{id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},segmentIndex:new vs(a),mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate,pixelAspectRatio:t.pixelAspectRatio,hdr:t.hdr,kind:t.kind,encrypted:t.encrypted,drmInfos:[],keyIds:t.keyIds,language:t.language,label:t.label,type:t.type,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:t.roles,forced:t.forced,channelsCount:t.channelsCount,audioSamplingRate:t.audioSamplingRate,spatialAudio:t.spatialAudio,closedCaptions:t.closedCaptions,tilesLayout:t.tilesLayout}}function um(){this.g=null}function fm(){}function pm(e){var t=sm(e);return t&&"manifest"==t.g?fa(e={uri:e,Ne:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}}):t&&"segment"==t.g?function(e,t){var n=new Qp;return fa(void 0).X(function(){return n.init()}).X(function(){return Jp(n,t.Aa(),t.ja())}).X(function(e){return e.getSegments([t.key()])}).X(function(e){return{uri:t,data:e[0].data,headers:{}}}).finally(function(){return n.destroy()})}(t.key(),t):la(new ke(2,1,9004,e))}function mm(e,t,n){var a,i,r,o,s,c;return M(function(l){switch(l.g){case 1:a=[];for(var u=[],f=d(n),p=f.next();!p.done;p=f.next()){p=p.value;for(var m=!1,_=d(u),h=_.next();!h.done;h=_.next())if(_m((h=h.value).info,p)){h.sessionIds.push(p.sessionId),m=!0;break}m||u.push({info:p,sessionIds:[p.sessionId]})}i=d(u),r=i.next();case 2:if(r.done){l.A(4);break}return o=r.value,s=function(e,t,n){var a,i;return M(function(r){switch(r.g){case 1:return a=new Di({mb:t,onError:function(){},dd:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),D(r,2),a.configure(e),y(r,function(e,t,n,a,i,r){var o=new Map;return(i={audioCapabilities:i,videoCapabilities:r,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t}).drmInfos=[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:a,serverCertificateUri:"",initData:null,keyIds:null}],o.set(t,i),ki(e,o,[])}(a,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:x(r,3);break;case 2:return C(r),y(r,a.destroy(),5);case 5:case 9:return r.return([]);case 3:return D(r,6),y(r,Oi(a),8);case 8:x(r,7);break;case 6:return C(r),y(r,a.destroy(),9);case 7:return i=[],y(r,Promise.all(n.sessionIds.map(function(e){return M(function(t){return 1==t.g?(D(t,2),y(t,function(e,t){var n,a,i;return M(function(r){return 1==r.g?y(r,Mi(e,t),2):3!=r.g?(n=r.h)?(a=[],(i=e.i.get(n))&&(i.Ja=new at,a.push(i.Ja)),a.push(n.remove()),y(r,Promise.all(a),3)):r.return():(e.i.delete(n),void S(r))})}(a,e),4)):2!=t.g?(i.push(e),x(t,0)):(C(t),void S(t))})})),10);case 10:return y(r,a.destroy(),11);case 11:return r.return(i)}})}(e,t,o),y(l,s,5);case 5:c=l.h,a=a.concat(c),r=i.next(),l.A(2);break;case 4:return l.return(a)}})}function _m(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&ne(e.audioCapabilities,t.audioCapabilities,n)&&ne(e.videoCapabilities,t.videoCapabilities,n)}function hm(e,t){var n=dm(new cm(e.Aa(),e.ja()),t),a=t.appMetadata||{};return n=bm(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:a,isIncomplete:t.isIncomplete||!1}}function bm(e){for(var t=[],n=function(e){return e.filter(function(e){return Ln(e)})}(e.variants),a=(n=d(n)).next();!a.done;a=n.next())t.push(In(a.value));for(n=(e=d(e.textStreams)).next();!n.done;n=e.next())t.push(xn(n.value));return t}function gm(){this.g={}}function vm(e,t){var n=t.audio,a=t.video;if(n&&!a&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&a&&(e.g[a.id]=a.bandwidth||t.bandwidth),n&&a){var i=n.bandwidth||393216,r=a.bandwidth||t.bandwidth-i;0>=r&&(r=t.bandwidth),e.g[n.id]=i,e.g[a.id]=r}}function ym(e,t){e.g[t.id]=t.bandwidth||2048}function Sm(e,t){return null==(e=e.g[t])&&(e=0),e}function Dm(e){var t=this;if(e&&e.constructor!=Kc)throw new ke(2,9,9008);this.g=this.h=null,e?(this.h=e.h,this.g=e.jc()):(this.h=Hc(),this.g=new Ia),this.i=[],this.j=[];var n=!e;this.l=new Ma(function(){var e,a,i,r,o;return M(function(s){switch(s.g){case 1:return y(s,Promise.all(t.j.map(function(e){return Fp(e)})),2);case 2:for(e=function(){},a=[],i=d(t.i),r=i.next();!r.done;r=i.next())o=r.value,a.push(o.then(e,e));return y(s,Promise.all(a),3);case 3:if(!n){s.A(4);break}return y(s,t.g.destroy(),4);case 4:t.h=null,t.g=null,S(s)}})})}function Im(){if(st())e:{for(var e=d(Zp.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function xm(e){var t,n,a;return M(function(i){switch(i.g){case 1:return y(i,(t=new Qp).init(),2);case 2:return y(i,Yp(t),3);case 3:return n=i.h,a=new om("manifest",n.path.Aa,n.path.ja,e),y(i,t.destroy(),4);case 4:return y(i,(new Dm).remove(a.toString()),0)}})}function Cm(e,t,n,a,i,r){var o,s,c,l,u,f,p,m,_,h,b;return M(function(g){switch(g.g){case 1:for(o=!1,D(g,2),s=!0,c=d(n.streams),l=c.next();!l.done;l=c.next())for(u=l.value,f=d(u.segments),p=f.next();!p.done;p=f.next())m=p.value,null!=(_=m.pendingSegmentRefId?a[m.pendingSegmentRefId]:null)&&(m.dataKey=_,m.pendingSegmentRefId=void 0),null!=(_=m.pendingInitSegmentRefId?a[m.pendingInitSegmentRefId]:null)&&(m.initSegmentKey=_,m.pendingInitSegmentRefId=void 0),m.pendingSegmentRefId&&(s=!1),m.pendingInitSegmentRefId&&(s=!1);return n.size+=i,s&&(n.isIncomplete=!1),y(g,e.updateManifest(t,n),4);case 4:o=!0,r(),x(g,0);break;case 2:return h=C(g),y(g,xm(t),5);case 5:if(o){g.A(6);break}return b=Object.values(a),y(g,e.removeSegments(b,function(){}),6);case 6:throw h}})}function Om(e){return e.variants.some(function(e){var t=e.audio&&e.audio.encrypted;return e.video&&e.video.encrypted||t})}function wm(e){return e.variants.some(function(e){return(e.video?e.video.drmInfos:[]).concat(e.audio?e.audio.drmInfos:[]).some(function(e){return e.initData&&e.initData.length})})}function Em(e,t){for(var n=[],a=d(e.streams),i=a.next();!i.done;i=a.next())i=i.value,t&&"video"==i.type?n.push({contentType:Vt(i.mimeType,i.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=i.type||n.push({contentType:Vt(i.mimeType,i.codecs),robustness:e.drmInfo.audioRobustness});return n}function Am(e,t,n){return M(function(a){return y(a,function(e,t,n,a){var i,r,o;return M(function(s){return 1==s.g?a.drmInfo?(i=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new ke(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),r=a.sessionIds.map(function(e){return{sessionId:e,keySystem:a.drmInfo.keySystem,licenseUri:a.drmInfo.licenseServerUri,serverCertificate:a.drmInfo.serverCertificate,audioCapabilities:Em(a,!1),videoCapabilities:Em(a,!0)}}),y(s,mm(t,e,r),2)):s.return():3!=s.g?(o=s.h,y(s,i.remove(o),3)):y(s,i.add(r.filter(function(e){return!o.includes(e.sessionId)})),0)})}(e.g,e.h.drm,n,t),0)})}function Lm(e,t,n){function a(){}var i=function(e){for(var t=new Set,n=(e=d(e.streams)).next();!n.done;n=e.next())for(var a=(n=d(n.value.segments)).next();!a.done;a=n.next())null!=(a=a.value).initSegmentKey&&t.add(a.initSegmentKey),t.add(a.dataKey);return Array.from(t)}(n);return hm(t,n),Promise.all([e.removeSegments(i,a),e.removeManifests([t.key()],a)])}function km(e,t,n,a,i,r){var o={id:a.id,originalId:a.originalId,primary:a.primary,type:a.type,mimeType:a.mimeType,codecs:a.codecs,frameRate:a.frameRate,pixelAspectRatio:a.pixelAspectRatio,hdr:a.hdr,kind:a.kind,language:a.language,label:a.label,width:a.width||null,height:a.height||null,encrypted:a.encrypted,keyIds:a.keyIds,segments:[],variantIds:[],roles:a.roles,forced:a.forced,channelsCount:a.channelsCount,audioSamplingRate:a.audioSamplingRate,spatialAudio:a.spatialAudio,closedCaptions:a.closedCaptions,tilesLayout:a.tilesLayout},s=i.offline.numberOfParallelDownloads,c=0;return function(e,t,n){if(null!=(t=e.segmentIndex.find(t)))for(var a=e.segmentIndex.get(t);a;)n(a),a=e.segmentIndex.get(++t)}(a,n.presentationTimeline.Pa(),function(n){var i=kp(n),d=void 0;if(!r.has(i)){var l=n.endTime-n.startTime;l=Sm(t,a.id)*l,l=Tp(e.g,l),r.set(i,new Lp(n,l,c,!1))}n.h&&(d=kp(n.h),r.has(d)||(l=.5*Sm(t,a.id),l=Tp(e.g,l),r.set(d,new Lp(n.h,l,c,!0)))),o.segments.push({pendingInitSegmentRefId:d,initSegmentKey:d?0:null,startTime:n.startTime,endTime:n.endTime,appendWindowStart:n.appendWindowStart,appendWindowEnd:n.appendWindowEnd,timestampOffset:n.timestampOffset,tilesLayout:n.tilesLayout,pendingSegmentRefId:i,dataKey:0}),c=(c+1)%s}),o}function Mm(e){if(e.l.g)throw new ke(2,9,7001)}function Pm(){if(!Im())throw new ke(2,9,9e3)}function Tm(e,t){return M(function(n){return 1==n.g?(e.i.push(t),I(n),y(n,t,4)):2!=n.g?n.return(n.h):(O(n),te(e.i,t),w(n,0))})}function Um(e){for(var t=new Set,n=d(e.textStreams),a=n.next();!a.done;a=n.next())t.add(a.value);for(a=(n=d(e.imageStreams)).next();!a.done;a=n.next())t.add(a.value);for(n=(e=d(e.variants)).next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}h($p,zp),$p.prototype.updateManifestExpiration=function(e,t){var n,a,i,r=this;return M(function(o){return n=jp(r.h,r.g),a=n.store(),i=new at,a.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,a.put(n),i.resolve()):i.reject(new ke(2,9,9012,"Could not find values for "+e))},y(o,Promise.all([n.promise(),i]),0)})},$p.prototype.cc=function(e){var t,n,a,i,r,o;return M(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n)a=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=a-e.periods[n].startTime,r=em(e.periods[n],i),t.push(r);return y(s,Au(t),2)}return o=s.h,s.return({creationTime:0,originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,streams:o,sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata,sequenceMode:!1})})},$p.prototype.xe=function(e){return{data:e.data}},h(nm,zp),nm.prototype.cc=function(e){var t,n,a,i,r,o;return M(function(s){if(1==s.g){for(t=[],n=0;n<e.periods.length;++n){a=n==e.periods.length-1?e.duration:e.periods[n+1].startTime,i=a-e.periods[n].startTime;for(var c=e.periods[n],l=[],u=d(c.streams),f=u.next();!f.done;f=u.next())0!=(f=f.value).variantIds.length&&l.push(am(f,c.startTime,c.startTime+i));r=l,t.push(r)}return y(s,Au(t),2)}return o=s.h,s.return({appMetadata:e.appMetadata,creationTime:0,drmInfo:e.drmInfo,duration:e.duration,expiration:null==e.expiration?1/0:e.expiration,originalManifestUri:e.originalManifestUri,sessionIds:e.sessionIds,size:e.size,streams:o,sequenceMode:!1})})},h(im,zp),(a=im.prototype).hasFixedKeySpace=function(){return!1},a.addSegments=function(e){return this.add(this.i,e)},a.addManifests=function(e){return this.add(this.g,e)},a.updateManifest=function(e,t){return function(e,t,n){var a=(e=jp(e.h,e.g)).store();return a.get(t).onsuccess=function(){a.put(n,t)},e.promise()}(this,e,t)},a.cc=function(e){return null==e.expiration&&(e.expiration=1/0),Promise.resolve(e)},(a=rm.prototype).init=function(){var t=this,n=new at,a=!1,i=new ot(function(){a=!0,n.reject(new ke(2,9,9017))});i.N(2);var r=e.indexedDB.open("shaka_offline_db",5);return r.onsuccess=function(){if(!a){var e=r.result;t.l=e;var o=e.objectStoreNames;o=o.contains("manifest")&&o.contains("segment")?new $p(e,"segment","manifest"):null,t.g=o,o=(o=e.objectStoreNames).contains("manifest-v2")&&o.contains("segment-v2")?new nm(e,"segment-v2","manifest-v2"):null,t.h=o,o=(o=e.objectStoreNames).contains("manifest-v3")&&o.contains("segment-v3")?new nm(e,"segment-v3","manifest-v3"):null,t.i=o,o=(o=e.objectStoreNames).contains("manifest-v5")&&o.contains("segment-v5")?new im(e,"segment-v5","manifest-v5"):null,t.j=o,e=e.objectStoreNames.contains("session-ids")?new qp(e):null,t.m=e,i.stop(),n.resolve()}},r.onupgradeneeded=function(){for(var e=r.result,t=d(["segment-v5","manifest-v5","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},r.onerror=function(e){a||(n.reject(new ke(2,9,9001,r.error)),i.stop(),e.preventDefault())},n},a.destroy=function(){var e=this;return M(function(t){switch(t.g){case 1:if(!e.g){t.A(2);break}return y(t,e.g.destroy(),2);case 2:if(!e.h){t.A(4);break}return y(t,e.h.destroy(),4);case 4:if(!e.i){t.A(6);break}return y(t,e.i.destroy(),6);case 6:if(!e.j){t.A(8);break}return y(t,e.j.destroy(),8);case 8:if(!e.m){t.A(10);break}return y(t,e.m.destroy(),10);case 10:e.l&&e.l.close(),S(t)}})},a.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),this.j&&e.set("v5",this.j),e},a.getEmeSessionCell=function(){return this.m},a.erase=function(){var t=this;return M(function(n){switch(n.g){case 1:if(!t.g){n.A(2);break}return y(n,t.g.destroy(),2);case 2:if(!t.h){n.A(4);break}return y(n,t.h.destroy(),4);case 4:if(!t.i){n.A(6);break}return y(n,t.i.destroy(),6);case 6:if(!t.j){n.A(8);break}return y(n,t.j.destroy(),8);case 8:return t.l&&t.l.close(),y(n,function(){var t=new at,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new ke(2,9,9001,n.error)),e.preventDefault()},t}(),10);case 10:return t.l=null,t.g=null,t.h=null,t.i=null,t.j=null,y(n,t.init(),0)}})},Xp("idb",function(){return _t("CrKey")||dt()||!e.indexedDB?null:new rm}),om.prototype.Aa=function(){return this.i},om.prototype.ja=function(){return this.h},om.prototype.key=function(){return this.l},om.prototype.toString=function(){return this.j},(a=um.prototype).configure=function(){},a.start=function(e,t){var n,a,i,r,o,s,c=this;return M(function(d){switch(d.g){case 1:if(n=sm(e),c.g=n,null==n||"manifest"!=n.g)throw new ke(2,1,9004,e);return a=new Qp,I(d),y(d,a.init(),4);case 4:return y(d,Jp(a,n.Aa(),n.ja()),5);case 5:return y(d,d.h.getManifests([n.key()]),6);case 6:return i=d.h,r=i[0],o=new cm(n.Aa(),n.ja()),s=dm(o,r),t.makeTextStreamsForClosedCaptions(s),d.return(s);case 2:return O(d),y(d,a.destroy(),7);case 7:w(d,0)}})},a.stop=function(){return Promise.resolve()},a.update=function(){},a.onExpirationUpdated=function(e,t){var n,a,i,r,o,s,c,d=this;return M(function(l){switch(l.g){case 1:return n=d.g,a=new Qp,D(l,2,3),y(l,a.init(),5);case 5:return y(l,Jp(a,n.Aa(),n.ja()),6);case 6:return y(l,(i=l.h).getManifests([n.key()]),7);case 7:if(r=l.h,o=r[0],s=o.sessionIds.includes(e),c=null==o.expiration||o.expiration>t,!s||!c){l.A(3);break}return y(l,i.updateManifestExpiration(n.key(),t),3);case 3:return O(l),y(l,a.destroy(),10);case 10:w(l,0);break;case 2:C(l),l.A(3)}})},Yi["application/x-offline-manifest"]=function(){return new um},B("shaka.offline.OfflineScheme",fm),fm.plugin=pm,xa("offline",pm),(a=Dm.prototype).destroy=function(){return this.l.destroy()},a.configure=function(e,t){return 2==arguments.length&&"string"==typeof e&&(e=kc(e,t)),Rc(this.h,e)},a.getConfiguration=function(){var e=Hc();return Rc(e,this.h,Hc()),e},a.jc=function(){return this.g},a.store=function(e,t,n){var a=this,i=this.getConfiguration(),r=new Up(this.g);return this.j.push(r),t=function(e,t,n,a,i,r){var o,s,c,l,u,f,p,m,_,h,b,g,v;return M(function(I){switch(I.g){case 1:return Pm(),s=o=null,c=new Qp,f=u=l=null,D(I,2,3),y(I,a(),5);case 5:return o=I.h,y(I,function(e,t,n,a){var i,r,o,s,c;return M(function(d){if(1==d.g)return i=null,r=e.g,o={networkingEngine:r,modifyManifestRequest:function(){},modifySegmentRequest:function(){},filter:function(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){i=e},isLowLatencyMode:function(){return!1},isAutoLowLatencyMode:function(){return!1},enableLowLatencyMode:function(){},updateDuration:function(){},newDrmInfo:function(){}},n.configure(a.manifest),Mm(e),y(d,n.start(t,o),2);if(3!=d.g)return s=d.h,Mm(e),c=Um(s),y(d,Promise.all(Ha(c,function(e){return e.createSegmentIndex()})),3);if(Mm(e),i)throw i;return d.return(s)})}(e,t,o,i),6);case 6:if(p=I.h,Mm(e),p.presentationTimeline.T()||p.presentationTimeline.lb())throw new ke(2,9,9005,t);return y(I,function(e,t,n,a){var i;return M(function(r){switch(r.g){case 1:return(i=new Di({mb:e.g,onError:n,dd:function(){},onExpirationUpdated:function(){},onEvent:function(){}})).configure(a.drm),y(r,function(e,t,n){return e.da=!0,e.B=[],e.L=n,xi(e,t)}(i,t.variants,a.offline.usePersistentLicense),2);case 2:return y(r,Oi(i),3);case 3:return y(r,wi(i),4);case 4:return r.return(i)}})}(e,p,function(e){f=f||e},i),7);case 7:if(s=I.h,Mm(e),f)throw f;return y(I,function(e,t){var n,a,i,r,o,s,c,l,u,f,p,m,_,h,b,g,v,I,O,w,E,A,L,k,P,T,U,F;return M(function(M){switch(M.g){case 1:return n={width:1/0,height:1/0},function(e,t,n){e.variants=e.variants.filter(function(e){return mn(e,t,n)})}(e,t.restrictions,n),y(M,hn(e,t.offline.usePersistentLicense),2);case 2:for(a=[],i=t.preferredAudioChannelCount,r=t.preferredDecodingAttributes,o=t.preferredVideoCodecs,s=t.preferredAudioCodecs,un(e,o,s,i,r),c=d(e.variants),l=c.next();!l.done;l=c.next())u=l.value,a.push(In(u));for(f=d(e.textStreams),p=f.next();!p.done;p=f.next())m=p.value,a.push(xn(m));for(_=d(e.imageStreams),h=_.next();!h.done;h=_.next())b=h.value,a.push(Cn(b));return y(M,t.offline.trackSelectionCallback(a),3);case 3:for(g=M.h,v=e.presentationTimeline.getDuration(),I=0,O=d(g),w=O.next();!w.done;w=O.next())E=w.value,A=E.bandwidth*v/8,I+=A;return D(M,4),y(M,t.offline.downloadSizeCallback(I),6);case 6:if(!M.h)throw new ke(2,9,9014);x(M,5);break;case 4:if((L=C(M))instanceof ke)throw L;throw new ke(2,9,9015);case 5:for(k=new Set,P=new Set,T=new Set,U=d(g),w=U.next();!w.done;w=U.next())"variant"==(F=w.value).type&&k.add(F.id),"text"==F.type&&P.add(F.id),"image"==F.type&&T.add(F.id);e.variants=e.variants.filter(function(e){return k.has(e.id)}),e.textStreams=e.textStreams.filter(function(e){return P.has(e.id)}),e.imageStreams=e.imageStreams.filter(function(e){return T.has(e.id)}),function(e){e.variants.map(function(e){return e.video});var t=new Set(e.variants.map(function(e){return e.audio}));e=e.textStreams;for(var n=d(t),a=n.next();!a.done;a=n.next())for(var i=(a=d(t)).next();!i.done;i=a.next());for(n=(t=d(e)).next();!n.done;n=t.next())for(a=(n=d(e)).next();!a.done;a=n.next());}(e),S(M)}})}(p,i),8);case 8:return y(I,c.init(),9);case 9:return Mm(e),y(I,Yp(c),10);case 10:return l=I.h,Mm(e),m=function(e,t,n,a,i,r){var o=function(e,t,n){return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:t=bm(t),appMetadata:n,isIncomplete:!1}}(n,t,a),s=i.offline.progressCallback;!function(e,t,n){e.m=function(e,t){o.size=t,s(o,e)},e.l=n}(r,0,function(t,n){c&&i.offline.usePersistentLicense&&l==n&&Ei(e,"cenc",t)});var c=Om(t)&&!wm(t),l=null;c&&(l=Fm.get(e.g.keySystem));for(var u=new gm,f=d(t.textStreams),p=f.next();!p.done;p=f.next())u.g[p.value.id]=52;for(p=(f=d(t.imageStreams)).next();!p.done;p=f.next())ym(u,p.value);for(f=(p=d(t.variants)).next();!f.done;f=p.next())vm(u,f.value);return u=function(e,t,n,a){for(var i=new Map,r=Um(n),o=new Map,s=(r=d(r)).next();!s.done;s=r.next()){var c=km(e,t,n,s=s.value,a,i);o.set(s.id,c)}for(t=(e=d(n.variants)).next();!t.done;t=e.next())(t=t.value).audio&&o.get(t.audio.id).variantIds.push(t.id),t.video&&o.get(t.video.id).variantIds.push(t.id);return{streams:Array.from(o.values()),ne:Array.from(i.values())}}(r,u,t,i),r=u.streams,u=u.ne,p=e.g,f=i.offline.usePersistentLicense,p&&f&&(p.initData=[]),{$f:{creationTime:Date.now(),originalManifestUri:n,duration:t.presentationTimeline.getDuration(),size:0,expiration:e.ic(),streams:r,sessionIds:f?Li(e):[],drmInfo:p,appMetadata:a,isIncomplete:!0,sequenceMode:t.sequenceMode},ne:u}}(s,p,t,n,i,r),_=m.$f,h=m.ne,y(I,l.ja.addManifests([_]),11);case 11:if(b=I.h,Mm(e),u=b[0],Mm(e),f)throw f;return y(I,function(e,t,n,a,i,r,o,s,c){var l,u,f,p,m,_,h,b,g,v;return M(function(I){switch(I.g){case 1:if(l={},u=0,f=function(t,f){var p,m,_,h,b,g,v;return M(function(D){if(1==D.g){for(p={},m=d(t),_=m.next();!_.done;p={eb:p.eb},_=m.next())p.eb=_.value,h=Mp(p.eb,r),b=p.eb.i,g=p.eb.h,v=function(t){return function(n){var a,i,r;return M(function(s){if(1==s.g)return y(s,o.addSegments([{data:n}]),2);a=s.h,Mm(e),i=t.eb.g,r=kp(i),l[r]=a[0],u+=n.byteLength,S(s)})}}(p),Hp(i,p.eb.groupId,h,b,g,v);return y(D,function(e){return M(function(t){return 1==t.g?y(t,Promise.all(e.j.values()),2):t.return(e.g.h)})}(i),2)}return f?(Mm(e),function(e,t,n,a){if(t.expiration=n.ic(),n=Li(n),t.sessionIds=a.offline.usePersistentLicense?n:[],Om(e)&&a.offline.usePersistentLicense&&!n.length)throw new ke(2,9,9007)}(s,a,c,r),y(D,o.updateManifest(n,a),0)):D.A(0)})},p=!1,D(I,2),!Om(s)||!p||wm(s)){I.A(4);break}return y(I,f(t.filter(function(e){return e.h}),!0),5);case 5:return Mm(e),t=t.filter(function(e){return!e.h}),m=l,_=u,l={},u=0,y(I,Cm(o,n,a,m,_,function(){return Mm(e)}),6);case 6:Mm(e);case 4:if(p){I.A(7);break}return y(I,f(t,!1),8);case 8:return Mm(e),h=l,b=u,l={},u=0,y(I,Cm(o,n,a,h,b,function(){return Mm(e)}),9);case 9:Mm(e);case 7:x(I,0);break;case 2:return g=C(I),v=Object.values(l),y(I,o.removeSegments(v,function(){}),10);case 10:throw g}})}(e,h,u,_,r,i,l.ja,p,s),12);case 12:return Mm(e),g=new om("manifest",l.path.Aa,l.path.ja,u),I.return(hm(g,_));case 3:return O(I),y(I,c.destroy(),13);case 13:if(!o){I.A(14);break}return y(I,o.stop(),14);case 14:if(!s){I.A(16);break}return y(I,s.destroy(),16);case 16:w(I,0);break;case 2:if(v=C(I),null==u){I.A(18);break}return y(I,xm(u),18);case 18:throw f||v}})}(this,e,t||{},function(){var t;return M(function(r){return 1==r.g?y(r,Wi(e,a.g,i.manifest.retryParameters,n||null),2):(t=r.h,r.return(t()))})},i,r),(t=new da(t,function(){return Fp(r)})).finally(function(){te(a.j,r)}),function(e,t){var n=t.promise;return e.i.push(n),t.finally(function(){te(e.i,n)})}(this,t)},a.remove=function(e){return Tm(this,function(e,t){var n,a,i,r,o,s;return M(function(c){switch(c.g){case 1:if(Pm(),null==(n=sm(t))||"manifest"!=n.g)throw new ke(2,9,9004,t);return a=n,i=new Qp,I(c),y(c,i.init(),4);case 4:return y(c,Jp(i,a.Aa(),a.ja()),5);case 5:return y(c,(r=c.h).getManifests([a.key()]),6);case 6:return o=c.h,s=o[0],y(c,Promise.all([Am(e,s,i),Lm(r,a,s)]),2);case 2:return O(c),y(c,i.destroy(),8);case 8:w(c,0)}})}(this,e))},a.og=function(){return Tm(this,function(e){var t,n,a,i,r,o,s,c,l,u;return M(function(f){switch(f.g){case 1:return Pm(),t=e.g,n=e.h.drm,a=new Qp,i=!1,I(f),y(f,a.init(),4);case 4:r=[],function(e,t){e.g.forEach(function(e){var t;t=e.getEmeSessionCell(),r.push(t)})}(a),o=d(r),s=o.next();case 5:if(s.done){f.A(2);break}return y(f,(c=s.value).getAll(),8);case 8:return l=f.h,y(f,mm(n,t,l),9);case 9:return u=f.h,y(f,c.remove(u),10);case 10:u.length!=l.length&&(i=!0),s=o.next(),f.A(5);break;case 2:return O(f),y(f,a.destroy(),11);case 11:w(f,3);break;case 3:return f.return(!i)}})}(this))},a.list=function(){return Tm(this,M(function(a){switch(a.g){case 1:return Pm(),e=[],t=new Qp,I(a),y(a,t.init(),4);case 4:return n=Promise.resolve(),function(e,t){e.g.forEach(function(e,n){e.getCells().forEach(function(e,a){t({Aa:n,ja:a},e)})})}(t,function(t,a){n=n.then(function(){return M(function(n){if(1==n.g)return y(n,a.getAllManifests(),2);n.h.forEach(function(n,a){n=hm(new om("manifest",t.Aa,t.ja,a),n),e.push(n)}),S(n)})})}),y(a,n,2);case 2:return O(a),y(a,t.destroy(),6);case 6:w(a,3);break;case 3:return a.return(e)}}));var e,t,n},B("shaka.offline.Storage",Dm),Dm.deleteAll=function(){var e;return M(function(t){return 1==t.g?(e=new Qp,I(t),y(t,function(e){var t,n;return M(function(a){return 1==a.g?(t=Array.from(e.g.values()),(n=0<t.length)||Zp.forEach(function(e){(e=e())&&t.push(e)}),y(a,Promise.all(t.map(function(e){return e.erase()})),2)):n?a.A(0):y(a,Promise.all(t.map(function(e){return e.destroy()})),0)})}(e),2)):5!=t.g?(O(t),y(t,e.destroy(),5)):w(t,0)})},Dm.prototype.list=Dm.prototype.list,Dm.prototype.removeEmeSessions=Dm.prototype.og,Dm.prototype.remove=Dm.prototype.remove,Dm.prototype.store=Dm.prototype.store,Dm.prototype.getNetworkingEngine=Dm.prototype.jc,Dm.prototype.getConfiguration=Dm.prototype.getConfiguration,Dm.prototype.configure=Dm.prototype.configure,Dm.prototype.destroy=Dm.prototype.destroy,Dm.support=Im;var Fm=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");function Hm(){}function Rm(e,t){for(e={priority:t||0,lf:e},t=0;t<Nm.length;t++)if(Nm[t].priority<e.priority)return void Nm.splice(t,0,e);Nm.push(e)}Wd.offline=Im,B("shaka.polyfill",Hm),Hm.register=Rm,Hm.installAll=function(){for(var e=d(Nm),t=e.next();!t.done;t=e.next()){t=t.value;try{t.lf()}catch(e){W("Error installing polyfill!",e)}}};var Nm=[];function Bm(){this.g=new Vm}function jm(){e.AbortController||(e.AbortController=Bm,e.AbortSignal=Vm)}function Vm(){ga.call(this),this.h=!1,this.g=void 0,this.onabort=null}function zm(){}function Gm(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var e=d(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),t=e.next();!t.done;t=e.next())Km(t.value)}function Km(e){var t="aria-"+e.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,e,{get:function(){return this.getAttribute(t)},set:function(e){null==e||null==e?this.removeAttribute(t):this.setAttribute(t,e)}})}function Wm(){}function qm(){Mb()}function Qm(){}function Ym(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Jm),document.addEventListener("webkitfullscreenerror",Jm),document.addEventListener("mozfullscreenchange",Jm),document.addEventListener("mozfullscreenerror",Jm),document.addEventListener("MSFullscreenChange",Jm),document.addEventListener("MSFullscreenError",Jm)}}function Jm(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),n=document.createEvent("Event");n.initEvent(t,e.bubbles,e.cancelable),e.target.dispatchEvent(n)}function Xm(){}function Zm(){var e=!0;(ft()||_t("PlayStation 5")||pt()||_t("Web0S")||lt()||_t("CrKey")||_t("PC=EOS"))&&(e=!1),e&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),o_=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=$m)}function $m(t){var n,a,i,r,o,s,c,d,l,u;return M(function(f){switch(f.g){case 1:if(n={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:t},!t)return f.return(n);if(a=t.video,i=t.audio,"media-source"==t.type){if(!st())return f.return(n);if(a){if(_t("CrKey")){if(!e.cast)throw new ke(2,8,8e3);if(cast.__platform__&&cast.__platform__.canDisplayType){var p=a.contentType;a.width&&a.height&&(p+="; width="+a.width+"; height="+a.height),a.framerate&&(p+="; framerate="+a.framerate),"pq"===a.transferFunction&&(p+="; eotf=smpte2084"),p=cast.__platform__.canDisplayType(p)}else p=Z(a.contentType)}else p=Z(a.contentType);if(!p)return f.return(n)}if(i&&!Z(i.contentType))return f.return(n)}else{if("file"!=t.type)return f.return(n);if(a&&!ct(a.contentType)||i&&!ct(i.contentType))return f.return(n)}return t.keySystemConfiguration?(r=t.keySystemConfiguration,o=[],s=[],r.audio&&(c={robustness:r.audio.robustness||"",contentType:t.audio.contentType},o.push(c)),r.video&&(d={robustness:r.video.robustness||"",contentType:t.video.contentType},s.push(d)),l={initDataTypes:[r.initDataType],distinctiveIdentifier:r.distinctiveIdentifier,persistentState:r.persistentState,sessionTypes:r.sessionTypes},o.length&&(l.audioCapabilities=o),s.length&&(l.videoCapabilities=s),D(f,3),y(f,navigator.requestMediaKeySystemAccess(r.keySystem,[l]),5)):(n.supported=!0,f.return(Promise.resolve(n)));case 5:u=f.h,x(f,4);break;case 3:C(f);case 4:u&&(n.supported=!0,n.keySystemAccess=u);case 2:return f.return(n)}})}Bm.prototype.abort=function(e){var t=this.g;t.h||(t.h=!0,t.g=e,void 0===t.g&&(t.g=new DOMException("signal is aborted without reason","AbortError")),e=new _a("abort"),t.onabort&&t.onabort(e),t.dispatchEvent(e))},o.Object.defineProperties(Bm.prototype,{signal:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Hm.AbortController=Bm,Bm.install=jm,h(Vm,ga),o.Object.defineProperties(Vm.prototype,{aborted:{configurable:!0,enumerable:!0,get:function(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function(){return this.g}}}),Rm(jm),Hm.Aria=zm,zm.install=Gm,Rm(Gm),Hm.EncryptionScheme=Wm,Wm.install=qm,Rm(qm,-2),Hm.Fullscreen=Qm,Qm.install=Ym,Rm(Ym),Hm.MediaCapabilities=Xm,Xm.install=Zm;var e_,t_,n_,a_,i_,r_,o_=null;function s_(){}function c_(){var t=mt();e.MediaSource&&(e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */);return n.shift(),n.some(function(e){return e.startsWith("codecs=")})?cast.__platform__.canDisplayType(t):e(t)}}():t?12>=t?(d_(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):d_():(_t("Tizen 2")||_t("Tizen 3")||_t("Tizen 4"))&&function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=Wt(t)[0]&&e(t)}}()),e.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function(){var e=MediaSource.isTypeSupported;_t("Web0S")||(MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */),a=n.findIndex(function(e){return e.startsWith("codecs=")});if(0>a)return e(t);var i=n[a].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),r=i.findIndex(function(e){return e.startsWith("vp09")});return 0<=r&&(i[r]="vp9",n[a]='codecs="'+i.join(",")+'"',t=n.join("; ")),e(t)})}()}function d_(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var t=e.apply(this,P.apply(0,arguments));return t.abort=function(){},t}}function l_(){}function u_(){screen.orientation||null!=e.orientation&&function(){function t(){switch(e.orientation){case-90:n.type="landscape-secondary",n.angle=270;break;case 0:n.type="portrait-primary",n.angle=0;break;case 90:n.type="landscape-primary",n.angle=90;break;case 180:n.type="portrait-secondary",n.angle=180}}var n=new f_;screen.orientation=n,t(),e.addEventListener("orientationchange",function(){t();var e=new _a("change");n.dispatchEvent(e)})}()}function f_(){ga.call(this),this.type="",this.angle=0}function p_(){}function m_(e,t){try{var n=new b_(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function __(e){var t=this.mediaKeys;return t&&t!=e&&v_(t,null),delete this.mediaKeys,(this.mediaKeys=e)?v_(e,this):Promise.resolve()}function h_(e){if(Ae(e=Ee(e.initData)).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=It(e=St(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=we(e),this.dispatchEvent(t)}function b_(e,t){if(this.keySystem=e,e.startsWith("com.apple.fps"))for(t=(e=d(t)).next();!t.done;t=e.next()){var n=t.value;if("required"==n.persistentState)t=null;else{t={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:n.initDataTypes,sessionTypes:["temporary"],label:n.label};var a=!1,i=!1;if(n.audioCapabilities)for(var r=d(n.audioCapabilities),o=r.next();!o.done;o=r.next())(o=o.value).contentType&&(a=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,o.contentType.split(";")[0])&&(t.audioCapabilities.push(o),i=!0));if(n.videoCapabilities)for(o=(n=d(n.videoCapabilities)).next();!o.done;o=n.next())(r=o.value).contentType&&(a=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,r.contentType.split(";")[0])&&(t.videoCapabilities.push(r),i=!0));a||(i=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),t=i?t:null}if(t)return void(this.g=t)}throw(e=Error("Unsupported keySystem")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function g_(e){this.h=new WebKitMediaKeys(e),this.g=new Ta}function v_(e,t){if(e.g.pb(),!t)return Promise.resolve();e.g.C(t,"webkitneedkey",h_);try{return rs(t,HTMLMediaElement.HAVE_METADATA,e.g,function(){t.webkitSetMediaKeys(e.h)}),Promise.resolve()}catch(e){return Promise.reject(e)}}function y_(e){ga.call(this),this.i=null,this.l=e,this.g=this.h=null,this.j=new Ta,this.sessionId="",this.expiration=NaN,this.closed=new at,this.keyStatuses=new D_}function S_(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new _a("keystatuseschange"),e.dispatchEvent(t)}function D_(){this.size=0,this.g=void 0}function I_(){}function x_(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=C_,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=O_,e.MediaKeys=w_,e.MediaKeySystemAccess=E_,e.shakaMediaKeysPolyfill=!0)}function C_(){return Promise.reject(Error("The key system specified is not supported."))}function O_(e){return null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function w_(){throw new TypeError("Illegal constructor.")}function E_(){throw this.keySystem="",new TypeError("Illegal constructor.")}function A_(){}function L_(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)z_="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=M_,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=P_,e.MediaKeys=U_,e.MediaKeySystemAccess=T_,e.shakaMediaKeysPolyfill=!0}}function k_(e){return z_?z_+e.charAt(0).toUpperCase()+e.slice(1):e}function M_(e,t){try{var n=new T_(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function P_(e){var t=this.mediaKeys;return t&&t!=e&&F_(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&F_(e,this),Promise.resolve()}function T_(e,t){this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var a=!1,i=document.getElementsByTagName("video");i=i.length?i[0]:document.createElement("video");for(var r=(t=d(t)).next();!r.done;r=t.next()){var o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(r=r.value).initDataTypes,sessionTypes:["temporary"],label:r.label},s=!1;if(r.audioCapabilities)for(var c=d(r.audioCapabilities),l=c.next();!l.done;l=c.next())(l=l.value).contentType&&(s=!0,i.canPlayType(l.contentType.split(";")[0],this.g)&&(o.audioCapabilities.push(l),a=!0));if(r.videoCapabilities)for(l=(c=d(r.videoCapabilities)).next();!l.done;l=c.next())(l=l.value).contentType&&(s=!0,i.canPlayType(l.contentType,this.g)&&(o.videoCapabilities.push(l),a=!0));if(s||(a=i.canPlayType("video/mp4",this.g)||i.canPlayType("video/webm",this.g)),"required"==r.persistentState&&(n?(o.persistentState="required",o.sessionTypes=["persistent-license"]):a=!1),a)return void(this.h=o)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(e=Error(n)).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,e}function U_(e){this.l=e,this.h=null,this.g=new Ta,this.i=[],this.j=new Map}function F_(e,t){e.h=t,e.g.pb();var n=z_;t&&(e.g.C(t,n+"needkey",function(t){var n=new CustomEvent("encrypted");n.initDataType="cenc",n.initData=we(t.initData),e.h.dispatchEvent(n)}),e.g.C(t,n+"keymessage",function(t){var n=H_(e,t.sessionId);n&&(t=new _a("message",t=(new Map).set("messageType",null==n.keyStatuses.Eb()?"licenserequest":"licenserenewal").set("message",t.message)),n.h&&(n.h.resolve(),n.h=null),n.dispatchEvent(t))}),e.g.C(t,n+"keyadded",function(t){(t=H_(e,t.sessionId))&&(j_(t,"usable"),t.g&&t.g.resolve(),t.g=null)}),e.g.C(t,n+"keyerror",function(t){var n=H_(e,t.sessionId);n&&n.handleError(t)}))}function H_(e,t){var n=e.j.get(t);return n||((n=e.i.shift())?(n.sessionId=t,e.j.set(t,n),n):null)}function R_(e,t,n){ga.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new at,this.keyStatuses=new V_}function N_(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var a=Ee(It("LOAD_SESSION|"+n));else{var i=It("PERSISTENT|");a=Mt(i,t)}else a=Ee(t)}catch(e){return Promise.reject(e)}e.h=new at;var r=k_("generateKeyRequest");try{e.j[r](e.i,a)}catch(t){if("InvalidStateError"!=t.name)return e.h=null,Promise.reject(t);new ot(function(){try{e.j[r](e.i,a)}catch(t){e.h.reject(t),e.h=null}}).N(.01)}return e.h}function B_(e,t,n){if(e.g)e.g.then(function(){return B_(e,t,n)}).catch(function(){return B_(e,t,n)});else{if(e.g=t,"webkit-org.w3.clearkey"==e.i){var a=yt(n),i=JSON.parse(a);"oct"!=i.keys[0].kty&&(e.g.reject(Error("Response is not a valid JSON Web Key Set.")),e.g=null),a=At(i.keys[0].k),i=At(i.keys[0].kid)}else a=Ee(n),i=null;var r=k_("addKey");try{e.j[r](e.i,a,i,e.sessionId)}catch(t){e.g.reject(t),e.g=null}}}function j_(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,t=new _a("keystatuseschange"),e.dispatchEvent(t)}function V_(){this.size=0,this.g=void 0}Xm.originalMcap=o_,Rm(Zm,-1),Hm.MediaSource=s_,s_.install=c_,Rm(c_),Hm.Orientation=l_,l_.install=u_,h(f_,ga),f_.prototype.lock=function(e){function t(e){return screen.lockOrientation?screen.lockOrientation(e):screen.mozLockOrientation?screen.mozLockOrientation(e):!!screen.msLockOrientation&&screen.msLockOrientation(e)}var n=!1;switch(e){case"natural":n=t("default");break;case"any":n=!0,this.unlock();break;default:n=t(e)}return n?Promise.resolve():((e=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",e.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(e))},f_.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Rm(u_),Hm.PatchedMediaKeysApple=p_,p_.uninstall=function(){e_&&(e_=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",t_),HTMLMediaElement.prototype.setMediaKeys=n_,e.MediaKeys=a_,e.MediaKeySystemAccess=i_,navigator.requestMediaKeySystemAccess=r_,t_=r_=n_=i_=a_=null,e.shakaMediaKeysPolyfill=!1)},p_.install=function(t){e.HTMLVideoElement&&e.WebKitMediaKeys&&(void 0!==t&&t&&(e_=!0,t_=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),n_=HTMLMediaElement.prototype.setMediaKeys,a_=e.MediaKeys,i_=e.MediaKeySystemAccess,r_=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=__,e.MediaKeys=g_,e.MediaKeySystemAccess=b_,navigator.requestMediaKeySystemAccess=m_,e.shakaMediaKeysPolyfill=!0)},b_.prototype.createMediaKeys=function(){var e=new g_(this.keySystem);return Promise.resolve(e)},b_.prototype.getConfiguration=function(){return this.g},g_.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new y_(this.h,e)},g_.prototype.setServerCertificate=function(){return Promise.resolve(!1)},h(y_,ga),(a=y_.prototype).generateRequest=function(e,t){var n=this;this.h=new at;try{var a=this.l.createSession("video/mp4",Ee(t));this.i=a,this.sessionId=a.sessionId||"",this.j.C(this.i,"webkitkeymessage",function(e){n.h&&(n.h.resolve(),n.h=null),e=new _a("message",e=(new Map).set("messageType",null==n.keyStatuses.Eb()?"license-request":"license-renewal").set("message",we(e.message))),n.dispatchEvent(e)}),this.j.C(a,"webkitkeyadded",function(){n.g&&(S_(n,"usable"),n.g.resolve(),n.g=null)}),this.j.C(a,"webkitkeyerror",function(){var e=Error("EME PatchedMediaKeysApple key error");if(e.errorCode=n.i.error,null!=n.h)n.h.reject(e),n.h=null;else if(null!=n.g)n.g.reject(e),n.g=null;else switch(n.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:S_(n,"output-not-allowed");break;default:S_(n,"internal-error")}}),S_(this,"status-pending")}catch(e){this.h.reject(e)}return this.h},a.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},a.update=function(e){this.g=new at;try{this.i.update(Ee(e))}catch(e){this.g.reject(e)}return this.g},a.close=function(){try{this.i.close(),this.closed.resolve(),this.j.pb()}catch(e){this.closed.reject(e)}return this.closed},a.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(a=D_.prototype).Eb=function(){return this.g},a.forEach=function(e){this.g&&e(this.g,Gi.value())},a.get=function(e){if(this.has(e))return this.g},a.has=function(e){var t=Gi.value();return!(!this.g||!Ce(e,t))},a.entries=function(){},a.keys=function(){},a.values=function(){},Hm.PatchedMediaKeysNop=I_,I_.install=x_,w_.prototype.createSession=function(){},w_.prototype.setServerCertificate=function(){},E_.prototype.getConfiguration=function(){},E_.prototype.createMediaKeys=function(){},Rm(x_,-10),Hm.PatchedMediaKeysWebkit=A_,A_.install=L_,T_.prototype.createMediaKeys=function(){var e=new U_(this.g);return Promise.resolve(e)},T_.prototype.getConfiguration=function(){return this.h},U_.prototype.createSession=function(e){if("temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new R_(t,this.l,e),this.i.push(e),e},U_.prototype.setServerCertificate=function(){return Promise.resolve(!1)},h(R_,ga),(a=R_.prototype).handleError=function(e){var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.h?(45==e.systemCode&&(t.message="Unsupported session type."),this.h.reject(t),this.h=null):e.sessionId&&this.g?(this.g.reject(t),this.g=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?j_(this,"output-restricted"):j_(this,1==t?"expired":"internal-error"))},a.generateRequest=function(e,t){return N_(this,t,null)},a.load=function(e){return"persistent-license"==this.l?N_(this,null,e):Promise.reject(Error("Not a persistent session."))},a.update=function(e){var t=new at;return B_(this,t,e),t},a.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=k_("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},a.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(a=V_.prototype).Eb=function(){return this.g},a.forEach=function(e){this.g&&e(this.g,Gi.value())},a.get=function(e){if(this.has(e))return this.g},a.has=function(e){var t=Gi.value();return!(!this.g||!Ce(e,t))},a.entries=function(){},a.keys=function(){},a.values=function(){};var z_="";function G_(){}function K_(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=q_,Object.defineProperty(t,"disablePictureInPicture",{get:Y_,set:J_,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Q_,document.addEventListener("webkitpresentationmodechanged",W_,!0))}}function W_(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function q_(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Q_(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Y_(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function J_(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function X_(){}function Z_(){e.crypto&&("randomUUID"in e.crypto||(e.crypto.randomUUID=$_))}function $_(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}function eh(){}function th(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=nh)}function nh(){return new Promise(function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,n){e({usage:t,quota:n})},t)})}function ah(){}function ih(){var e=Symbol.prototype;"description"in e||Object.defineProperty(e,"description",{get:rh})}function rh(){var e=/\((.*)\)/.exec(this.toString());return e?e[1]:void 0}function oh(){}function sh(){if(e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch(function(){}),e}}}function ch(){}function dh(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in t||ut())&&(t.getVideoPlaybackQuality=lh)}}function lh(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function uh(){}function fh(){if(!e.VTTCue&&e.TextTrackCue){var t=null,n=TextTrackCue.length;if(3==n)t=ph;else if(6==n)t=mh;else{try{var a=!!ph(1,2,"")}catch(e){a=!1}a&&(t=ph)}t&&(e.VTTCue=function(e,n,a){return t(e,n,a)})}}function ph(t,n,a){return new e.TextTrackCue(t,n,a)}function mh(t,n,a){return new e.TextTrackCue(t+"-"+n+"-"+a,t,n,a)}function _h(){}Rm(L_),Hm.PiPWebkit=G_,G_.install=K_,Rm(K_),Hm.RandomUUID=X_,X_.install=Z_,Rm(Z_),Hm.StorageEstimate=eh,eh.install=th,Rm(th),Hm.Symbol=ah,ah.install=ih,Rm(ih),Hm.VideoPlayPromise=oh,oh.install=sh,Rm(sh),Hm.VideoPlaybackQuality=ch,ch.install=dh,Rm(dh),Hm.VTTCue=uh,uh.install=fh,Rm(fh),_h.prototype.parseInit=function(){},_h.prototype.setSequenceMode=function(){},_h.prototype.parseMedia=function(e,t){for(var n=null,a=[],i=(e=d(e=yt(e).split(/\r?\n/))).next();!i.done;i=e.next())if((i=i.value)&&!/^\s+$/.test(i)&&(i=hh.exec(i))){var r=bh.exec(i[1]);i=new ie(r=60*parseInt(r[1],10)+parseFloat(r[2].replace(",",".")),t.segmentEnd?t.segmentEnd:r+2,i[2]),n&&(n.endTime=r,a.push(n)),n=i}return n&&a.push(n),a},B("shaka.text.LrcTextParser",_h),_h.prototype.parseMedia=_h.prototype.parseMedia,_h.prototype.setSequenceMode=_h.prototype.setSequenceMode,_h.prototype.parseInit=_h.prototype.parseInit;var hh=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,bh=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function gh(){}function vh(e,t,n,a,i,r,o,s,c,l,u){var f=e.parentNode;if(e.nodeType==Node.COMMENT_NODE)return null;if(e.nodeType==Node.TEXT_NODE){if(!u)return null;var p=document.createElement("span");p.textContent=e.textContent}else p=e;for(var m=null,_=d(Kh),h=_.next();!h.done&&!(m=Ch(p,"backgroundImage",a,"#",h.value)[0]);h=_.next());if(_=u,("p"==e.nodeName||m)&&(u=!0),s="default"==(p.getAttribute("xml:space")||(s?"default":"preserve")),e=[],!(h=Array.from(p.childNodes).every(function(e){return e.nodeType==Node.TEXT_NODE})))for(var b=d(p.childNodes),g=b.next();!g.done;g=b.next())(g=vh(g.value,t,n,a,i,r,o,s,c,p,u))&&e.push(g);a=null!=l,b=/\S/.test(p.textContent);var v=p.hasAttribute("begin")||p.hasAttribute("end")||p.hasAttribute("dur");if(!(v||b||"br"==p.tagName||0!=e.length||a&&!s))return null;for(b=(g=wh(p,n)).start,g=g.end;f&&f.nodeType==Node.ELEMENT_NODE&&"tt"!=f.tagName;)b=(g=Oh(f,n,b,g)).start,g=g.end,f=f.parentNode;if(null==b&&(b=0),b+=t.periodStart,g=null==g?1/0:g+t.periodStart,b=Math.max(b,t.segmentStart),g=Math.min(g,t.segmentEnd),!v&&0<e.length)for(b=1/0,g=0,n=(t=d(e)).next();!n.done;n=t.next())n=n.value,b=Math.min(b,n.startTime),g=Math.max(g,n.endTime);if("br"==p.tagName)return(i=new ie(b,g,"")).lineBreak=!0,i;if(t="",h&&(t=p.textContent,s&&(t=(t=t.trim()).replace(/\s+/g," "))),(t=new ie(b,g,t)).nestedCues=e,u||(t.isContainer=!0),c&&(t.cellResolution=c),c=Ch(p,"region",r,"")[0],p.hasAttribute("region")&&c&&c.getAttribute("xml:id")){var y=c.getAttribute("xml:id");t.region=o.filter(function(e){return e.id==y})[0]}return o=c,l&&a&&!p.getAttribute("region")&&!p.getAttribute("style")&&(o=Ch(l,"region",r,"")[0]),function(e,t,n,a,i,r,o){if("rtl"==Sh(t,n,i,"direction",r=r||o)&&(e.direction="rtl"),"tb"==(o=Sh(t,n,i,"writingMode",r))||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=ue),(o=Sh(t,n,i,"textAlign",!0))?(e.positionAlign=Vh[o],e.lineAlign=jh[o],e.textAlign=ce[o.toUpperCase()]):e.textAlign=se,(o=Sh(t,n,i,"displayAlign",!0))&&(e.displayAlign=le[o.toUpperCase()]),(o=Sh(t,n,i,"color",r))&&(e.color=o),(o=Sh(t,n,i,"backgroundColor",r))&&(e.backgroundColor=o),(o=Sh(t,n,i,"border",r))&&(e.border=o),o=Sh(t,n,i,"fontFamily",r))switch(o){case"monospaceSerif":e.fontFamily="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":e.fontFamily="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":e.fontFamily="sans-serif";break;case"monospaceSansSerif":e.fontFamily="Consolas,monospace";break;case"proportionalSerif":e.fontFamily="serif";break;default:e.fontFamily=o}if((o=Sh(t,n,i,"fontWeight",r))&&"bold"==o&&(e.fontWeight=700),o=Sh(t,n,i,"wrapOption",r),e.wrapLine=!o||"noWrap"!=o,(o=Sh(t,n,i,"lineHeight",r))&&o.match(Ph)&&(e.lineHeight=o),(o=Sh(t,n,i,"fontSize",r))&&(o.match(Ph)||o.match(Mh))&&(e.fontSize=o),(o=Sh(t,n,i,"fontStyle",r))&&(e.fontStyle=ye[o.toUpperCase()]),a){o=a.getAttribute("imageType")||a.getAttribute("imagetype");var s=a.getAttribute("encoding");a=a.textContent.trim(),"PNG"==o&&"Base64"==s&&a&&(e.backgroundImage="data:image/png;base64,"+a)}(a=Sh(t,n,i,"textOutline",r))&&((a=a.split(" "))[0].match(Ph)?e.textStrokeColor=e.color:(e.textStrokeColor=a[0],a.shift()),a[0]&&a[0].match(Ph)?e.textStrokeWidth=a[0]:e.textStrokeColor=""),(a=Sh(t,n,i,"letterSpacing",r))&&a.match(Ph)&&(e.letterSpacing=a),(a=Sh(t,n,i,"linePadding",r))&&a.match(Ph)&&(e.linePadding=a),(r=Sh(t,n,i,"opacity",r))&&(e.opacity=parseFloat(r)),(n=Dh(n,i,"textDecoration"))&&yh(e,n),(t=Ih(t,i,"textDecoration"))&&yh(e,t)}(t,p,o,m,i,_,0==e.length),t}function yh(e,t){for(var n=(t=d(t.split(" "))).next();!n.done;n=t.next())switch(n.value){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&te(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&te(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&te(e.textDecoration,"overline")}}function Sh(e,t,n,a,i){return i=void 0===i||i,(e=Ih(e,n,a))?e:i?Dh(t,n,a):null}function Dh(e,t,n){return e?si(e,Gh,n)||xh(e,t,n):null}function Ih(e,t,n){return si(e,Gh,n)||xh(e,t,n)}function xh(e,t,n){e=Ch(e,"style",t,"");for(var a=null,i=0;i<e.length;i++){var r=oi(e[i],"urn:ebu:tt:style",n);r||(r=si(e[i],Gh,n)),r||(r=Ih(e[i],t,n)),r&&(a=r)}return a}function Ch(e,t,n,a,i){var r=[];if(!e||1>n.length)return r;var o=e;for(e=null;o&&!(e=i?oi(o,i,t):o.getAttribute(t))&&(o=o.parentNode)instanceof Element;);if(t=e)for(i=(t=d(t.split(" "))).next();!i.done;i=t.next())for(i=i.value,o=(e=d(n)).next();!o.done;o=e.next())if(a+(o=o.value).getAttribute("xml:id")==i){r.push(o);break}return r}function Oh(e,t,n,a){return e=wh(e,t),null==n?n=e.start:null!=e.start&&(n+=e.start),null==a?a=e.end:null!=e.start&&(a+=e.start),{start:n,end:a}}function wh(e,t){var n=Eh(e.getAttribute("begin"),t),a=Eh(e.getAttribute("end"),t);return e=Eh(e.getAttribute("dur"),t),null==a&&null!=e&&(a=n+e),{start:n,end:a}}function Eh(e,t){var n=null;if(Uh.test(e)){e=Uh.exec(e),n=Number(e[1]);var a=Number(e[2]),i=Number(e[3]),r=Number(e[4]);n=(i+=(r+=(Number(e[5])||0)/t.h)/t.frameRate)+60*a+3600*n}else if(Fh.test(e))n=Ah(Fh,e);else if(Hh.test(e))n=Ah(Hh,e);else if(Rh.test(e))e=Rh.exec(e),n=Number(e[1])/t.frameRate;else if(Nh.test(e))e=Nh.exec(e),n=Number(e[1])/t.g;else if(Bh.test(e))n=Ah(Bh,e);else if(e)throw new ke(2,2,2001,"Could not parse cue time range in TTML");return n}function Ah(e,t){return null==(e=e.exec(t))||""==e[0]?null:(Number(e[4])||0)/1e3+(Number(e[3])||0)+60*(Number(e[2])||0)+3600*(Number(e[1])||0)}function Lh(e,t,n,a){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(a),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}Zt["application/x-subtitle-lrc"]=function(){return new _h},gh.prototype.parseInit=function(){},gh.prototype.setSequenceMode=function(){},gh.prototype.parseMedia=function(e,t){var n=yt(e);if(e=[],""==n)return e;var a=vi(n,"tt");if(!a)throw new ke(2,2,2005,"Failed to parse TTML.");if(!(n=a.getElementsByTagName("body")[0]))return[];var i=si(a,zh,"frameRate"),r=si(a,zh,"subFrameRate"),o=si(a,zh,"frameRateMultiplier"),s=si(a,zh,"tickRate"),c=si(a,zh,"cellResolution"),l=a.getAttribute("xml:space")||"default",u=si(a,Gh,"extent");if("default"!=l&&"preserve"!=l)throw new ke(2,2,2005,"Invalid xml:space value: "+l);l="default"==l,i=new Lh(i,r,o,s),c=c&&(c=/^(\d+) (\d+)$/.exec(c))?{columns:parseInt(c[1],10),rows:parseInt(c[2],10)}:null,r=(r=a.getElementsByTagName("metadata")[0])?function(e){return Array.from(e.childNodes).filter(function(e){return e instanceof Element})}(r):[],o=Array.from(a.getElementsByTagName("style")),s=[];for(var f=d(a=Array.from(a.getElementsByTagName("region"))),p=f.next();!p.done;p=f.next()){var m=p.value;p=new Se;var _=m.getAttribute("xml:id");if(_){p.id=_;var h,b,g=null;u&&(g=kh.exec(u)||Th.exec(u)),_=g?Number(g[1]):null,g=g?Number(g[2]):null,(h=Dh(m,o,"extent"))&&null!=(h=(b=kh.exec(h))||Th.exec(h))&&(p.width=Number(h[1]),p.height=Number(h[2]),b||(null!=_&&(p.width=100*p.width/_),null!=g&&(p.height=100*p.height/g)),p.widthUnits=b||null!=_?De:0,p.heightUnits=b||null!=g?De:0),(m=Dh(m,o,"origin"))&&null!=(h=(b=kh.exec(m))||Th.exec(m))&&(p.viewportAnchorX=Number(h[1]),p.viewportAnchorY=Number(h[2]),b||(null!=g&&(p.viewportAnchorY=100*p.viewportAnchorY/g),null!=_&&(p.viewportAnchorX=100*p.viewportAnchorX/_)),p.viewportAnchorUnits=b||null!=_?De:0)}else p=null;p&&s.push(p)}if(ii(n,"p").length)throw new ke(2,2,2001,"<p> can only be inside <div> in TTML");for(f=(u=d(ii(n,"div"))).next();!f.done;f=u.next())if(ii(f.value,"span").length)throw new ke(2,2,2001,"<span> can only be inside <p> in TTML");return(t=vh(n,t,i,r,o,a,s,l,c,null,!1))&&(t.backgroundColor||(t.backgroundColor="transparent"),e.push(t)),e},B("shaka.text.TtmlTextParser",gh),gh.prototype.parseMedia=gh.prototype.parseMedia,gh.prototype.setSequenceMode=gh.prototype.setSequenceMode,gh.prototype.parseInit=gh.prototype.parseInit;var kh=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Mh=/^(\d{1,2}(?:\.\d+)?|100)%$/,Ph=/^(\d+px|\d+em|\d*\.?\d+c)$/,Th=/^(\d+)px (\d+)px$/,Uh=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Fh=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Hh=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Rh=/^(\d*(?:\.\d*)?)f$/,Nh=/^(\d*(?:\.\d*)?)t$/,Bh=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),jh={left:me,center:"center",right:"end",start:me,end:"end"},Vh={left:"line-left",center:"center",right:"line-right"},zh=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],Gh=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],Kh=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function Wh(){this.g=new gh}function qh(){this.g=!1}function Qh(e){for(var t=d(Object.entries(he)),n=t.next();!n.done;n=t.next()){var a=d(n.value);n=a.next().value,a=a.next().value;var i=new ie(0,0,"");i.color=a,e.set(n,i)}for(n=(t=d(Object.entries(be))).next();!n.done;n=t.next())n=(a=d(n.value)).next().value,a=a.next().value,(i=new ie(0,0,"")).backgroundColor=a,e.set(n,i)}function Yh(e,t,n){0===n.size&&Qh(n),e=function(e){for(var t=[],n=-1,a="",i=0;i<e.length;i++)if("/"===e[i]){var r=e.indexOf(">",i);if(r<=i)return e;r=e.substring(i+1,r);var o=t.pop();if(!r||!o)return e;if(o===r)a+="/"+r+">";else{if(!o.startsWith("c.")||"c"!==r)return e;a+="/"+o+">"}i+=r.length+1}else"<"===e[i]?n=i+1:">"===e[i]&&0<n&&(t.push(e.substr(n,i-n)),n=-1),a+=e[i];return a}(e);for(var a=[],i=-1,r=0;r<e.length;r++)"<"===e[r]?i=r+1:">"===e[r]&&0<i&&((i=e.substr(i,r-i)).match(tb)&&a.push(i),i=-1);for(r=(a=d(a)).next();!r.done;r=a.next())r=r.value,e=e.replace("<"+r+">",'<div time="'+r+'">'),e+="</div>";if(r=vi("<span>"+e+"</span>","span")){if(a=[],1==(r=r.childNodes).length&&((i=r[0]).nodeType==Node.TEXT_NODE||i.nodeType==Node.CDATA_SECTION_NODE))return void(t.payload=e);for(r=(e=d(r)).next();!r.done;r=e.next())Xh(r.value,t,a,n);t.nestedCues=a}else t.payload=e}function Jh(e,t){return e&&0<e.length?e:t}function Xh(e,t,n,a){var i=t.clone();if(e.nodeType===Node.ELEMENT_NODE&&e.nodeName)for(var r=d(e.nodeName.split(/[ .]+/)),o=r.next();!o.done;o=r.next()){if(o=o.value,a.has(o)){var s=a.get(o);s&&(i.backgroundColor=Jh(s.backgroundColor,i.backgroundColor),i.color=Jh(s.color,i.color),i.fontFamily=Jh(s.fontFamily,i.fontFamily),i.fontSize=Jh(s.fontSize,i.fontSize),i.fontWeight=s.fontWeight,i.fontStyle=s.fontStyle,i.opacity=s.opacity,i.wrapLine=s.wrapLine)}switch(o){case"b":i.fontWeight=700;break;case"i":i.fontStyle="italic";break;case"u":i.textDecoration.push("underline");break;case"div":(o=e.getAttribute("time"))&&(o=$h(new Sf(o)))&&(i.startTime=o)}}if(di(e))for(r=!0,a=d(e.textContent.split("\n")),e=a.next();!e.done;e=a.next())e=e.value,r||((r=t.clone()).lineBreak=!0,n.push(r)),0<e.length&&((r=i.clone()).payload=e,n.push(r)),r=!1;else for(e=(t=d(e.childNodes)).next();!e.done;e=t.next())Xh(e.value,i,n,a)}function Zh(e,t,n){var a;(a=/^align:(start|middle|center|end|left|right)$/.exec(t))?(t=a[1],e.textAlign="middle"==t?se:ce[t.toUpperCase()]):(a=/^vertical:(lr|rl)$/.exec(t))?e.writingMode="lr"==a[1]?"vertical-lr":"vertical-rl":(a=/^size:([\d.]+)%$/.exec(t))?e.size=Number(a[1]):(a=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))?(e.position=Number(a[1]),a[2]&&(t=a[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center")):(a=/^region:(.*)$/.exec(t))?(t=function(e,t){return e=e.filter(function(e){return e.id==t}),e.length?e[0]:null}(n,a[1]))&&(e.region=t):(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))?(e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=_e[n[2].toUpperCase()])):(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))&&(e.lineInterpretation=pe,e.line=Number(n[1]),n[2]&&(e.lineAlign=_e[n[2].toUpperCase()]))}function $h(e){if(null==(e=If(e,tb)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function eb(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},n=/&(?:amp|lt|gt|quot|#(0+)?39);/g,a=RegExp(n.source);return e&&a.test(e)?e.replace(n,function(e){return t[e]||"'"}):e||""}Zt["application/ttml+xml"]=function(){return new gh},Wh.prototype.parseInit=function(e){var t=!1;if((new Ga).box("moov",Ka).box("trak",Ka).box("mdia",Ka).box("minf",Ka).box("stbl",Ka).P("stsd",Wa).box("stpp",function(e){t=!0,e.parser.stop()}).parse(e),!t)throw new ke(2,2,2007)},Wh.prototype.setSequenceMode=function(){},Wh.prototype.parseMedia=function(e,t){var n=this,a=!1,i=[];if((new Ga).box("mdat",Qa(function(e){a=!0,i=i.concat(n.g.parseMedia(e,t))})).parse(e,!1),!a)throw new ke(2,2,2007);return i},B("shaka.text.Mp4TtmlParser",Wh),Wh.prototype.parseMedia=Wh.prototype.parseMedia,Wh.prototype.setSequenceMode=Wh.prototype.setSequenceMode,Wh.prototype.parseInit=Wh.prototype.parseInit,Zt['application/mp4; codecs="stpp"']=function(){return new Wh},Zt['application/mp4; codecs="stpp.ttml"']=function(){return new Wh},Zt['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new Wh},Zt['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new Wh},qh.prototype.parseInit=function(){},qh.prototype.setSequenceMode=function(e){this.g=e},qh.prototype.parseMedia=function(e,t){var n=(e=(e=yt(e)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new ke(2,2,2e3);if(e=t.vttOffset,n[0].includes("X-TIMESTAMP-MAP")&&this.g){var a=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),i=n[0].match(/MPEGTS:(\d+)/m);if(a&&i){if(null==(e=$h(new Sf(a[1]))))throw new ke(2,2,2e3);for(i=Number(i[1]),a=t.segmentStart-t.periodStart;95443.7176888889<=a;)a-=95443.7176888889,i+=8589934592;e=t.periodStart+i/9e4-e}}for(t=[],a=(i=d(n[0].split("\n"))).next();!a.done;a=i.next())if(a=a.value,/^Region:/.test(a)){a=new Sf(a);var r=new Se;xf(a),Df(a);for(var o=xf(a);o;){var s=r,c=o;(o=/^id=(.*)$/.exec(c))?s.id=o[1]:(o=/^width=(\d{1,2}|100)%$/.exec(c))?s.width=Number(o[1]):(o=/^lines=(\d+)$/.exec(c))?(s.height=Number(o[1]),s.heightUnits=2):(o=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(c))?(s.regionAnchorX=Number(o[1]),s.regionAnchorY=Number(o[2])):(o=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(c))?(s.viewportAnchorX=Number(o[1]),s.viewportAnchorY=Number(o[2])):/^scroll=up$/.exec(c)&&(s.scroll="up"),Df(a),o=xf(a)}t.push(r)}for(Qh(i=new Map),a=[],r=(n=d(n.slice(1))).next();!r.done;r=n.next()){if((1!=(r=r.value.split("\n")).length||r[0])&&!/^NOTE($|[ \t])/.test(r[0])&&"STYLE"==r[0]&&r[1].includes("::cue")){s="global",(o=r[1].match(/\((.*)\)/))&&(s=o.pop()),o=r.slice(2,-1),r[1].includes("}")&&(c=/\{(.*?)\}/.exec(r[1]))&&(o=c[1].split(";")),c=new ie(0,0,"");for(var l=!1,u=0;u<o.length;u++){var f=/^\s*([^:]+):\s*(.*)/.exec(o[u]);if(f){var p=f[2].trim().replace(";","");switch(f[1].trim()){case"background-color":l=!0,c.backgroundColor=p;break;case"color":l=!0,c.color=p;break;case"font-family":l=!0,c.fontFamily=p;break;case"font-size":l=!0,c.fontSize=p;break;case"font-weight":700<=parseInt(p,10)&&(l=!0,c.fontWeight=700);break;case"font-style":switch(p){case"normal":l=!0,c.fontStyle=ve;break;case"italic":l=!0,c.fontStyle="italic";break;case"oblique":l=!0,c.fontStyle="oblique"}break;case"opacity":l=!0,c.opacity=parseFloat(p);break;case"text-shadow":l=!0,c.textShadow=p;break;case"white-space":l=!0,c.wrapLine="noWrap"!=p}}}l&&i.set(s,c)}if(u=e,1==r.length&&!r[0]||/^NOTE($|[ \t])/.test(r[0])||"STYLE"==r[0])r=null;else{if(s=null,r[0].includes("--\x3e")||(s=r[0],r.splice(0,1)),c=$h(o=new Sf(r[0])),f=If(o,/[ \t]+--\x3e[ \t]+/g),l=$h(o),null==c||null==f||null==l)throw new ke(2,2,2001,"Could not parse cue time range in WebVTT");for(c+=u,l+=u,u=eb(r.slice(1).join("\n").trim()),i.has("global")?((r=i.get("global").clone()).startTime=c,r.endTime=l,r.payload=""):r=new ie(c,l,""),Yh(u,r,i),Df(o),c=xf(o);c;)Zh(r,c,t),Df(o),c=xf(o);null!=s&&(r.id=s)}r&&a.push(r)}return a},B("shaka.text.VttTextParser",qh),qh.prototype.parseMedia=qh.prototype.parseMedia,qh.prototype.setSequenceMode=qh.prototype.setSequenceMode,qh.prototype.parseInit=qh.prototype.parseInit;var tb=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function nb(){this.g=null}function ab(e,t,n){var a,i,r;return(new Ga).box("payl",Qa(function(e){a=yt(e)})).box("iden",Qa(function(e){i=yt(e)})).box("sttg",Qa(function(e){r=yt(e)})).parse(e),a?function(e,t,n,a,i){if(Yh(e,a=new ie(a,i,""),new Map),t&&(a.id=t),n)for(t=xf(e=new Sf(n));t;)Zh(a,t,[]),Df(e),t=xf(e);return a}(a,i,r,t,n):null}function ib(){}function rb(e){if(null==(e=If(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function ob(){this.g=new qh}function sb(e){var t="WEBVTT\n\n";if(""==e)return t;for(var n=(e=d((e=(e=e.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!n.done;n=e.next())(n=n.value.split(/\n/))[0].match(/\d+/)&&n.shift(),n[0]=n[0].replace(/,/g,"."),t+=n.join("\n")+"\n\n";return t}function cb(){}function db(e,t){var n=t.Fontname;if(n&&(e.fontFamily=n),(n=t.Fontsize)&&(e.fontSize=n+"px"),(n=t.PrimaryColour)&&(n=lb(n))&&(e.color=n),(n=t.BackColour)&&(n=lb(n))&&(e.backgroundColor=n),t.Bold&&(e.fontWeight=700),t.Italic&&(e.fontStyle="italic"),t.Underline&&e.textDecoration.push("underline"),(n=t.Spacing)&&(e.letterSpacing=n+"px"),n=t.Alignment)switch(parseInt(n,10)){case 1:e.displayAlign=de,e.textAlign="start";break;case 2:e.displayAlign=de,e.textAlign=se;break;case 3:e.displayAlign=de,e.textAlign="end";break;case 5:e.displayAlign="before",e.textAlign="start";break;case 6:e.displayAlign="before",e.textAlign=se;break;case 7:e.displayAlign="before",e.textAlign="end";break;case 9:e.displayAlign="center",e.textAlign="start";break;case 10:e.displayAlign="center",e.textAlign=se;break;case 11:e.displayAlign="center",e.textAlign="end"}(t=t.AlphaLevel)&&(e.opacity=parseFloat(t))}function lb(e){return 0<=(e=parseInt(e.replace("&H",""),16))?"rgba("+(255&e)+","+(e>>8&255)+","+(e>>16&255)+","+(e>>24&255^255)/255+")":null}function ub(e){return 3600*((e=bb.exec(e))[1]?parseInt(e[1].replace(":",""),10):0)+60*parseInt(e[2],10)+parseFloat(e[3])}Zt["text/vtt"]=function(){return new qh},Zt['text/vtt; codecs="vtt"']=function(){return new qh},Zt['text/vtt; codecs="wvtt"']=function(){return new qh},nb.prototype.parseInit=function(e){var t=this,n=!1;if((new Ga).box("moov",Ka).box("trak",Ka).box("mdia",Ka).P("mdhd",function(e){e=ao(e.reader,e.version),t.g=e.timescale}).box("minf",Ka).box("stbl",Ka).P("stsd",Wa).box("wvtt",function(){n=!0}).parse(e),!this.g)throw new ke(2,2,2008);if(!n)throw new ke(2,2,2008)},nb.prototype.setSequenceMode=function(){},nb.prototype.parseMedia=function(e,t){if(!this.g)throw new ke(2,2,2008);var n,a=0,i=[],r=[],o=!1,s=!1,c=!1,l=null;if((new Ga).box("moof",Ka).box("traf",Ka).P("tfdt",function(e){o=!0,a=no(e.reader,e.version).ue}).P("tfhd",function(e){l=to(e.reader,e.flags).Ae}).P("trun",function(e){s=!0,i=io(e.reader,e.version,e.flags).Qe}).box("mdat",Qa(function(e){c=!0,n=e})).parse(e,!1),!c&&!o&&!s)throw new ke(2,2,2008);e=a;for(var u=new ja(n,0),f=d(i),p=f.next();!p.done;p=f.next()){var m=(p=p.value).de||l,_=p.fd?a+p.fd:e;e=_+(m||0);var h=0;do{var b=u.K();h+=b;var g=null;"vttc"==Ja(u.K())?8<b&&(g=u.$a(b-8)):u.skip(b-8),m&&g&&(b=ab(g,t.periodStart+_/this.g,t.periodStart+e/this.g),r.push(b))}while(p.sampleSize&&h<p.sampleSize)}return r.filter(Ye)},B("shaka.text.Mp4VttParser",nb),nb.prototype.parseMedia=nb.prototype.parseMedia,nb.prototype.setSequenceMode=nb.prototype.setSequenceMode,nb.prototype.parseInit=nb.prototype.parseInit,Zt['application/mp4; codecs="wvtt"']=function(){return new nb},ib.prototype.parseInit=function(){},ib.prototype.setSequenceMode=function(){},ib.prototype.parseMedia=function(e){var t=yt(e).replace(/\r+/g,"");if(e=[],""==(t=t.trim()))return e;for(var n=(t=d(t.split("\n\n"))).next();!n.done;n=t.next()){var a=new Sf((n=n.value.split("\n"))[0]),i=rb(a),r=If(a,/,/g);if(a=rb(a),null==i||null==r||null==a)throw new ke(2,2,2001,"Could not parse cue time range in SubViewer");e.push(new ie(i,a,n.slice(1).join("\n").trim()))}return e},B("shaka.text.SbvTextParser",ib),ib.prototype.parseMedia=ib.prototype.parseMedia,ib.prototype.setSequenceMode=ib.prototype.setSequenceMode,ib.prototype.parseInit=ib.prototype.parseInit,Zt["text/x-subviewer"]=function(){return new ib},ob.prototype.parseInit=function(){},ob.prototype.setSequenceMode=function(){},ob.prototype.parseMedia=function(e,t){return e=Ee(It(e=sb(e=yt(e)))),this.g.parseMedia(e,t)},B("shaka.text.SrtTextParser",ob),ob.srt2webvtt=sb,ob.prototype.parseMedia=ob.prototype.parseMedia,ob.prototype.setSequenceMode=ob.prototype.setSequenceMode,ob.prototype.parseInit=ob.prototype.parseInit,Zt["text/srt"]=function(){return new ob},cb.prototype.parseInit=function(){},cb.prototype.setSequenceMode=function(){},cb.prototype.parseMedia=function(e){for(var t="",n="",a=(e=d(e=yt(e).split(/\r?\n\s*\r?\n/))).next();!a.done;a=e.next()){var i=mb.exec(a.value);i&&(a=i[1],i=i[2],"V4 Styles"==a||"V4+ Styles"==a?t=i:"Events"==a&&(n=i))}e=[],a=null;for(var r=(t=d(t.split(/\r?\n/))).next();!r.done;r=t.next())if(i=r.value,!/^\s*;/.test(i)&&(r=_b.exec(i)))if(i=r[1].trim(),r=r[2].trim(),"Format"==i)a=r.split(hb);else if("Style"==i){i=r.split(hb),r={};for(var o=0;o<a.length&&o<i.length;o++)r[a[o]]=i[o];e.push(r)}for(a=[],t=null,i={},r=(n=d(n.split(/\r?\n/))).next();!r.done;i={wd:i.wd},r=n.next())if(r=r.value,!/^\s*;/.test(r)&&(o=_b.exec(r)))if(r=o[1].trim(),o=o[2].trim(),"Format"==r)t=o.split(hb);else if("Dialogue"==r){o=o.split(hb),r={};for(var s=0;s<t.length&&s<o.length;s++)r[t[s]]=o[s];o=new ie(s=ub(r.Start),ub(r.End),o.slice(t.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),i.wd=r.Style,(r=e.find(function(e){return function(t){return t.Name==e.wd}}(i)))&&db(o,r),a.push(o)}return a},B("shaka.text.SsaTextParser",cb),cb.prototype.parseMedia=cb.prototype.parseMedia,cb.prototype.setSequenceMode=cb.prototype.setSequenceMode,cb.prototype.parseInit=cb.prototype.parseInit;var fb,pb,mb=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,_b=/^\s*([^:]+):\s*(.*)/,hb=/\s*,\s*/,bb=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function gb(){}function vb(){fb?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(fb=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=yb):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function yb(e,t){var n,a=this;return M(function(i){return 1==i.g?(console.assert(a==navigator,'bad "this" for requestMediaKeySystemAccess'),y(i,fb.call(a,e,t),2)):Lb(n=i.h)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=fb,i.return(n)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=Sb,i.return(Sb.call(a,e,t)))})}function Sb(e,t){var n,a,i,r,o,s,c,l,u,f,p=this;return M(function(m){if(1==m.g){for(console.assert(p==navigator,'bad "this" for requestMediaKeySystemAccess'),n=Ab(e),a=[],i=d(t),r=i.next();!r.done;r=i.next())o=r.value,s=Db(o.videoCapabilities,n),c=Db(o.audioCapabilities,n),o.videoCapabilities&&o.videoCapabilities.length&&!s.length||o.audioCapabilities&&o.audioCapabilities.length&&!c.length||((l=Object.assign({},o)).videoCapabilities=s,l.audioCapabilities=c,a.push(l));if(!a.length)throw(u=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",u.code=DOMException.NOT_SUPPORTED_ERR,u;return y(m,fb.call(p,e,a),2)}return f=m.h,m.return(new Eb(f,n))})}function Db(e,t){return e?e.filter(function(e){return!e.encryptionScheme||e.encryptionScheme==t}):e}function Ib(){}function xb(){pb?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(pb=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Cb):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Cb(e){var t,n,a,i=this;return M(function(r){switch(r.g){case 1:return console.assert(i==navigator.mediaCapabilities,'bad "this" for decodingInfo'),y(r,pb.call(i,e),2);case 2:if(t=r.h,!e.keySystemConfiguration)return r.return(t);if((n=t.keySystemAccess)&&Lb(n))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=pb,r.return(t);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Ob,n){r.A(3);break}return a=t,y(r,wb(e),4);case 4:return a.keySystemAccess=r.h,r.return(t);case 3:return r.return(Ob.call(i,e))}})}function Ob(e){var t,n,a,i,r,o,s,c,d=this;return M(function(l){switch(l.g){case 1:return console.assert(d==navigator.mediaCapabilities,'bad "this" for decodingInfo'),t=null,e.keySystemConfiguration&&(n=e.keySystemConfiguration,a=n.keySystem,i=n.audio&&n.audio.encryptionScheme,r=n.video&&n.video.encryptionScheme,t=Ab(a),o={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},i&&i!=t||r&&r!=t)?l.return(o):y(l,pb.call(d,e),2);case 2:if((s=l.h).keySystemAccess){s.keySystemAccess=new Eb(s.keySystemAccess,t),l.A(3);break}if(!e.keySystemConfiguration){l.A(3);break}return c=s,y(l,wb(e),5);case 5:c.keySystemAccess=l.h;case 3:return l.return(s)}})}function wb(e){var t,n;return M(function(a){if(1==a.g){var i=e.keySystemConfiguration,r=[],o=[];return i.audio&&r.push({robustness:i.audio.robustness||"",contentType:e.audio.contentType}),i.video&&o.push({robustness:i.video.robustness||"",contentType:e.video.contentType}),i={initDataTypes:i.initDataType?[i.initDataType]:[],distinctiveIdentifier:i.distinctiveIdentifier,persistentState:i.persistentState,sessionTypes:i.sessionTypes},r.length&&(i.audioCapabilities=r),o.length&&(i.videoCapabilities=o),t=i,y(a,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[t]),2)}return n=a.h,a.return(n)})}function Eb(e,t){this.h=e,this.g=t,this.keySystem=e.keySystem}function Ab(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.chromecast")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function Lb(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function kb(){}function Mb(){vb(),xb()}Zt["text/x-ssa"]=function(){return new cb},B("EmeEncryptionSchemePolyfill",gb),gb.install=vb,B("McEncryptionSchemePolyfill",Ib),Ib.install=xb,Eb.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var t=d(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.g;if(e.audioCapabilities)for(n=(t=d(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.g;return e},Eb.prototype.createMediaKeys=function(){return this.h.createMediaKeys()},B("EncryptionSchemePolyfills",kb),kb.install=Mb,void 0!==n&&n.exports&&(n.exports=kb)}.call(a,e,e,void 0),a.shaka)t[i]=a.shaka[i]}()}
,1473:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ShakaOnePlayerEngine:()=>Ke,fetchProtectionKey:()=>R,parseContentProtectionData:()=>z});var a=n(0),i=n(1250),r=n(236),o=n(421),s=n(446),c=n(1249),d=n(797),l=n(1218),u=n(2431),f=n.n(u),p=n(3766),m=void 0,_={error:function(e,t,n){console.error("[".concat(e,"]: ").concat(t," - ").concat(null!=n?n:""))},info:function(e,t,n){console.info("[".concat(e,"]: ").concat(t," - ").concat(null!=n?n:""))},warn:function(e,t,n){console.warn("[".concat(e,"]: ").concat(t," - ").concat(null!=n?n:""))},debug:function(e,t,n){console.debug("[".concat(e,"]: ").concat(t," - ").concat(null!=n?n:""))}},h=function(e){var t;return null!==(t=null==m?void 0:m(e))&&void 0!==t?t:_},b=h("utils");function g(e,t){if(void 0===t&&(t="int"),void 0===e||"number"==typeof e)return e;if("string"==typeof e)switch(t){case"int":return parseInt(e,10)||void 0;case"float":return parseFloat(e)||void 0}}var v={killswitches:void 0};function y(e,t,n){var a=n||e;return t?(Object.keys(t).forEach(function(e){void 0!==t[e]&&a&&(a[e]=t[e])}),a):a}function S(e){return e?e.end-e.start:0}function D(e){try{console.debug(e())}catch(e){console.error(e)}}function I(e){return null==e}function x(e){var t;return(null===(t=v.killswitches)||void 0===t?void 0:t.isHtmlInRawDataAvoided)&&void 0!==e&&"string"==typeof e&&e.toLowerCase().includes("<html>")?"scrubbed html error response":e}function C(){return window&&window.navigator&&!window.navigator.onLine}var O=performance||Date;function w(e){if(e)try{return new URL(e).toString()}catch(e){}}function E(e){return!!e.label}function A(e,t,n){return e.find(function(e){return e.language===t&&e.role===n})}var L=["application/dash+xml","video/vnd.mpeg.dash.mpd"],k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logger=h("MeTaManifestParser"),t}return(0,a.__extends)(t,e),t.prototype.start=function(t,n){return(0,a.__awaiter)(this,void 0,void 0,function(){var i,r;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.prototype.start.call(this,t,n)];case 1:return i=a.sent(),this.removeDRMRelatedFields(i),[2,i];case 2:throw r=a.sent(),this.logger.error("MeTaManifestParser - start: parser error",r),r;case 3:return[2]}})})},t.prototype.removeDRMRelatedFields=function(e){e.variants.forEach(function(e){[e.video,e.audio].forEach(function(e){null!==e&&(e.encrypted=!1,e.drmInfos=[])})})},t}(f().dash.DashParser);function M(){var e=0;return{registerManifestParser:function(){0===e&&L.forEach(function(e){return f().media.ManifestParser.registerParserByMime(e,function(){return new k})}),e++},unRegisterManifestParser:function(){--e<=0&&L.forEach(function(e){return f().media.ManifestParser.registerParserByMime(e,function(){return new(f().dash.DashParser)})})}}}var P=function(){function e(e,t,n,a){if(this.player=e,this.error=t,this.engineStats=n,this.logger=a,this.registerDashParser(),!p.a.isSupported())return this.logger.warn("constructor","Platform does not support WebCrypto API. CDN cannot be enabled"),void this.onError("CDN_CONFIGURATION_ERROR","DECRYPTOR_UNSUPPORTED","EngineReload");this.aesDecryptor=new p.a}return e.prototype.init=function(){var e=this.player.getNetworkingEngine();return null==e?(this.logger.error("init","Shaka does not have a networking engine"),Promise.resolve()):this.setupFilters(e)},e.prototype.dispose=function(){try{this.disposeFilters(),this.unregisterDashParser()}catch(e){this.logger.error("dispose","Failed to dispose CDNAdapter: ".concat(e))}},e.prototype.onError=function(e,t,n){var i;if("CDN_OPERATIONAL_ERROR"===e?this.engineStats.value=(0,a.__assign)((0,a.__assign)({},this.engineStats.value),{hasCdnFailed:!0}):"CDN_CONFIGURATION_ERROR"===e&&(this.engineStats.value=(0,a.__assign)((0,a.__assign)({},this.engineStats.value),{hasCdnStarted:!1,cdnConfigError:t})),null===(i=v.killswitches)||void 0===i?void 0:i.isWebCryptoFallbackFixEnabled){var r={engine:"Shaka",errorName:e,message:t,isFatal:!1,isExpected:!1,fallbackType:"CDN_CONFIGURATION_ERROR"===e?"NoEngineReload":"EngineReload"};n&&(r.fallbackType=n),this.error.value=r}},e.prototype.unregisterDashParser=function(){e.manifestParserRegister.unRegisterManifestParser()},e.prototype.registerDashParser=function(){e.manifestParserRegister.registerManifestParser()},e.manifestParserRegister=M(),e}(),T=function(){function e(e,t){this.networkEngine=e,this.onErrorHandler=t,this.disposed=!1,this.applyFilter=this.applyFilter.bind(this)}return e.prototype.register=function(){var e;null===(e=this.networkEngine)||void 0===e||e.registerResponseFilter(this.applyFilter)},e.prototype.dispose=function(){var e;this.disposed||(null===(e=this.networkEngine)||void 0===e||e.unregisterResponseFilter(this.applyFilter),this.disposed=!0)},e}(),U=function(e){function t(t,n,a,i,r){var o=e.call(this,a,i)||this;return o.configurationStore=t,o.decryptor=n,o.onDecryptionStatsHandler=r,o.logger=h("ContentDecryptionResponseFilter"),o.applyFilter=o.applyFilter.bind(o),o}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){var n,i,r,o,s,c;return(0,a.__awaiter)(this,void 0,void 0,function(){var d,l,u,p,m,_;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,4,,5]),200!==t.status)return this.logger.error("applyFilter","Unexpected status code",null!==(i=null===(n=null==t?void 0:t.status)||void 0===n?void 0:n.toString())&&void 0!==i?i:"undefined"),[2];if(e!==f().net.NetworkingEngine.RequestType.SEGMENT||!this.isEncrypted(t))return[2];if(!(d=this.configurationStore.get()))throw new Error("No cdnConfig found. We should not be here");return l=d.cryptoKey,u=d.iv,l&&u?(p=performance.now(),m=t,[4,this.decryptor.decrypt(t.data,l,u)]):[3,2];case 1:return m.data=a.sent(),t.headers["content-length"]=null!==(s=null===(o=null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.byteLength)||void 0===o?void 0:o.toString())&&void 0!==s?s:void 0,null===(c=this.onDecryptionStatsHandler)||void 0===c||c.call(this,performance.now()-p),[3,3];case 2:throw new Error("No cryptoKey or iv found. We should not be here");case 3:return[3,5];case 4:throw _=a.sent(),this.logger.error("applyFilter","Unexpected error. x-cache=".concat(null==t?void 0:t.headers["x-cache"]," nonencryptedplayback=").concat(null==t?void 0:t.headers.nonencryptedplayback),_),this.onErrorHandler("CDN_OPERATIONAL_ERROR","DECRYPTION_FAILED"),_;case 5:return[2]}})})},t.prototype.isEncrypted=function(e){var t=[i.b.miss,i.b.hit,i.b.remoteHit],n=null==e?void 0:e.headers["x-cache"],a="0"===(null==e?void 0:e.headers.nonencryptedplayback);return void 0!==n&&t.includes(n)||a},t}(T),F=function(){function e(){this.state={},this.isFrozen=!1}return e.prototype.put=function(e){var t;if(this.isFrozen)h("CDNConfigurationStoreImplementation").warn("put","Trying to update a froze store");else{if(!e.keyId||this.state.keyId&&e.keyId!==this.state.keyId)throw new Error("Stored key does not match new key");this.state=(0,a.__assign)((0,a.__assign)({},this.state),e),null===(t=this.onUpdateEventHandler)||void 0===t||t.call(this,this.get())}},e.prototype.get=function(){return(0,a.__assign)({},this.state)},e.prototype.clear=function(){this.state={},this.isFrozen=!1},Object.defineProperty(e.prototype,"onUpdateEvent",{set:function(e){this.onUpdateEventHandler=e},enumerable:!1,configurable:!0}),e.prototype.freeze=function(){this.isFrozen=!0},e}(),H=function(e){return void 0!==e&&void 0!==e.p1&&void 0!==e.p2&&void 0!==e.p3&&void 0!==e.p4},R=function(e){return(0,a.__awaiter)(void 0,void 0,void 0,function(){var t,n,i;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===e.keyUri)throw new Error("Illegal argument error: config.keyUri is undefined");return[4,fetch(e.keyUri.toString())];case 1:if(!(t=a.sent()).ok)throw new Error("Unable to retrieve protection key. Status Code: ".concat(t.status));return[4,t.arrayBuffer()];case 2:if(n=a.sent(),(null!==(i=null==n?void 0:n.byteLength)&&void 0!==i?i:0)<=0)throw new Error("Unable to retrieve protection key: empty response");return[2,n]}})})},N=function(){function e(e,t){this.configurationStore=e,this.aesDecryptor=t,this.logger=h("VideoProtectionKeyManager")}return e.prototype.fetchKey=function(e){return(0,a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.__generator)(this,function(o){switch(o.label){case 0:if(void 0===(t=this.configurationStore.get()).keyId||void 0===t.keyUri)return this.logger.error("fetchKey","No keyUri found in CDNConfigurationStore"),[2];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.prefetchOrFetchSingleKey(t,e)];case 2:return n=o.sent(),[4,this.aesDecryptor.registerKey(n)];case 3:return i=o.sent(),this.configurationStore.put((0,a.__assign)((0,a.__assign)({},t),{cryptoKey:i})),[3,5];case 4:throw r=o.sent(),this.logger.error("fetchKey","Failed to fetch key",r),r;case 5:return[2]}})})},e.prototype.prefetchOrFetchSingleKey=function(e,t){var n,i,r,o,s;return(0,a.__awaiter)(this,void 0,void 0,function(){var c,d,l,u;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(c=e.keyId,d=null===(n=e.keyUri)||void 0===n?void 0:n.searchParams.get("cTag"),l=null===(i=e.keyUri)||void 0===i?void 0:i.searchParams.get("correlationid"),this.logger.info("prefetchOrFetchSingleKey","Attempting to fetch key for kId: ".concat(c,", cTag: ").concat(d," and correlationId: ").concat(l)),void 0===t)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t];case 2:return 200===(null==(u=a.sent())?void 0:u.status)&&void 0!==(null==u?void 0:u.arrBuf)&&(null===(r=null==u?void 0:u.arrBuf)||void 0===r?void 0:r.byteLength)>0?(this.logger.info("prefetchOrFetchSingleKey","VideoContentProtection prefetch accepted"),[2,u.arrBuf]):(this.logger.warn("prefetchOrFetchSingleKey","VideoContentProtection prefetch rejected","Status: ".concat(null==u?void 0:u.status,", Length: ").concat(null!==(s=null===(o=null==u?void 0:u.arrBuf)||void 0===o?void 0:o.byteLength)&&void 0!==s?s:0)),[3,4]);case 3:return a.sent(),this.logger.error("prefetchOrFetchSingleKey","VideoContentProtection prefetch rejected"),[3,4];case 4:return[2,R(e)]}})})},e}(),B=function(e){function t(t,n,a,i,r){var o=e.call(this,a,i)||this;return o.configurationStore=t,o.keyAcquirePrefetch=r,o.logger=h("ContentDecryptionResponseFilter"),o.applyFilter=o.applyFilter.bind(o),o.keyAcquirer=new N(t,n),o}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,3,,4]),200!==t.status)return[2];if(e!==f().net.NetworkingEngine.RequestType.MANIFEST)return[3,2];if(!this.configurationStore.get().keyUri)throw new Error("No keyUri found");return[4,this.keyAcquirer.fetchKey(this.keyAcquirePrefetch)];case 1:a.sent(),a.label=2;case 2:return[3,4];case 3:return n=a.sent(),this.logger.error("applyFilter","Unexpected error",n),this.onErrorHandler("CDN_CONFIGURATION_ERROR","NO_KEY_URI_FOUND"),[3,4];case 4:return[2]}})})},t}(T),j=n(1208),V=n(794),z=function(e,t){var n=h("contentProtectionParser");try{var a=new Map,i=null!=t?t:G(e),r=Array.from(i.getElementsByTagName("ContentProtection"));return 0===r.length?(n.warn("parseContentProtectionData","No ContentProtection elements found in manifest"),a):(Array.from(r).forEach(function(e){return K(e,a)}),a)}catch(e){throw n.error("parseContentProtectionData",e),e}},G=function(e){var t=(0,V.d)(e,"@msstream/one-player#noop-create-html",J);if(!t)throw new Error("Failed to securely parse manifest");return t},K=function(e,t){var n,a=h("contentProtectionParser");if(!((null===(n=null==e?void 0:e.children)||void 0===n?void 0:n.length)<3)){var i=e.getAttribute("schemeIdUri"),r=e.children[0].getAttribute("schemeIdUri"),o=e.children[1].getAttribute("keySystemUri"),s=e.children[2].getAttribute("keyUriTemplate"),c=e.children[2].getAttribute("IV");if(W(i,r,o))if(null!==s&&q(s)){var d=new URL(s),l=d.searchParams.get("kid");t.has(l)||(null!==c&&Q(c)?t.set(l,{keyId:l,keyUri:d,iv:Y(c)}):a.error("addToKeyContentProtectionMap","ContentProtection IV is not valid hex string"))}else a.error("addToKeyContentProtectionMap","ContentProtection keyUriTemplate is not a valid URI");else a.error("addToKeyContentProtectionMap","ContentProtection does not match any known schema")}},W=function(e,t,n){return"urn:mpeg:dash:sea:2012"===e&&"urn:mpeg:dash:sea:aes128-cbc:2013"===t&&"urn:mpeg:dash:sea:keysys:http:2013"===n},q=function(e){try{return new URL(e).searchParams.has("kid")}catch(e){return!1}},Q=function(e){return/0x[A-Fa-f0-9]{32}/.test(e)},Y=function(e){for(var t=e.substring(2),n=new Uint8Array(t.length/2),a=0;a<t.length;a+=2){var i=parseInt(t.substr(a,2),16);if(isNaN(i))throw new Error("Invalid hexString");n[a/2]=i}return n};function J(e){h("contentProtectionParser").error("secureXmlParse",e)}var X=function(e){function t(t,n,a,i){var r=e.call(this,n,a)||this;return r.configurationStore=t,r.logger=h("ContentProtectionResponseFilter"),r.applyFilter=r.applyFilter.bind(r),r.key=i,r}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){var n,i,r;return(0,a.__awaiter)(this,void 0,void 0,function(){var o,s,c;return(0,a.__generator)(this,function(a){try{if(200!==t.status)return this.logger.error("applyFilter","Unexpected status code",null!==(i=null===(n=null==t?void 0:t.status)||void 0===n?void 0:n.toString())&&void 0!==i?i:"undefined"),[2];if(e===f().net.NetworkingEngine.RequestType.MANIFEST){if(o=(new TextDecoder).decode(t.data),s=z(o),c=!!(null===(r=v.killswitches)||void 0===r?void 0:r.isInlineKeyValidityCheckEnabled)&&this.key&&(0,j.b)(this.key,s.values().next().value,this.logger),!((null==s?void 0:s.size)>0))throw new Error("No ContentProtection data found");if(c)return[2];this.configurationStore.put(s.values().next().value)}}catch(e){this.logger.error("applyFilter","Unexpected error",e),this.onErrorHandler("CDN_CONFIGURATION_ERROR","NO_CONTENT_PROTECTION_FOUND")}return[2]})})},t}(T),Z=function(e){function t(t){var n=e.call(this,t.player,t.error,t.engineStats,h("CDNAdapter"))||this;return n.args=t,n.cdnConfigurationStore=new F,n.disposed=!1,n.onError=function(t,a){var i;n.disposed||((null===(i=v.killswitches)||void 0===i?void 0:i.isWebCryptoFallbackFixEnabled)?e.prototype.onError.call(n,t,a,"EngineReload"):(e.prototype.onError.call(n,t,a),n.error.value={engine:"Shaka",errorName:t,message:a,isFatal:!1,isExpected:!1,fallbackType:"EngineReload"}))},n.onSegmentDecryptionStats=function(e){var t,i,r=null===(t=n.engineStats.value)||void 0===t?void 0:t.minSegmentDecryptionTimeMs,o=null===(i=n.engineStats.value)||void 0===i?void 0:i.maxSegmentDecryptionTimeMs;n.engineStats.value=(0,a.__assign)((0,a.__assign)({},n.engineStats.value),{minSegmentDecryptionTimeMs:r?Math.min(e,r):e,maxSegmentDecryptionTimeMs:o?Math.max(e,o):e})},n.key=t.cdnKey,n}return(0,a.__extends)(t,e),t.prototype.disposeFilters=function(){var e,t,n;!0!==this.disposed?(this.disposed=!0,null===(e=this.decryptionFilter)||void 0===e||e.dispose(),null===(t=this.contentProtectionFilter)||void 0===t||t.dispose(),null===(n=this.keyFetchResponseFilter)||void 0===n||n.dispose()):this.logger.warn("disposeFilters","Trying to dispose CDNAdapter twice")},t.prototype.setupFilters=function(e){var t,n,i,r;return(0,a.__awaiter)(this,void 0,void 0,function(){var o;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return o=null===(t=this.key)||void 0===t?void 0:t.getKeyInfo(),(null===(n=v.killswitches)||void 0===n?void 0:n.isInlineKeyValidityCheckEnabled)&&(this.contentProtectionFilter=new X(this.cdnConfigurationStore,e,this.onError,this.key),this.contentProtectionFilter.register()),(null==o?void 0:o.keyBuffer)&&(null==o?void 0:o.iv)&&(null===(i=this.key)||void 0===i?void 0:i.isValid())?(this.logger.info("setupFilters","Key and iv provided inline"),[4,this.updateConfigWithProvidedKey()]):[3,2];case 1:return a.sent(),[3,3];case 2:this.logger.info("setupFilters","No key provided inline, using manifest key"),(null===(r=v.killswitches)||void 0===r?void 0:r.isInlineKeyValidityCheckEnabled)||(this.contentProtectionFilter=new X(this.cdnConfigurationStore,e,this.onError,this.key),this.contentProtectionFilter.register()),this.keyFetchResponseFilter=new B(this.cdnConfigurationStore,this.aesDecryptor,e,this.onError,this.args.keyAcquirePrefetch),this.keyFetchResponseFilter.register(),a.label=3;case 3:return this.decryptionFilter=new U(this.cdnConfigurationStore,this.aesDecryptor,e,this.onError,this.onSegmentDecryptionStats),this.decryptionFilter.register(),[2]}})})},t.prototype.updateConfigWithProvidedKey=function(){var e;return(0,a.__awaiter)(this,void 0,void 0,function(){var t,n,i;return(0,a.__generator)(this,function(r){switch(r.label){case 0:return t=null===(e=this.key)||void 0===e?void 0:e.getKeyInfo(),[4,this.aesDecryptor.registerKey(null==t?void 0:t.keyBuffer)];case 1:return n=r.sent(),i=(0,a.__assign)((0,a.__assign)({},this.cdnConfigurationStore.get()),{keyId:null==t?void 0:t.keyId,iv:null==t?void 0:t.iv,cryptoKey:n}),this.cdnConfigurationStore.put(i),[2]}})})},t}(P),$=function(){function e(e,t){this.configurationStore=e,this.errorHandler=t,this.logger=h("HybridManager"),this.isHybridReady=!1,this.keyRequested=!1}return e.prototype.validateConfiguration=function(e){var t,n,a=this;if(this.isHybridReady)this.logger.info("validateConfiguration","No validations should be done once the ready state is reached");else try{this.meetReadyRequirements(e)?(this.isHybridReady=!0,this.configurationStore.freeze(),this.logger.info("validateConfiguration","Requirements for hybrid mode are met"),null===(t=this.readyHandler)||void 0===t||t.call(this).catch(function(e){a.logger.error("readyHandler",e),a.errorHandler("CDN_OPERATIONAL_ERROR","UNKNOWN_ERROR")})):this.shouldRequestKey()&&(this.logger.info("validateConfiguration","Waiting for decryption key data"),this.keyRequested=!0,null===(n=this.keysRequiredHandler)||void 0===n||n.call(this).catch(function(e){a.logger.error("keysRequiredHandler",e),a.errorHandler("CDN_CONFIGURATION_ERROR","KEY_FETCH_ERROR")}))}catch(e){this.logger.error("validateConfiguration",e),this.errorHandler("CDN_CONFIGURATION_ERROR","UNKNOWN_ERROR")}},e.prototype.meetReadyRequirements=function(e){return void 0!==e.cryptoKey&&H(null==e?void 0:e.hmac)},e.prototype.shouldRequestKey=function(){return void 0!==this.configurationStore.get().keyId&&!this.keyRequested},Object.defineProperty(e.prototype,"onKeysRequired",{set:function(e){this.keysRequiredHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onReady",{set:function(e){this.readyHandler=e},enumerable:!1,configurable:!0}),e}(),ee=function(){function e(e){this.networkEngine=e,this.disposed=!1,this.applyFilter=this.applyFilter.bind(this)}return e.prototype.register=function(){var e;null===(e=this.networkEngine)||void 0===e||e.registerRequestFilter(this.applyFilter)},e.prototype.dispose=function(){var e;this.disposed||(null===(e=this.networkEngine)||void 0===e||e.unregisterRequestFilter(this.applyFilter),this.disposed=!0)},e}(),te=function(e){function t(t,n){var a=e.call(this,t)||this;return a.onErrorHandler=n,a}return(0,a.__extends)(t,e),t}(ee),ne=function(e){function t(t,n,a){var i=e.call(this,n,a)||this;return i.configurationStore=t,i.logger=h("EncryptedSegmentRequestFilter"),i.applyFilter=i.applyFilter.bind(i),i}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){var n;return(0,a.__generator)(this,function(a){try{if(n=this.configurationStore.get(),!this.isFilterApplicable(e,t,n))return[2];t.uris[0]=this.decorateUrlWithHMAC(n,t.uris[0])}catch(e){throw this.logger.error("applyFilter","Unexpected error",e),this.onErrorHandler("CDN_OPERATIONAL_ERROR","ENCRYPTED_REQUEST_FAILED"),e}return[2]})})},t.prototype.decorateUrlWithHMAC=function(e,t){var n=e.baseUrl?new URL(e.baseUrl):new URL(t);if(!H(null==e?void 0:e.hmac))return this.logger.warn("decorateUrlWithHMAC","HMAC is not valid"),t;var a=null==e?void 0:e.hmac,i=a.docidhash,r=a.p1,o=a.p2,s=a.p3,c=a.p4;if(void 0===e.baseUrl)n.pathname=n.pathname.replace("videotranscode","videotranscode/"+i);else{var d=new URL(t);new URLSearchParams(d.search).forEach(function(e,t){"access_token"!==t&&"tempauth"!==t&&n.searchParams.append(t,e)})}return n.searchParams.append("enableEncryption","1"),n.searchParams.append("enableCdn","1"),n.searchParams.append("p1",r),n.searchParams.append("p2",o),n.searchParams.append("p3",s),n.searchParams.append("p4",c),n.toString()},t.prototype.isFilterApplicable=function(e,t,n){return e===f().net.NetworkingEngine.RequestType.SEGMENT&&1===t.uris.length&&void 0!==(null==n?void 0:n.hmac)},t}(te),ae="generateHMAC=true",ie=function(e){function t(t,n,a){var i=e.call(this,n,a)||this;return i.configurationStore=t,i.logger=h("GenerateHMACRequestFilter"),i.alreadyRequested=!1,i.applyFilter=i.applyFilter.bind(i),i}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(n){try{if(!this.isFilterApplicable(e,t))return[2];t.uris[0]=t.uris[0]+"&".concat(ae),this.alreadyRequested=!0}catch(e){throw this.logger.error("applyFilter","Unexpected error",e),this.onErrorHandler("CDN_CONFIGURATION_ERROR","GENERATE_HMAC_REQUEST_FAILED"),e}return[2]})})},t.prototype.isFilterApplicable=function(e,t){return!0!==this.alreadyRequested&&e===f().net.NetworkingEngine.RequestType.SEGMENT&&(1!==t.uris.length?(this.logger.error("isFilterApplicable","Unable to process more than one Uri at a time"),!1):void 0!==this.configurationStore.get().keyId&&t.uris[0].includes("part=initsegment")&&!t.uris[0].includes(ae))},t}(te),re=function(e){function t(t,n,a){var i=e.call(this,n,a)||this;return i.configurationStore=t,i.logger=h("HMACResponseFilter"),i.applyFilter=i.applyFilter.bind(i),i}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){var n,i,r;return(0,a.__awaiter)(this,void 0,void 0,function(){var o,s;return(0,a.__generator)(this,function(c){try{if(200!==t.status)return this.logger.error("applyFilter","Unexpected status code",null!==(i=null===(n=null==t?void 0:t.status)||void 0===n?void 0:n.toString())&&void 0!==i?i:"undefined"),[2];if(!this.isFilterApplicable(e,t))return[2];if(o=t.headers,s=this.configurationStore.get(),!H(o))throw new Error("HMAC is not valid");this.configurationStore.put((0,a.__assign)((0,a.__assign)({},s),{baseUrl:(null===(r=v.killswitches)||void 0===r?void 0:r.isSPOHybridCdnEnabled)?o["x-cdnbaseurl"]:void 0,hmac:{p1:o.p1,p2:o.p2,p3:o.p3,p4:decodeURIComponent(o.p4),docidhash:o.docidhash}}))}catch(e){this.logger.error("applyFilter","Unexpected error",e),this.onErrorHandler("CDN_CONFIGURATION_ERROR","NO_HMAC_FOUND")}return[2]})})},t.prototype.isFilterApplicable=function(e,t){var n,a;return!(e!==f().net.NetworkingEngine.RequestType.SEGMENT||!this.configurationStore.get().keyId)&&(null===(n=null==t?void 0:t.uri)||void 0===n?void 0:n.includes("part=initsegment"))&&(null===(a=null==t?void 0:t.uri)||void 0===a?void 0:a.includes("generateHMAC=true"))},t}(T),oe=function(e){function t(t){var n=e.call(this,t.player,t.error,t.engineStats,h("HybridCDNAdapter"))||this;return n.disposed=!1,n.cdnConfigurationStore=new F,n.onError=function(t,a){n.disposed||e.prototype.onError.call(n,t,a)},n.playbackReadyObservable=t.playbackReady,n.keyAcquirePrefetch=t.keyAcquirePrefetch,n.keyAcquirer=new N(n.cdnConfigurationStore,n.aesDecryptor),n.hybridManager=new $(n.cdnConfigurationStore,n.onError),n}return(0,a.__extends)(t,e),t.prototype.init=function(){return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(t){switch(t.label){case 0:return[4,e.prototype.init.call(this)];case 1:return t.sent(),this.listenForPlaybackReady(this.playbackReadyObservable),[2]}})})},t.prototype.setupFilters=function(e){return this.generateHMACRequestFilter=new ie(this.cdnConfigurationStore,e,this.onError),this.encryptedSegmentRequestFilter=new ne(this.cdnConfigurationStore,e,this.onError),this.contentProtectionFilter=new X(this.cdnConfigurationStore,e,this.onError),this.hmacResponseFilter=new re(this.cdnConfigurationStore,e,this.onError),this.decryptionFilter=new U(this.cdnConfigurationStore,this.aesDecryptor,e,this.onError),this.contentProtectionFilter.register(),this.generateHMACRequestFilter.register(),this.hmacResponseFilter.register(),Promise.resolve()},t.prototype.disposeFilters=function(){!0!==this.disposed?(this.disposed=!0,this.generateHMACRequestFilter.dispose(),this.encryptedSegmentRequestFilter.dispose(),this.contentProtectionFilter.dispose(),this.hmacResponseFilter.dispose(),this.decryptionFilter.dispose()):this.logger.warn("disposeFilters","Trying to dispose CDNAdapter twice")},t.prototype.listenForPlaybackReady=function(e){var t=this;null==e||e.subscribe(function(e){(null==e?void 0:e.isPlaybackReady)&&t.setupHybridMode()})},t.prototype.setupHybridMode=function(){var e=this;this.cdnConfigurationStore.onUpdateEvent=function(t){e.hybridManager.validateConfiguration(t)},this.hybridManager.onKeysRequired=function(){return e.contentProtectionFilter.dispose(),e.keyAcquirer.fetchKey(e.keyAcquirePrefetch)},this.hybridManager.onReady=function(){return(0,a.__awaiter)(e,void 0,void 0,function(){return(0,a.__generator)(this,function(e){return this.logger.info("setupHybridMode","Enabling hybrid mode"),this.generateHMACRequestFilter.dispose(),this.hmacResponseFilter.dispose(),this.encryptedSegmentRequestFilter.register(),this.decryptionFilter.register(),this.engineStats.value=(0,a.__assign)((0,a.__assign)({},this.engineStats.value),{hasCdnStarted:!0}),[2,Promise.resolve()]})})},this.hybridManager.validateConfiguration(this.cdnConfigurationStore.get())},t}(P),se=function(){function e(e){var t=this;if(this.logger=h("CDNAdapter"),this.disposed=!1,this.cdnConfigurationStore=new F,this.onError=function(e,n){"CDN_OPERATIONAL_ERROR"===e?t.engineStats.value=(0,a.__assign)((0,a.__assign)({},t.engineStats.value),{hasCdnFailed:!0}):"CDN_CONFIGURATION_ERROR"===e&&(t.engineStats.value=(0,a.__assign)((0,a.__assign)({},t.engineStats.value),{hasCdnStarted:!1,cdnConfigError:n})),t.error.value={engine:"Shaka",errorName:e,message:n,isFatal:!1,isExpected:!1,fallbackType:"CDN_CONFIGURATION_ERROR"===e?"NoEngineReload":"EngineReload"}},this.onSegmentDecryptionStats=function(e){var n,i,r=null===(n=t.engineStats.value)||void 0===n?void 0:n.minSegmentDecryptionTimeMs,o=null===(i=t.engineStats.value)||void 0===i?void 0:i.maxSegmentDecryptionTimeMs;t.engineStats.value=(0,a.__assign)((0,a.__assign)({},t.engineStats.value),{minSegmentDecryptionTimeMs:r?Math.min(e,r):e,maxSegmentDecryptionTimeMs:o?Math.max(e,o):e})},this.player=e.player,this.keyAcquirePrefetch=e.keyAcquirePrefetch,this.error=e.error,this.engineStats=e.engineStats,this.registerDashParser(),p.a.isSupported()){var n=this.player.getNetworkingEngine();null!=n?(this.aesDecryptor=new p.a,this.keyAcquirer=new N(this.cdnConfigurationStore,this.aesDecryptor),this.hybridManager=new $(this.cdnConfigurationStore,this.onError),this.setupFilters(n),this.listenForPlaybackReady(e.playbackReady)):this.logger.error("constructor","Shaka does not have a networking engine")}else this.logger.warn("constructor","Platform does not support WebCrypto API. Hybrid cannot be enabled")}return e.prototype.dispose=function(){try{this.disposeFilters(),this.unregisterDashParser(),this.cdnConfigurationStore.clear()}catch(e){this.logger.error("dispose","Failed to dispose CDNAdapter: ".concat(e))}},e.prototype.setupFilters=function(e){this.generateHMACRequestFilter=new ie(this.cdnConfigurationStore,e,this.onError),this.encryptedSegmentRequestFilter=new ne(this.cdnConfigurationStore,e,this.onError),this.contentProtectionFilter=new X(this.cdnConfigurationStore,e,this.onError),this.hmacResponseFilter=new re(this.cdnConfigurationStore,e,this.onError),this.decryptionFilter=new U(this.cdnConfigurationStore,this.aesDecryptor,e,this.onError,this.onSegmentDecryptionStats),this.contentProtectionFilter.register(),this.generateHMACRequestFilter.register(),this.hmacResponseFilter.register()},e.prototype.listenForPlaybackReady=function(e){var t=this;null==e||e.subscribe(function(e){(null==e?void 0:e.isPlaybackReady)&&t.setupHybridMode()})},e.prototype.registerDashParser=function(){e.manifestParserRegister.registerManifestParser()},e.prototype.setupHybridMode=function(){var e=this;this.cdnConfigurationStore.onUpdateEvent=function(t){e.hybridManager.validateConfiguration(t)},this.hybridManager.onKeysRequired=function(){return e.contentProtectionFilter.dispose(),e.keyAcquirer.fetchKey(e.keyAcquirePrefetch)},this.hybridManager.onReady=function(){return(0,a.__awaiter)(e,void 0,void 0,function(){return(0,a.__generator)(this,function(e){return this.logger.info("setupHybridMode","Enabling hybrid mode"),this.generateHMACRequestFilter.dispose(),this.hmacResponseFilter.dispose(),this.encryptedSegmentRequestFilter.register(),this.decryptionFilter.register(),this.engineStats.value=(0,a.__assign)((0,a.__assign)({},this.engineStats.value),{hasCdnStarted:!0}),[2,Promise.resolve()]})})},this.hybridManager.validateConfiguration(this.cdnConfigurationStore.get())},e.prototype.disposeFilters=function(){!0!==this.disposed?(this.disposed=!0,this.generateHMACRequestFilter.dispose(),this.encryptedSegmentRequestFilter.dispose(),this.contentProtectionFilter.dispose(),this.hmacResponseFilter.dispose(),this.decryptionFilter.dispose()):this.logger.warn("disposeFilters","Trying to dispose CDNAdapter twice")},e.prototype.unregisterDashParser=function(){e.manifestParserRegister.unRegisterManifestParser()},e.manifestParserRegister=M(),e}(),ce=function(){function e(){var e=this;this.qualityChangeState=new r.a({}),this.onTrackChangedListener=function(t){e.onTrackChanged(t)},this.onTrackChanged=function(t){var n=de(t.newTrack);e.qualityChangeState.value={currVideoQuality:n.video,currAudioQuality:n.audio,userSelectedQuality:"variantchanged"===t.type}}}return e.prototype.initialize=function(e,t,n){this.player=e,this.defaultTrackLabel=t,this.isRemovingShakaEngineListenersEnabled=n,this.player.addEventListener("adaptation",this.onTrackChangedListener),this.player.addEventListener("variantchanged",this.onTrackChangedListener)},e.prototype.getBandwidthStats=function(){var e,t,n,a,i,r=null===(t=null===(e=this.player)||void 0===e?void 0:e.getStats())||void 0===t?void 0:t.estimatedBandwidth;return this.manifestQualityOptions||(this.manifestQualityOptions=this.getManifestQualityOptions()),{currBandwidthEngineBps:r,manifestQualityOptions:JSON.stringify({video:null===(n=this.manifestQualityOptions)||void 0===n?void 0:n.video,audio:null===(a=this.manifestQualityOptions)||void 0===a?void 0:a.audio}),maxAvailableVideoQuality:null===(i=this.manifestQualityOptions)||void 0===i?void 0:i.maxVideoQuality}},e.prototype.dispose=function(){var e,t;this.manifestQualityOptions=void 0,this.isRemovingShakaEngineListenersEnabled&&(null===(e=this.player)||void 0===e||e.removeEventListener("adaptation",this.onTrackChangedListener),null===(t=this.player)||void 0===t||t.removeEventListener("variantchanged",this.onTrackChangedListener)),this.player=void 0,this.qualityChangeState.unsubscribeAll(),this.qualityChangeState.value={}},e.prototype.getManifestQualityOptions=function(){var e,t,n=null===(e=this.player)||void 0===e?void 0:e.getVariantTracks();if(n&&0!==n.length){var a=new Set,i=new Set,r=null!==(t=this.defaultTrackLabel)&&void 0!==t?t:n[0].label;return n.forEach(function(e){if(void 0===e.label||e.label===r){var t=de(e);t.audio&&i.add(t.audio),t.video&&a.add(t.video)}}),{video:Array.from(a),audio:Array.from(i),maxVideoQuality:Array.from(a)[a.size-1]}}},e}();function de(e){var t,n;return{audio:null!==(t=e.originalAudioId)&&void 0!==t?t:void 0,video:null!==(n=e.originalVideoId)&&void 0!==n?n:void 0}}var le=function(){function e(e,t,n){this.player=e,this.track=t,this.isVideoQualityAudioTrackFixEnabled=n}return e.prototype.getQualities=function(){var e,t=this,n=this.getVariantsFromPlayer();if(0===n.size)return[];var a=[],i=new Map;return n.forEach(function(e){var n;if(e.height&&e.width&&(null===(n=v.killswitches)||void 0===n?void 0:n.isPremiumVideoStreamingFeatureEnabled)){var r=Math.min(e.height,e.width);(o={bitrate:e.bandwidth,label:t.getTrackLabel(e),selectable:!0}).definitionDecorator=r>=1080&&r<2160?"HD":2160===r?"4K":void 0,t.player.isAudioOnly()?a.push(o):t.handleDuplicateQualityOptions(i,o,a,e)}else if(t.player.isAudioOnly())a.push({bitrate:e.bandwidth,label:t.getTrackLabel(e),selectable:!0});else{var o={bitrate:e.bandwidth,label:t.getTrackLabel(e),selectable:!0};t.handleDuplicateQualityOptions(i,o,a,e)}}),(!(null===(e=v.killswitches)||void 0===e?void 0:e.isAutoQualityLabelFixEnabled)||a.length>1)&&a.unshift({bitrate:-1,label:"Auto",selectable:!0}),a},e.prototype.selectPlaybackQuality=function(e){if(-1!==e&&void 0!==e){var t=this.searchVariantByBitrate(e);t&&(this.player.selectVariantTrack(t,!0),this.switchAdaptiveConfig(!1))}else this.switchAdaptiveConfig(!0)},e.prototype.getVariantsFromPlayer=function(){var e,t=this,n=this.player.getVariantTracks();return void 0!==(null===(e=this.track)||void 0===e?void 0:e.value)&&(n=n.filter(function(e){var n;return(null===(n=t.track.value)||void 0===n?void 0:n.label)===e.label||t.track.value===e.label||!e.label})),this.player.isAudioOnly()?this.convertToTrackMap(n,function(e){return e.bandwidth}):this.convertToTrackMap(n,function(e){return e.height&&e.width?Math.min(e.height,e.width):e.height})},e.prototype.convertToTrackMap=function(e,t){var n=new Map;return e&&0!==e.length?(e.filter(function(e){return null!==t(e)}).sort(function(e,n){var a,i;return(null!==(a=t(e))&&void 0!==a?a:0)-(null!==(i=t(n))&&void 0!==i?i:0)}).forEach(function(e){var a=String(t(e))+e.originalVideoId+e.bandwidth;a&&n.set(a,e)}),n):n},e.prototype.getTrackLabel=function(e){return this.player.isAudioOnly()?this.toKbitsPerSecond(e.bandwidth):e.originalVideoId?this.deriveTrackLabelFromOriginalVideoId(e.originalVideoId):e.width&&e.height?Math.min(e.height,e.width)+"p":e.height+"p"},e.prototype.handleDuplicateQualityOptions=function(e,t,n,a){var i=this;e.has(t.label)?(e.get(t.label)||n.forEach(function(e){e.label===t.label&&(e.label=e.label+i.updateTrackLabel(e.bitrate))}),e.set(t.label,!0),t.label=t.label+this.updateTrackLabel(a.bandwidth)):e.set(t.label,!1),n.push(t)},e.prototype.updateTrackLabel=function(e){return" (".concat(Math.round(e/1e3)," kbps)")},e.prototype.toKbitsPerSecond=function(e){return"".concat(e/1e3," kbits/s")},e.prototype.searchVariantByBitrate=function(e){var t=this,n=this.player.getVariantTracks();if(n&&0!==n.length)return this.isVideoQualityAudioTrackFixEnabled?n.find(function(n){var a,i;return n.bandwidth===e&&(I(null===(a=t.track)||void 0===a?void 0:a.value)||I(n.label)||n.label===(null===(i=t.track.value)||void 0===i?void 0:i.label))}):n.find(function(n){var a;return n.bandwidth===e&&(I(null===(a=t.track)||void 0===a?void 0:a.value)||I(n.label)||n.label===t.track.value)})},e.prototype.switchAdaptiveConfig=function(e){this.player.configure({abr:{enabled:e}})},e.prototype.deriveTrackLabelFromOriginalVideoId=function(e){return e.startsWith("vp")?e.substring(2):e.startsWith("v")?e.substring(1):e},e}(),ue="X-OnePlayer-Instance-Id",fe=function(e){function t(t,n){var a=e.call(this,n)||this;return a.instanceId=t,a.logger=h("RequestHeaderFilter"),a}return(0,a.__extends)(t,e),t.prototype.applyFilter=function(e,t){var n;return(0,a.__awaiter)(this,void 0,void 0,function(){return(0,a.__generator)(this,function(a){return(null===(n=v.killswitches)||void 0===n?void 0:n.isShakaRequestBaseEnabled)?this.applyFilterV2(e,t):this.applyFilterV1(e,t),[2]})})},t.prototype.applyFilterV1=function(e,t){try{if(!this.validateFilterRun(e))return;this.addInformationToRequest(e,t)}catch(e){return void this.logger.error("applyFilter","Unexpected error",e)}},t.prototype.applyFilterV2=function(e,t){try{if(!this.validateFilterRun(e))return;t.playerInstanceId=this.instanceId,this.addInformationToRequest(e,t)}catch(e){return void this.logger.error("applyFilter","Unexpected error",e)}},t.prototype.validateFilterRun=function(e){return!!this.isInstanceIdFilterApplicable(e)||(this.logger.info("applyFilter","Instance Id filter not applicable: ".concat(e)),!1)},t.prototype.addInformationToRequest=function(e,t){var n;this.instanceId||this.logger.info("applyFilter","Instance Id is invalid"),t.headers[ue]=this.instanceId,(null===(n=v.killswitches)||void 0===n?void 0:n.isPlayerNameTelemetryEnabled)&&this.isPlayerNameFilterApplicable(e)&&t.uris&&t.uris[0]&&-1===t.uris[0].indexOf("pn=hostApp-OnePlayer-Web")&&(t.headers.pn="hostApp-OnePlayer-Web")},t.prototype.isInstanceIdFilterApplicable=function(e){return e===f().net.NetworkingEngine.RequestType.SEGMENT||e===f().net.NetworkingEngine.RequestType.MANIFEST},t.prototype.isPlayerNameFilterApplicable=function(e){return e===f().net.NetworkingEngine.RequestType.MANIFEST},t}(ee),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.register=function(e,n){var a;if(!(null===(a=v.killswitches)||void 0===a?void 0:a.isShakaInstanceIdMapEnabled))return t.preparser=e,void me();n?(0===this.preparserMap.size&&me(),this.preparserMap.set(n,e),_e().info("register","registering instanceId ".concat(n,", full list: ").concat(Array.from(this.preparserMap.keys())))):_e().error("register","instanceId is not given")},t.parse=function(n,a,i,r,o){var s,c,d,l=this;if(void 0===a.uris||0===a.uris.length)throw Error("request uris empty or undefined");var u=0,f=function(){return e.parse.call(l,a.uris[0],a,i,function(e,t,n){var a=Date.now()-u;return u=Date.now(),r(a,t,n)},function(e){return u=Date.now(),o(e)})};if(!(null===(s=v.killswitches)||void 0===s?void 0:s.isShakaInstanceIdMapEnabled))return t.preparser?t.preparser.parse(n,a,i,f,o):f();var p=(null===(c=v.killswitches)||void 0===c?void 0:c.isShakaRequestBaseEnabled)?null==a?void 0:a.playerInstanceId:void 0;(null===(d=v.killswitches)||void 0===d?void 0:d.isShakaRequestBaseEnabled)&&!p&&_e().warn("parse","The instanceId is not found from the request attribute 'playerInstanceId'.");var m=null!=p?p:a.headers[ue];m&&a.headers[ue]&&delete a.headers[ue];var _=m?t.preparserMap.get(m):void 0;return _?_.parse(n,a,i,f,o):(t.instIdMissingLogged||(_e().warn("parse","unidentified instanceId: ".concat(m,", requestType: ").concat(i)),t.instIdMissingLogged=!0),f())},t.dispose=function(e){t.instIdMissingLogged=!1,t.preparserMap.delete(e),t.preparser=void 0,0===t.preparserMap.size&&f().net.NetworkingEngine.unregisterScheme("https"),_e().info("register","unregistered instanceId ".concat(e,", full list: ").concat(Array.from(this.preparserMap.keys())))},t.preparserMap=new Map,t.instIdMissingLogged=!1,t}(f().net.HttpFetchPlugin);function me(){f().net.NetworkingEngine.registerScheme("https",pe.parse,f().net.NetworkingEngine.PluginPriority.PREFERRED,!0)}function _e(){return h("ShakaOnePlayerEngine")}var he=function(){function e(e){this.next=e}return e.prototype.nextParser=function(e){return this.next=e,e},e.prototype.parse=function(e,t,n,a,i){return this.next?this.next.parse(e,t,n,a,i):a()},e}();function be(e,t,n){return{uri:n,originalUri:n,data:t,status:200,headers:e,fromCache:!1}}function ge(e,t,n,i,r,o){var s=this;return new(f().util.AbortableOperation)(t,function(){return Promise.resolve()}).chain(function(t){return(0,a.__awaiter)(s,void 0,void 0,function(){var s,c;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return t instanceof Response?[4,t.arrayBuffer()]:[3,2];case 1:return s=a.sent(),[3,3];case 2:s=null==t?void 0:t.arrBuf,a.label=3;case 3:return s&&t&&200===(null==t?void 0:t.status)?((null==r?void 0:r.onAccept)&&r.onAccept(ve(e,o)),c=function(e){if(null==e)return{};if(e instanceof Headers){var t={};return e.forEach(function(e,n){t[n]=e}),t}return e}(t.headers),i(c),[2,be(c,s,e)]):[2,n().promise]}})})},function(t){return(null==r?void 0:r.onReject)&&r.onReject(ve(e,o),t),n()})}function ve(e,t){var n;return(null===(n=v.killswitches)||void 0===n?void 0:n.isPrefetchingUrlLogged)?null!=t?t:"":e}function ye(e,t,n,a,i){var r;return(null==a?void 0:a.prefetchedManifest)||i?ge(e,null!==(r=null==a?void 0:a.prefetchedManifest)&&void 0!==r?r:i,t,n,a,"VideoManifest"):t()}var Se=function(e){function t(t){return e.call(this,t)||this}return(0,a.__extends)(t,e),t.prototype.initialize=function(e){this.options=e},t.prototype.reset=function(){this.options=void 0},t.prototype.parse=function(t,n,a,i,r){var o=this;return this.options?a===f().net.NetworkingEngine.RequestType.MANIFEST&&this.options.prefetchedManifest?ye(t,function(){return e.prototype.parse.call(o,t,n,a,i,r)},r,this.options):a===f().net.NetworkingEngine.RequestType.SEGMENT&&this.options.prefetchedMediaSegments?this.processSegmentRequest(t,function(){return e.prototype.parse.call(o,t,n,a,i,r)},r):e.prototype.parse.call(this,t,n,a,i,r):e.prototype.parse.call(this,t,n,a,i,r)},t.prototype.processSegmentRequest=function(e,t,n){var a,i,r=null===(i=null===(a=this.options)||void 0===a?void 0:a.prefetchedMediaSegments)||void 0===i?void 0:i.filter(function(t){return t.matcher(e)});return r&&0!==r.length?ge(e,r[0].segmentData,t,n,this.options,"segment"):t()},t}(he),De={init:function(e,t,n,a){De.reset(),De._variantsUpdater=e,De._getEngineEst=t,De._track=n,De._minQualityId=a},reset:function(){var e;De._active=!1,De._minBandwidth=void 0,De._fullVariants=void 0,De._higherVariants=void 0,(null===(e=v.killswitches)||void 0===e?void 0:e.isEngineMemLeakRemoved)&&(De._track=void 0)},onVariantsDetected:function(e){var t,n,a,i,r,o,s;if(void 0!==De._minQualityId){De.reset(),De._fullVariants=[],De._higherVariants=[];for(var c="",d=!1,l=0,u=e;l<u.length;l++){var f=u[l];xe(f,De._track)&&!I(null===(t=f.video)||void 0===t?void 0:t.originalId)&&(De._fullVariants.push(f),Ie(f,De._minQualityId)?d=!0:((void 0===De._minBandwidth||De._minBandwidth>f.bandwidth)&&(De._minBandwidth=f.bandwidth),De._higherVariants.push(f),c+="".concat(null!==(a=null===(n=f.audio)||void 0===n?void 0:n.originalId)&&void 0!==a?a:"","-").concat(null!==(r=null===(i=f.audio)||void 0===i?void 0:i.label)&&void 0!==r?r:"","-").concat(null!==(s=null===(o=f.video)||void 0===o?void 0:o.originalId)&&void 0!==s?s:"",";")))}if(d){var p="onVariantsDetected";De.logger().info(p,"minBandwidth = ".concat(De._minBandwidth)),De.logger().info(p,"onVariantsDetected","higherVariants = ".concat(c))}else De._minBandwidth=void 0}},overrideVariantSelection:function(){if(void 0!==De._minBandwidth){var e=Ce();if(void 0!==e)if(e>=De._minBandwidth)!function(e){var t;De._active||(De._active=!0,De.logger().info("overrideVariantSelection","restricted. downlink:".concat(e)),null===(t=De._variantsUpdater)||void 0===t||t.call(De,De._higherVariants))}(e);else{if(!De._active)return;!function(e){var t;De._active=!1,De.logger().info("overrideVariantSelection","non-restricted. downlink:".concat(e)),null===(t=De._variantsUpdater)||void 0===t||t.call(De,De._fullVariants)}(e)}}},onVariantSelected:function(e){var t,n;if(De._minQualityId&&Ie(e,De._minQualityId)){var a=Ce(),i=null===(t=De._getEngineEst)||void 0===t?void 0:t.call(De);De.logger().info("onVariantSelected","".concat(null===(n=e.video)||void 0===n?void 0:n.originalId," selected. downlink:").concat(a," engineEst:").concat(i," minBandwidth: ").concat(De._minBandwidth))}},logger:function(){return De._logger||(De._logger=h("QualityRestrictionHelper")),De._logger}};function Ie(e,t){var n;return!I(null===(n=e.video)||void 0===n?void 0:n.originalId)&&e.video.originalId.localeCompare(t,void 0,{numeric:!0})<0}function xe(e,t){var n,a;return I(null===(n=e.audio)||void 0===n?void 0:n.label)||I(null==t?void 0:t.value)||(null===(a=e.audio)||void 0===a?void 0:a.label)===(null==t?void 0:t.value)}function Ce(){var e,t=null===(e=null===navigator||void 0===navigator?void 0:navigator.connection)||void 0===e?void 0:e.downlink;if(!I(t))return t?1e6*t:void 0}var Oe=De,we=function(e){function t(t,n,a,i,r){var o=e.call(this)||this;return o.prefetchedQualityToMatch=t,o.defaultLabel=n,o.minVideoBandwidth=a,o.minVideoQualityIdForAbr=i,o.track=r,void 0!==o.minVideoQualityIdForAbr&&(o.qualityRestrictionHelper=Oe,Oe.init(function(t){return t&&e.prototype.setVariants.call(o,t)},function(){return e.prototype.getBandwidthEstimate.call(o)},r,o.minVideoQualityIdForAbr)),o}return(0,a.__extends)(t,e),t.prototype.chooseVariant=function(){var t,n,a;this.prefetchedQualityToMatch||null===(t=this.qualityRestrictionHelper)||void 0===t||t.overrideVariantSelection();var i=e.prototype.chooseVariant.call(this);if(this.prefetchedQualityToMatch||null===(n=this.qualityRestrictionHelper)||void 0===n||n.onVariantSelected(i),!this.prefetchedQualityToMatch||i.bandwidth===this.prefetchedQualityToMatch)return i;if(!this.variants||0===this.variants.length)throw new Error("variants not set");return this.desiredVariantForPrefetch||(this.desiredVariantForPrefetch=null!==(a=this.findPrefetchingMatchedVariants())&&void 0!==a?a:this.variants[0]),this.desiredVariantForPrefetch},t.prototype.setVariants=function(t){var n,a=this.filterVariantsWithMinQuality(t);e.prototype.setVariants.call(this,a),this.variants=a,null===(n=this.qualityRestrictionHelper)||void 0===n||n.onVariantsDetected(a)},t.prototype.resumeAbr=function(){this.prefetchedQualityToMatch=void 0},t.prototype.reset=function(){var e,t;this.prefetchedQualityToMatch=void 0,null===(e=this.qualityRestrictionHelper)||void 0===e||e.reset(),(null===(t=v.killswitches)||void 0===t?void 0:t.isEngineMemLeakRemoved)&&(this.track=void 0,this.variants=void 0,this.qualityRestrictionHelper=void 0,this.desiredVariantForPrefetch=void 0)},t.prototype.findPrefetchingMatchedVariants=function(){if(this.variants)for(var e=0;e<this.variants.length;e++)if(this.variants[e].bandwidth===this.prefetchedQualityToMatch)return this.variants[e]},t.prototype.filterVariantsWithMinQuality=function(e){var t=this,n=e;return void 0!==this.minVideoBandwidth&&(null==n?void 0:n.length)>1&&(!(n=n.filter(function(e){return!e.video||void 0===t.minVideoBandwidth||(e.video.bandwidth||0)>=t.minVideoBandwidth}))||n.length<=0)&&(n=e),n},t}(f().abr.SimpleAbrManager),Ee=1002,Ae="NETWORK_DOWN",Le="NETWORK_EXCEPTION",ke=new Map([["1000","UNSUPPORTED_SCHEME"],["1001","HTTP_STATUS_"],["".concat(Ee),"HTTP_ERROR"],["1003","TIMEOUT"],["1004","MALFORMED_DATA_URI"],["1006","REQUEST_FILTER_ERROR"],["1007","RESPONSE_FILTER_ERROR"],["1010","ATTEMPTS_EXHAUSTED"],["2000","INVALID_TEXT_HEADER"],["2001","INVALID_TEXT_CUE"],["2003","UNABLE_TO_DETECT_ENCODING"],["2004","BAD_ENCODING"],["2005","INVALID_XML"],["2007","INVALID_MP4_TTML"],["2008","INVALID_MP4_VTT"],["2010","INVALID_MP4_CEA"],["2011","TEXT_COULD_NOT_GUESS_MIME_TYPE"],["2013","TEXT_ONLY_WEBVTT_SRC_EQUALS"],["2014","MISSING_TEXT_PLUGIN"],["3000","BUFFER_READ_OUT_OF_BOUNDS"],["3001","JS_INTEGER_OVERFLOW"],["3002","EBML_OVERFLOW"],["3003","EBML_BAD_FLOATING_POINT_SIZE"],["3004","MP4_SIDX_WRONG_BOX_TYPE"],["3005","MP4_SIDX_INVALID_TIMESCALE"],["3006","MP4_SIDX_TYPE_NOT_SUPPORTED"],["3007","WEBM_CUES_ELEMENT_MISSING"],["3008","WEBM_EBML_HEADER_ELEMENT_MISSING"],["3009","WEBM_SEGMENT_ELEMENT_MISSING"],["3010","WEBM_INFO_ELEMENT_MISSING"],["3011","WEBM_DURATION_ELEMENT_MISSING"],["3012","WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING"],["3013","WEBM_CUE_TIME_ELEMENT_MISSING"],["3014","MEDIA_SOURCE_OPERATION_FAILED"],["3015","MEDIA_SOURCE_OPERATION_THREW"],["3016","VIDEO_ERROR"],["3017","QUOTA_EXCEEDED_ERROR"],["3018","TRANSMUXING_FAILED"],["3019","CONTENT_TRANSFORMATION_FAILED"],["4000","UNABLE_TO_GUESS_MANIFEST_TYPE"],["4001","DASH_INVALID_XML"],["4002","DASH_NO_SEGMENT_INFO"],["4003","DASH_EMPTY_ADAPTATION_SET"],["4004","DASH_EMPTY_PERIOD"],["4005","DASH_WEBM_MISSING_INIT"],["4006","DASH_UNSUPPORTED_CONTAINER"],["4007","DASH_PSSH_BAD_ENCODING"],["4008","DASH_NO_COMMON_KEY_SYSTEM"],["4009","DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED"],["4010","DASH_CONFLICTING_KEY_IDS"],["4012","RESTRICTIONS_CANNOT_BE_MET"],["4018","DASH_DUPLICATE_REPRESENTATION_ON_ID"],["4027","DASH_UNSUPPORTED_XLINK_ACTUATE"],["4028","DASH_XLINK_DEPTH_LIMIT"],["4032","CONTENT_UNSUPPORTED_BY_BROWSER"],["4033","CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM"],["4036","NO_VARIANTS"],["4038","INCONSISTENT_DRM_ACROSS_PERIODS"],["6000","NO_RECOGNIZED_KEY_SYSTEMS"],["6001","REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE"],["7000","LOAD_INTERRUPTED"],["7001","OPERATION_ABORTED"],["7002","NO_VIDEO_ELEMENT"],["7003","OBJECT_DESTROYED"],["7004","CONTENT_NOT_LOADED"]]),Me=new Map([["UNSUPPORTED_SCHEME",!1],["HTTP_STATUS_400",!1],["HTTP_STATUS_401",!1],["HTTP_STATUS_403",!0],["HTTP_STATUS_404",!0],["HTTP_STATUS_406",!1],["HTTP_STATUS_407",!1],["HTTP_STATUS_412",!0],["HTTP_STATUS_415",!0],["HTTP_STATUS_429",!0],["HTTP_STATUS_500",!1],["HTTP_STATUS_502",!1],["HTTP_STATUS_503",!1],["HTTP_STATUS_504",!1],["HTTP_ERROR",!1],["TIMEOUT",!0],["MALFORMED_DATA_URI",!1],["LOAD_INTERRUPTED",!0],["REQUEST_FILTER_ERROR",!1],["RESPONSE_FILTER_ERROR",!1],["INVALID_TEXT_HEADER",!1],["INVALID_TEXT_CUE",!1],["UNABLE_TO_DETECT_ENCODING",!1],["BAD_ENCODING",!1],["TEXT_COULD_NOT_GUESS_MIME_TYPE",!1],["TEXT_ONLY_WEBVTT_SRC_EQUALS",!1],["MISSING_TEXT_PLUGIN",!1],["BUFFER_READ_OUT_OF_BOUNDS",!1],["JS_INTEGER_OVERFLOW",!1],["EBML_OVERFLOW",!1],["EBML_BAD_FLOATING_POINT_SIZE",!1],["MP4_SIDX_WRONG_BOX_TYPE",!1],["MP4_SIDX_INVALID_TIMESCALE",!1],["WEBM_CUES_ELEMENT_MISSING",!1],["WEBM_EBML_HEADER_ELEMENT_MISSING",!1],["WEBM_SEGMENT_ELEMENT_MISSING",!1],["WEBM_INFO_ELEMENT_MISSING",!1],["WEBM_DURATION_ELEMENT_MISSING",!1],["WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING",!1],["WEBM_CUE_TIME_ELEMENT_MISSING",!1],["MEDIA_SOURCE_OPERATION_FAILED",!1],["MEDIA_SOURCE_OPERATION_THREW",!1],["VIDEO_ERROR",!1],["QUOTA_EXCEEDED_ERROR",!1],["TRANSMUXING_FAILED",!1],["CONTENT_TRANSFORMATION_FAILED",!1],["UNABLE_TO_GUESS_MANIFEST_TYPE",!1],["DASH_INVALID_XML",!1],["DASH_NO_SEGMENT_INFO",!1],["DASH_EMPTY_ADAPTATION_SET",!1],["DASH_EMPTY_PERIOD",!1],["DASH_WEBM_MISSING_INIT",!1],["DASH_UNSUPPORTED_CONTAINER",!1],["DASH_PSSH_BAD_ENCODING",!1],["DASH_NO_COMMON_KEY_SYSTEM",!1],["DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED",!1],["DASH_CONFLICTING_KEY_IDS",!1],["RESTRICTIONS_CANNOT_BE_MET",!1],["DASH_DUPLICATE_REPRESENTATION_ID",!1],["DASH_UNSUPPORTED_XLINK_ACUTATE",!1],["DASH_XLINK_DEPTH_LIMIT",!1],["CONTENT_UNSUPPORTED_BY_BROWSER",!1],["CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM",!1],["NO_VARIANTS",!1],["NO_RECOGNIZED_KEY_SYSTEMS",!1],["REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE",!1],["PERIOD_FLATTENING_FAILED",!1],["INCONSISTENT_DRM_ACROSS_PEROIDS",!1],["STREAMING_ENGINE_STATRTUP_INVALID_STATE",!1],["OPERATION_ABORTED",!1],["NO_VIDEO_ELEMENT",!1],["OBJECT_DESTROYED",!1],["CONTENT_NOT_LOADED",!1],[Ae,!0],[Le,!1]]),Pe=["ByteStreamTypeNotSupported"];function Te(e){var t=Me.get(e);return null!=t&&t}function Ue(e,t){var n,a,i,r,o;if(t.includes("HTTP_STATUS_")&&(null===(n=e.data)||void 0===n?void 0:n.length)>2){var s=void 0;try{s=JSON.parse(e.data[2])}catch(t){s=e.data[2]instanceof String?e.data[2]:""}return((null===(i=null===(a=null==s?void 0:s.error)||void 0===a?void 0:a.innererror)||void 0===i?void 0:i.code)?s.error.innererror.code+" ":"")+(null!==(o=null===(r=null==s?void 0:s.error)||void 0===r?void 0:r.message)&&void 0!==o?o:"")}return""}var Fe=function(){function e(e,t,n,a){var i,r,o=this;this.player=e,this.heuristicSettings=t,this.onRecovered=n,this.dashConfig=a,this.configEnabled=!1,this.retryTimes=0,this.logger=h("HttpErrorRetryConfigurator"),this._isFalbackFromHttpError=!1,this.onRetry=function(){o.configEnabled&&o.retryTimes++},null===(r=null===(i=this.player)||void 0===i?void 0:i.getNetworkingEngine())||void 0===r||r.addEventListener("retry",this.onRetry)}return Object.defineProperty(e.prototype,"isFalbackFromHttpError",{get:function(){return this._isFalbackFromHttpError},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e,t;null===(t=null===(e=this.player)||void 0===e?void 0:e.getNetworkingEngine())||void 0===t||t.removeEventListener("retry",this.onRetry),this.configEnabled=!1,this.player=void 0,this.heuristicSettings=void 0,this.prevDownloadFailTimeMs=void 0,this.retryTimes=0,this.watchingTrack=void 0},e.prototype.onDownloadFailed=function(e){var t;this.prevDownloadFailTimeMs=O.now(),this.shouldEnableConfigForErr(null==e?void 0:e.code)&&!this.configEnabled&&((null===(t=v.killswitches)||void 0===t?void 0:t.isRetryStreamingOnNetErrEnabled)||this.enableConfig())},e.prototype.onShakaError=function(e){var t,n,a;if(!this.shouldEnableConfigForErr(null==e?void 0:e.code)||!e.data||!e.data[0])return!1;var i=null===(n=null===(t=this.dashConfig)||void 0===t?void 0:t.getSegmentMetadataFromUrl(e.data[0],{track:!0}))||void 0===n?void 0:n.track;if(!i)return this.logger.info("onShakaError","passthrough - unable retrieve track info"),!1;if(this.watchingTrack){if(this.watchingTrack!==i)return this.logger.info("onShakaError","ignore - watching track(".concat(this.watchingTrack,") != error track(").concat(i,")")),!0}else this.watchingTrack=i,this.logger.info("onShakaError","watching for track(".concat(this.watchingTrack,")"));return this.configEnabled?(this.logger.info("onShakaError","passthrough - error happens again after apply config"),this.watchingTrack=void 0,!1):(this.enableConfig(),null===(a=this.player)||void 0===a||a.retryStreaming(),this.logger.info("onShakaError","called retryStreaming() with new config"),!0)},e.prototype.onResponseReceived=function(){var e,t,n;this.configEnabled&&void 0!==this.prevDownloadFailTimeMs&&(O.now()-this.prevDownloadFailTimeMs<2e4||(null===(e=this.player)||void 0===e||e.configure({streaming:{retryParameters:Re(this.heuristicSettings),segmentPrefetchLimit:null===(t=this.heuristicSettings)||void 0===t?void 0:t.maxConcurrentSegmentCalls,maxDisabledTime:He()}}),this.configEnabled=!1,this.watchingTrack=void 0,null===(n=this.onRecovered)||void 0===n||n.call(this,this.retryTimes),this.logger.info("onResponseReceived","recovered")))},e.prototype.tryUpdateIsFalbackFromHttpError=function(e){e instanceof f().util.Error&&e.code&&e.code===Ee&&(this._isFalbackFromHttpError=e.code===Ee)},e.prototype.enableConfig=function(){var e,t,n=null===(e=this.heuristicSettings)||void 0===e?void 0:e.networkErrorRetry;n&&!this.configEnabled&&(null===(t=this.player)||void 0===t||t.configure({streaming:{retryParameters:Re(n),segmentPrefetchLimit:0,maxDisabledTime:He()}}),this.configEnabled=!0,this.retryTimes=0)},e.prototype.shouldEnableConfigForErr=function(e){var t;return void 0!==this.player&&void 0!==(null===(t=this.heuristicSettings)||void 0===t?void 0:t.networkErrorRetry)&&!C()&&e===Ee},e}();function He(){var e;return(null===(e=v.killswitches)||void 0===e?void 0:e.isRetryStreamingOnNetErrEnabled)?0:void 0}function Re(e){return{maxAttempts:g(null==e?void 0:e.maxHttpRetries),backoffFactor:g(null==e?void 0:e.httpRetryBackoffFactor)}}var Ne=function(){function e(e,t,n,a,i,r,o,s){var c=this;this.player=e,this.parser=t,this.playbackReady=n,this.defaultLabel=a,this.minVideoBandwidth=i,this.track=r,this.settings=o,this.loadSummaryCalc=s,this.logger=h("StartupResourceManager"),this.playbackReadyReached=!1,this.initPlaybackPhase=function(){var e;c.player.configure({abr:{useNetworkInformation:!0},streaming:c.getStreamingConfig()}),c.parser.reset(),null===(e=c.abrManager)||void 0===e||e.resumeAbr()}}return e.prototype.registerResourceWithPrefetch=function(e){var t;return(0,a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o=this;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),n=void 0,e.mediaSegments?[4,e.mediaSegments]:[3,2];case 1:i=a.sent(),null===(t=this.loadSummaryCalc)||void 0===t||t.reachedStep("manifestLoaded"),i&&(this.setupAbrManager(i),n=i||void 0),a.label=2;case 2:return this.parser.initialize({prefetchedManifest:e.mediaManifest,prefetchedMediaSegments:null==n?void 0:n.segments,onAccept:function(e){o.logger.debug("registerResourceWithPrefetch","accepted prefetched resource "+e)},onReject:function(e,t){o.logger.debug("registerResourceWithPrefetch","rejected prefetched resource ".concat(e,": ").concat(t))}}),[2,null==n?void 0:n.metadata];case 3:return r=a.sent(),this.logger.error("registerResourceWithPrefetch",r),[3,4];case 4:return[2]}})})},e.prototype.registerResourcesWithoutPrefetch=function(){this.setupAbrManager()},e.prototype.reset=function(){var e,t;this.parser.reset(),null===(e=this.abrManager)||void 0===e||e.reset(),(null===(t=v.killswitches)||void 0===t?void 0:t.isEngineMemLeakRemoved)&&(this.abrManager=void 0),this.playbackReadyReached=!1},e.prototype.setupAbrManager=function(e){var t,n,a,i,r=this,o=void 0;if((null===(t=v.killswitches)||void 0===t?void 0:t.isAvoidLowQualityEnabled)&&(o="v480p"),this.abrManager=new we(null==e?void 0:e.mediaBitrate,this.defaultLabel,this.minVideoBandwidth,o,this.track),void 0===e)return(null===(n=v.killswitches)||void 0===n?void 0:n.isAbrManagerUsedWithoutPrefetch)&&(null===(a=v.killswitches)||void 0===a?void 0:a.isAvoidLowQualityEnabled)&&this.player&&this.player.configure({abrFactory:function(){return r.abrManager}}),void((null===(i=v.killswitches)||void 0===i?void 0:i.isFallbackParallelFetchEnabled)&&this.fallbackConfiguration());this.player.configure({abr:{useNetworkInformation:!1,defaultBandwidthEstimate:e.mediaBitrate},abrFactory:function(){return r.abrManager}}),this.playbackReady.subscribe(function(e){(null==e?void 0:e.isPlaybackReady)&&!r.playbackReadyReached&&(r.initPlaybackPhase(),r.playbackReadyReached=!0)})},e.prototype.fallbackConfiguration=function(){var e,t,n,a=this,i={streaming:this.getStreamingConfig()};(null===(e=v.killswitches)||void 0===e?void 0:e.isPBReadyDashParallelFetchDefault)&&!0===(null===(n=null===(t=this.playbackReady)||void 0===t?void 0:t.value)||void 0===n?void 0:n.isPlaybackReady)?this.player.configure(i):this.playbackReady.subscribe(function(e){(null==e?void 0:e.isPlaybackReady)&&a.player.configure(i)},{ignoreCurrentValue:!0})},e.prototype.getStreamingConfig=function(){var e,t={segmentPrefetchLimit:g(null===(e=this.settings)||void 0===e?void 0:e.maxConcurrentSegmentCalls),maxDisabledTime:He()};return this.logger.info("getStreamingConfig","streaming config applied: ".concat(JSON.stringify(t))),t},e}(),Be=function(e){function t(t,n){var a=e.call(this,n)||this;return a.getRequestParamsAsync=t,a.logger=h("RefreshTokenDataPreparser"),a}return(0,a.__extends)(t,e),t.prototype.parse=function(t,n,a,r,o){var s=this;return t.includes("_api_cached")?e.prototype.parse.call(this,t,n,a,r,o):new(f().util.AbortableOperation)(this.getRequestParamsAsync(t).catch(function(e){throw(0,c.d)(i.a,e)}),function(){return Promise.resolve()}).chain(function(i){var c;return i?(n.uris=[i.url],i.headers&&Object.keys(i.headers).forEach(function(e){n.headers[e]=(null==i?void 0:i.headers)?i.headers[e]:n.headers[e]})):s.logger.info("parse","Instance of requestUpdateData is invalid."),e.prototype.parse.call(s,null!==(c=null==i?void 0:i.url)&&void 0!==c?c:t,n,a,r,o)},function(e){throw s.logger.error("parse","Error while fetching request params."),e})},t}(he),je=function(e){function t(t){var n=e.call(this,t)||this;return n.stats={startupSegmentsFetched:0,startupSegmentsAsked:0,startupSegmentsWaited:0},n.stopTracking=!1,n.trackStats=function(e,t){if(!n.stopTracking&&e===f().net.NetworkingEngine.RequestType.SEGMENT)switch(t){case"Asked":n.stats.startupSegmentsAsked++;break;case"Fetched":n.stats.startupSegmentsFetched++;break;case"Waited":n.stats.startupSegmentsWaited++}},n}return(0,a.__extends)(t,e),t.prototype.parse=function(t,n,a,i,r){var o=this;return this.stopTracking?e.prototype.parse.call(this,t,n,a,i,r):(this.trackStats(a,"Asked"),e.prototype.parse.call(this,t,n,a,function(){return o.trackStats(a,"Fetched"),i()},r).finally(function(){return o.trackStats(a,"Waited")}))},t.prototype.stop=function(){return this.stopTracking=!0,this.stats},t}(he);function Ve(e,t,n,a){var i,r,o=null==e?void 0:e.trackType;if(o&&n&&a&&t&&("video"===o||"audio"===o)){var s=(null!==(i=null==a?void 0:a.currentTime)&&void 0!==i?i:0)+(null!==(r=g(t))&&void 0!==r?r:0)/1e3,c="video"===o?null==n?void 0:n.getBufferedInfo().video:null==n?void 0:n.getBufferedInfo().audio;return c.length>0?c[0].end>s:void 0}}var ze=function(e){function t(t,n){var a=e.call(this,n)||this;return a.videoManifestPostBody=t,a}return(0,a.__extends)(t,e),t.prototype.parse=function(t,n,a,i,r){if(a!==f().net.NetworkingEngine.RequestType.MANIFEST||function(e){var t,n=new URL(e),a=!0;return((null===(t=v.killswitches)||void 0===t?void 0:t.isQspRenameEnabled)?["atid","atct","atad","atl"]:["audioTrackId","audioTrackCTag","audioTrackIsAudioDescription","audioTrackLocale"]).forEach(function(e){n.searchParams.get(e)||(a=!1)}),a}(t))return e.prototype.parse.call(this,t,n,a,i,r);var o={headers:n.headers,method:"POST"};return o.body=this.videoManifestPostBody,ye(t,i,r,void 0,fetch(t,o))},t}(he),Ge=function(e){function t(t,n){var a=e.call(this,n)||this;return a.resourceTimingManager=t,a}return(0,a.__extends)(t,e),t.prototype.parse=function(t,n,i,r,o){var s=this,c=e.prototype.parse.call(this,t,n,i,r,o);return i!==f().net.NetworkingEngine.RequestType.SEGMENT||c.promise.then(function(e){var t,i=e.status;if(i&&i>=100&&i<400&&(null===(t=v.killswitches)||void 0===t?void 0:t.isResourceTimingTelemetryForAllSegmentsEnabled)){var r=s.getValidatedUrl(null==n?void 0:n.uris[0]);r&&function(e,t,n){if(e&&t&&n){var i=performance.getEntriesByName(e);if((null==i?void 0:i.length)>0){var r=i[i.length-1],o=n.createRawResourceTimeEvent(r,function(e,t){var n=(0,d.a)(e),i=null==t?void 0:t.headers,r=i["x-azure-ref-originshield"];return(0,a.__assign)({resourceAlias:"Media"===(null==n?void 0:n.part)?"MediaSegment":"InitSegment",isCdnCacheHit:"TCP_HIT"===i["x-cache"]||"TCP_REMOTE_HIT"===i["x-cache"],cacheState:i["x-cache"],correlationId:i["x-correlationid"],responseStatus:200,afdRefId:i["x-msedge-ref"],originshieldAfdRefId:r,start:t.timeMs,additionalInfo:n},i)}(e,t));n.logResourceTiming("SegmentRequestTiming",o)}}}(r,e,s.resourceTimingManager)}}),c},t.prototype.getValidatedUrl=function(e){if(e)try{return new URL(e).toString()}catch(e){}},t}(he),Ke=function(){function e(){var e=this;this.logger=h("ShakaOnePlayerEngine"),this.error=new r.a(void 0),this.playbackReady=new r.a(void 0),this.bufferingTracker=new r.a(void 0),this.availablePlaybackTracks=new r.a([]),this.availableTrackVariants=new r.a([]),this.playbackTrack=new r.a(void 0),this.currentTrackVariant=new r.a(void 0),this.engineStats=new r.a(void 0),this.responseTelemetryInfo=new r.a(void 0),this.isAltTrackReady=new r.a(!1),this.engineState=new r.a(void 0),this.manifestResponseHeaders=new r.a(void 0),this.cdnMode=new r.a(void 0),this.hasReachedPlaybackReadyState=!1,this.hasCurrentEngineReachedPlaybackReadyState=!1,this.isEngineUnloaded=!1,this.bufferingEverEnded=!1,this.startupBufferWatcherActive=!1,this.loggerEnabled=!1,this.startTime=0,this.renderVideo=function(t,n){return(0,a.__awaiter)(e,void 0,void 0,function(){var e,i,r,o,s,c,d;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return e=Array.isArray(t)?t[0]:t,f().polyfill.installAll(),f().Player.isBrowserSupported()?[4,this.loadPlayer(e,n)]:[3,6];case 1:if(a.sent(),i=null===(s=v.killswitches)||void 0===s?void 0:s.isPlayStateCheckForEngineInitEnabled,r=!this.isPreservePlayStateOnSwitchTrackEnabled||void 0===this.isPlayingBeforeFallback,!(this.autoplay&&r||i&&this.isPlayingBeforeFallback)||this.disposed)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,null===(d=null===(c=this.player)||void 0===c?void 0:c.getMediaElement())||void 0===d?void 0:d.play()];case 3:return a.sent(),[3,5];case 4:return o=a.sent(),this.isAutoplayError(o)?(this.raiseAutoPlayErrorEvent(),[2]):[3,5];case 5:return[3,7];case 6:this.logger.error("renderVideo","Browser not supported"),a.label=7;case 7:return[2]}})})},this.getBandwidthStats=function(){var t;return(null===(t=e.bandwidthStatsProvider)||void 0===t?void 0:t.getBandwidthStats())||{}},this.loadPlayer=function(t,n){return(0,a.__awaiter)(e,void 0,void 0,function(){var e,i,r,o,s,c,d,l,u,f,p;return(0,a.__generator)(this,function(m){switch(m.label){case 0:return m.trys.push([0,7,,8]),this.cdnProvider=function(e,t,n,i,r,o,s,c,d,l){if(!s)throw new Error("Player is not initialized, Illegal argument");var u=function(e,t,n,i,r,o){var s=new URL(e),c=void 0,d=s.searchParams.get("enableCdn"),l=s.searchParams.get("hybridPlayback"),u=i?"1"===d&&"true"!==l:"1"===d&&!l,f="1"===d&&"true"===l,p=!d;if(r&&(null==o||o.info("chooseCdnOption","citing manifest cdn qsps to decide mode: hybridQSP=".concat(l,", cdnQSP=").concat(d))),u?c="CdnOnly":f?c="Hybrid":p&&(c="Origin"),void 0===c)throw new Error("Unable to make Cdn Selection with Manifest Qsps used");return t.value=(0,a.__assign)((0,a.__assign)({},t.value),{isCdnRequested:"1"===s.searchParams.get("enableCdn")}),n.value=c,c}(r,t,n,null==d?void 0:d.isHybridQspCheckFixEnabled,null==d?void 0:d.isCdnQspLogsEnabled,l);return"CdnOnly"===u?new Z({player:s,cdnKey:o,keyAcquirePrefetch:null==c?void 0:c.contentProtectionKey,error:e,engineStats:t}):"Hybrid"===u?(null==d?void 0:d.isHybridCdnRefactorEnabled)?new oe({player:s,keyAcquirePrefetch:null==c?void 0:c.contentProtectionKey,error:e,playbackReady:i,engineStats:t}):new se({player:s,keyAcquirePrefetch:null==c?void 0:c.contentProtectionKey,error:e,playbackReady:i,engineStats:t}):void 0}(this.error,this.engineStats,this.cdnMode,this.playbackReady,t,this.providedContentProtectionKey,this.player,n,v.killswitches,this.logger),this.cdnProvider?this.cdnProvider instanceof se?[3,2]:[4,this.cdnProvider.init()]:[3,2];case 1:m.sent(),m.label=2;case 2:return n?[4,null===(r=this.startupResourceManager)||void 0===r?void 0:r.registerResourceWithPrefetch(n)]:[3,4];case 3:return(e=m.sent())&&(this.engineStats.value=y({},e,this.engineStats.value)),[3,5];case 4:null===(o=this.startupResourceManager)||void 0===o||o.reset(),((null===(s=v.killswitches)||void 0===s?void 0:s.isAbrManagerUsedWithoutPrefetch)&&(null===(c=v.killswitches)||void 0===c?void 0:c.isAvoidLowQualityEnabled)||(null===(d=v.killswitches)||void 0===d?void 0:d.isFallbackParallelFetchEnabled))&&this.player&&(null===(l=this.startupResourceManager)||void 0===l||l.registerResourcesWithoutPrefetch()),m.label=5;case 5:return this.engineStats.value=(0,a.__assign)((0,a.__assign)({},this.engineStats.value),{qualityUpgradeFactor:null===(u=this.heuristicSettings)||void 0===u?void 0:u.qualityUpgradeFactor,qualityDowngradeFactor:null===(f=this.heuristicSettings)||void 0===f?void 0:f.qualityDowngradeFactor}),[4,null===(p=this.player)||void 0===p?void 0:p.load(t,this.startTime,"application/dash+xml")];case 6:return m.sent(),[3,8];case 7:return i=m.sent(),this.logger.error("loadPlayer","Unexpected error while loading player",i),this.httpErrRetryConfigurator&&this.httpErrRetryConfigurator.tryUpdateIsFalbackFromHttpError(i),this.disposed||this.onPlayerError(i),[3,8];case 8:return[2]}})})},this.playingListner=function(){var t;(null===(t=e.stalled)||void 0===t?void 0:t.value)&&(e.stalled.value=!1)},this.playerSegmentAppendedListener=function(t){var n,i,r,o="",s=void 0,c=JSON.stringify(null===(r=null===(i=null===(n=e.player)||void 0===n?void 0:n.getBufferedInfo)||void 0===i?void 0:i.call(n))||void 0===r?void 0:r.total);o!==c&&(o=c,s=Date.now(),e.engineStats.value=(0,a.__assign)((0,a.__assign)({},e.engineStats.value),{lastProgressTimestamp:s}))},this.playerErrorListener=function(t){var n,a,i=t;(null===(n=v.killswitches)||void 0===n?void 0:n.isRetryStreamingOnNetErrEnabled)&&(null==i?void 0:i.detail)instanceof f().util.Error&&(null===(a=e.httpErrRetryConfigurator)||void 0===a?void 0:a.onShakaError(null==i?void 0:i.detail))||((null==i?void 0:i.detail)instanceof f().util.Error||(null==i?void 0:i.detail)instanceof Error)&&e.onPlayerError(i.detail)},this.playerUnloadingListener=function(){e.isEngineUnloaded=!0},this.playerBufferingListener=function(t){var n=t;if(!e.isEngineUnloaded&&(e.bufferingEverEnded||(null==n?void 0:n.buffering)||(e.bufferingEverEnded=!0),e.isPlaybackReady(n)?e.triggerPlaybackReady():e.hasReachedPlaybackReadyState&&(e.engineStats.value=y({},e.getEngineBufferingStats(),e.engineStats.value),e.bufferingTracker.value={isBuffering:n.buffering}),"PLAYER_READY"!==e.engineState.value)){var a=!n.buffering;a&&e.checkPlaybackReadyPolicy("isPlaybackReady",a)&&(e.engineState.value="PLAYER_READY")}},this.playerTracksChangedListener=function(){e.updateAvailableTracks(),e.updateAvailableTrackVariants()},this.playerStreamingListener=function(){var t;e.streamingStarted=!0,(null===(t=v.killswitches)||void 0===t?void 0:t.isPreferredLabelConfigEnabled)||e.defaultTrackLanguage||e.defaultTrackRole||e.trySwitchTrack(e.playbackTrack.value)},this.playerDownloadFailedListener=function(t){var n,i,r,o,s,c,u,f;null===(n=e.httpErrRetryConfigurator)||void 0===n||n.onDownloadFailed(t.error);var p=t,m=p.httpResponseCode,_=null===(i=p.request)||void 0===i?void 0:i.headers,h=w(null===(r=null==p?void 0:p.request)||void 0===r?void 0:r.uris[0]);if(h&&!e.shouldStopLoggingResourceTelemetry())if("0"===_.requestType)null===(o=e.resourceTimingManager)||void 0===o||o.registerAugmentedRequestInfo("DashManifestFetch",(0,a.__assign)({resourceAlias:"DashManifestFetch"},_));else if("1"===_.requestType){var b=(0,d.a)(h),g=(0,a.__assign)({resourceAlias:"Media"===(null==b?void 0:b.part)?"MediaSegment":"InitSegment",isCdnCacheHit:"TCP_HIT"===_["x-cache"]||"TCP_REMOTE_HIT"===_["x-cache"],cacheState:_["x-cache"],correlationId:_["x-correlationid"],responseStatus:m,afdRefId:_["x-msedge-ref"],start:p.timeStamp,additionalInfo:b},_);if(null===(s=v.killswitches)||void 0===s?void 0:s.isBlockingStartupColumnAdded){var y=!Ve(b,null===(c=e.heuristicSettings)||void 0===c?void 0:c.rebufferingGoalInMs,e.player,e.videoElement);g.isBlockingStartup=y}var S=(null===(u=v.killswitches)||void 0===u?void 0:u.isResourceTimingSegmentMissingInfoFixEnabled)?(0,l.a)(h):h;null===(f=e.resourceTimingManager)||void 0===f||f.registerAugmentedRequestInfo(S,g)}},this.playerDownloadHeadersReceivedListener=function(t){var n,i,r,o,s,c,u,p,m=t,_=null==m?void 0:m.headers;m.requestType===f().net.NetworkingEngine.RequestType.MANIFEST&&(e.manifestResponseHeaders.value=_);var h=null===(n=null==m?void 0:m.request)||void 0===n?void 0:n.uris[0];_&&h&&(e.responseTelemetryInfo.value={headers:_,url:h}),null===(i=e.httpErrRetryConfigurator)||void 0===i||i.onResponseReceived();var b=w(null===(r=null==m?void 0:m.request)||void 0===r?void 0:r.uris[0]);if(b&&!e.shouldStopLoggingResourceTelemetry())if(m.requestType===f().net.NetworkingEngine.RequestType.MANIFEST)null===(o=e.resourceTimingManager)||void 0===o||o.registerAugmentedRequestInfo("DashManifestFetch",(0,a.__assign)({resourceAlias:"DashManifestFetch"},_));else if(m.requestType===f().net.NetworkingEngine.RequestType.SEGMENT){var g=(0,d.a)(b),y=_["x-azure-ref-originshield"],S=(0,a.__assign)({resourceAlias:"Media"===(null==g?void 0:g.part)?"MediaSegment":"InitSegment",isCdnCacheHit:"TCP_HIT"===_["x-cache"]||"TCP_REMOTE_HIT"===_["x-cache"],cacheState:_["x-cache"],correlationId:_["x-correlationid"],responseStatus:200,afdRefId:_["x-msedge-ref"],originshieldAfdRefId:y,start:m.timeStamp,additionalInfo:g},_);if(null===(s=v.killswitches)||void 0===s?void 0:s.isBlockingStartupColumnAdded){var D=!Ve(g,null===(c=e.heuristicSettings)||void 0===c?void 0:c.rebufferingGoalInMs,e.player,e.videoElement);S.isBlockingStartup=D}var I=(null===(u=v.killswitches)||void 0===u?void 0:u.isResourceTimingSegmentMissingInfoFixEnabled)?(0,l.a)(b):b;null===(p=e.resourceTimingManager)||void 0===p||p.registerAugmentedRequestInfo(I,S)}},this.playerStallDetectedListener=function(){e.stalled&&!1===e.stalled.value&&(e.stalled.value=!0)},this.bufferProgressWatcher=function(){var t=!e.hasReachedPlaybackReadyState&&e.bufferingEverEnded;t?e.checkPlaybackReadyPolicy("bufferProgressWatcher",t)&&e.triggerPlaybackReady():e.hasReachedPlaybackReadyState&&e.startupBufferWatcherActive&&e.removeStartupBufferWatcher()},this.removeStartupBufferWatcher=function(){var t;e.startupBufferWatcherActive&&(e.startupBufferWatcherActive=!1,null===(t=e.videoElement)||void 0===t||t.removeEventListener("progress",e.bufferProgressWatcher))},this.updatePrePlaybackReadyStats=function(t){var n,a=y({},{readyState:null===(n=e.videoElement)||void 0===n?void 0:n.readyState,isAvSynced:t},e.engineStats.value);e.engineStats.value=a}}return e.prototype.initialize=function(e){var t,n,i,r,o,s,c,d,l,u,p,_,b;return(0,a.__awaiter)(this,void 0,void 0,function(){var y,S=this;return(0,a.__generator)(this,function(a){var D;return this.dashConfig=e.dashPlaybackConfig,this.heuristicSettings=e.heuristicSettings,this.loggerEnabled=void 0!==e.loggerFactory,this.loggerEnabled&&(D=e.loggerFactory,m=D),this.isEngineUnloaded=!1,this.startupBufferWatcherActive=!1,v.killswitches=e.killswitches,this.logger=h("ShakaOnePlayerEngine"),this.defaultTrackLabel=null!==(t=e.defaultTrackLabel)&&void 0!==t?t:null===(n=e.dashPlaybackConfig)||void 0===n?void 0:n.defaultTrackLabel,this.defaultTrackLanguage=e.defaultTrackLanguage,this.defaultTrackRole=e.defaultTrackRole,this.defaultTrackVariantParams=this.defaultTrackLanguage&&this.defaultTrackRole?e.defaultTrackVariantParams:void 0,this.currentTrackVariant.value=this.defaultTrackVariantParams?void 0:{label:e.defaultTrackLabel},this.playbackTrack.value=this.defaultTrackVariantParams?void 0:e.defaultTrackLabel,this.videoElement=e.videoElement,this.player=new(f().Player)(e.videoElement),y=(null===(i=v.killswitches)||void 0===i?void 0:i.isVideoQualityAudioTrackFixEnabled)?this.currentTrackVariant:this.playbackTrack,this.playbackQualityProvider=new le(this.player,y,null===(r=v.killswitches)||void 0===r?void 0:r.isVideoQualityAudioTrackFixEnabled),this.bandwidthStatsProvider||(this.bandwidthStatsProvider=new ce),this.bandwidthStatsProvider.initialize(this.player,e.defaultTrackLabel,null===(o=v.killswitches)||void 0===o?void 0:o.isRemovingShakaEngineListenersEnabled),e.heuristicSettings&&this.player.configure(this.convertShakaHeuristicSettings(e.heuristicSettings,this.defaultTrackLabel)),this.stalled=e.stalled,this.resourceTimingManager=e.resourceTimingManager,this.setUpPreparser(this.player,null!==(s=e.getRequestParamsAsync)&&void 0!==s?s:void 0,e.dashPlaybackConfig,e.heuristicSettings,e.loadSummaryCalc),this.addEventListeners(e.dashPlaybackConfig),this.autoplay=e.autoplay,this.disposed=!1,this.streamingStarted=!1,void 0!==e.startTimeInSeconds&&(this.startTime=null!==(c=g(e.startTimeInSeconds))&&void 0!==c?c:0),e.altTrackBufferMonitor&&this.videoElement&&this.defaultTrackLabel&&(this.altTrackBufferMonitor=e.altTrackBufferMonitor,null===(d=this.altTrackBufferMonitor)||void 0===d||d.initialize({videoElem:this.videoElement,defaultTrack:null!==(l=this.defaultTrackLabel)&&void 0!==l?l:"",trackReadyObserver:this.isAltTrackReady,isBufferAbovePreroll:function(){return S.isAVBufferInSync(!0)},defaultTrackRole:this.defaultTrackRole,defaultTrackLanguage:this.defaultTrackLanguage})),this.isPreservePlayStateOnSwitchTrackEnabled=null===(u=v.killswitches)||void 0===u?void 0:u.isPreservePlayStateOnSwitchTrackEnabled,this.isPlayingBeforeFallback=null!==(p=e.isPlayingBeforeFallback)&&void 0!==p?p:!!this.isPreservePlayStateOnSwitchTrackEnabled&&void 0,this.isPlaybackTrackSettingFixEnabled=null===(_=v.killswitches)||void 0===_?void 0:_.isPlaybackTrackSettingFixEnabled,this.providedContentProtectionKey=null===(b=e.dashPlaybackConfig)||void 0===b?void 0:b.cdnDecryptionKey,[2]})})},e.prototype.supportsSource=function(e){return"DASH"===e.playbackFormat},e.prototype.getEngineProperties=function(){var e;return{error:this.error,playbackReady:this.playbackReady,bufferingTracker:this.bufferingTracker,availablePlaybackTracks:this.availablePlaybackTracks,playbackTrack:this.playbackTrack,engineStats:this.engineStats,qualityChangeState:null===(e=this.bandwidthStatsProvider)||void 0===e?void 0:e.qualityChangeState,responseTelemetryInfo:this.responseTelemetryInfo,availableTrackVariants:this.availableTrackVariants,isAltTrackReady:this.isAltTrackReady,currentTrackVariant:this.currentTrackVariant,engineState:this.engineState,manifestResponseHeaders:this.manifestResponseHeaders,cdnMode:this.cdnMode}},e.prototype.dispose=function(){var e,t,n,i,r,o,s,c,d,l,u,f,p,_,h,b,g,y,S,D;return(0,a.__awaiter)(this,void 0,void 0,function(){var I,x;return(0,a.__generator)(this,function(a){switch(a.label){case 0:null===(e=this.cdnProvider)||void 0===e||e.dispose(),this.cdnProvider=void 0,this.loggerEnabled&&(m=void 0),this.disposed=!0,this.lazyErrHandlingTimeoutId&&window.clearTimeout(this.lazyErrHandlingTimeoutId),this.instanceId&&(pe.dispose(this.instanceId),null===(t=this.requestHeaderFilter)||void 0===t||t.dispose()),this.error.unsubscribeAll(),this.error.value=void 0,this.playbackReady.unsubscribeAll(),this.bufferingTracker.unsubscribeAll(),this.availableTrackVariants.unsubscribeAll(),this.availableTrackVariants.value=[],this.currentTrackVariant.unsubscribeAll(),this.currentTrackVariant.value=void 0,this.engineState.unsubscribeAll(),this.engineState.value=void 0,(null===(n=v.killswitches)||void 0===n?void 0:n.isPlaybackReadyDisposeFixEnabled)&&(this.hasCurrentEngineReachedPlaybackReadyState=!1),(null===(i=v.killswitches)||void 0===i?void 0:i.isRemovingShakaEngineListenersEnabled)&&this.removeEventListeners(),(I=!!(null===(r=v.killswitches)||void 0===r?void 0:r.isMovingPromisedEngineDisposeToEndEnabled))&&(this.streamingStarted=!1,this.removeStartupBufferWatcher(),null===(o=this.bandwidthStatsProvider)||void 0===o||o.dispose(),this.responseTelemetryInfo.unsubscribeAll(),this.engineStats.unsubscribeAll(),this.engineStats.value=void 0,null===(s=this.httpErrRetryConfigurator)||void 0===s||s.dispose(),null===(c=this.altTrackBufferMonitor)||void 0===c||c.dispose(),this.previousTrackUsed=void 0,(null===(d=v.killswitches)||void 0===d?void 0:d.isEngineMemLeakRemoved)&&(null===(l=this.pbTrackListenerRemover)||void 0===l||l.call(this),this.altTrackBufferMonitor=void 0,null===(u=this.startupResourceManager)||void 0===u||u.reset(),this.startupResourceManager=void 0,null===(f=this.videoElement)||void 0===f||f.removeEventListener("playing",this.playingListner),this.videoElement=void 0),this.manifestResponseHeaders.unsubscribeAll(),this.manifestResponseHeaders.value=void 0),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null===(p=this.player)||void 0===p?void 0:p.destroy()];case 2:return a.sent(),this.logger.info("dispose","Destroyed player"),[3,4];case 3:return x=a.sent(),this.logger.error("dispose","Error destroying player",x),this.onPlayerError(x),[3,4];case 4:return this.player=void 0,I||(this.streamingStarted=!1,this.removeStartupBufferWatcher(),null===(_=this.bandwidthStatsProvider)||void 0===_||_.dispose(),this.responseTelemetryInfo.unsubscribeAll(),this.engineStats.unsubscribeAll(),this.engineStats.value=void 0,null===(h=this.httpErrRetryConfigurator)||void 0===h||h.dispose(),null===(b=this.altTrackBufferMonitor)||void 0===b||b.dispose(),this.previousTrackUsed=void 0,(null===(g=v.killswitches)||void 0===g?void 0:g.isEngineMemLeakRemoved)&&(null===(y=this.pbTrackListenerRemover)||void 0===y||y.call(this),this.altTrackBufferMonitor=void 0,null===(S=this.startupResourceManager)||void 0===S||S.reset(),this.startupResourceManager=void 0,null===(D=this.videoElement)||void 0===D||D.removeEventListener("playing",this.playingListner),this.videoElement=void 0),this.manifestResponseHeaders.unsubscribeAll(),this.manifestResponseHeaders.value=void 0),[2]}})})},e.prototype.availableBitrateQualities=function(){return this.playbackQualityProvider.getQualities()},e.prototype.setDownloadBitrate=function(e){this.playbackQualityProvider.selectPlaybackQuality(e)},e.prototype.trySwitchTrackVariant=function(e,t,n){var a,i,r,o,s,c,d,l=null===(a=v.killswitches)||void 0===a?void 0:a.isEnableNSByDefaultsShakaConfigEnabled;if(this.player&&(l||this.streamingStarted)&&this.playbackReady){if(!t||!e){var u="OriginalAudio";return this.trySwitchTrack(u),null===(i=this.altTrackBufferMonitor)||void 0===i||i.afterTrackSwitched(u),void this.trySetPlayerReadyState()}var f=A(this.availableTrackVariants.value,e,t);void 0!==f&&this.previousTrackUsed!==f.label?(null===(r=this.player)||void 0===r||r.selectAudioLanguage(e,t),this.currentTrackVariant.value={label:null!==(o=f.label)&&void 0!==o?o:"",params:null!=n?n:void 0},this.isPlaybackTrackSettingFixEnabled&&(this.playbackTrack.value=void 0),this.previousTrackUsed=null===(s=this.currentTrackVariant.value)||void 0===s?void 0:s.label,null===(c=this.startupResourceManager)||void 0===c||c.reset(),null===(d=this.altTrackBufferMonitor)||void 0===d||d.afterTrackSwitched(f.label),this.trySetPlayerReadyState()):this.trySetPlayerReadyState()}},e.prototype.isTrackPresent=function(e,t,n){return n?void 0!==function(e,t){return e.find(function(e){return e.label===t})}(this.availableTrackVariants.value,n):t&&e?void 0!==A(this.availableTrackVariants.value,e,t):this.availablePlaybackTracks.value.includes("OriginalAudio")},e.prototype.removeAvailableTrack=function(e){this.availableTrackVariants.value=this.availableTrackVariants.value.filter(function(t){return t.label!==e})},e.prototype.convertShakaHeuristicSettings=function(e,t){var n,a,i,r,o,s,c,d,l,u=g(e.defaultAbrBandwidthMbps),f="";(null===(n=v.killswitches)||void 0===n?void 0:n.isPreferredLabelConfigEnabled)&&(f=null!=t?t:"OriginalAudio"),d=null!==(a=this.defaultTrackLanguage)&&void 0!==a?a:"",l=null!==(i=this.defaultTrackRole)&&void 0!==i?i:"";var p=null===(r=v.killswitches)||void 0===r?void 0:r.isRetryAfterFallbackEnabled,m=(null===(o=this.httpErrRetryConfigurator)||void 0===o?void 0:o.isFalbackFromHttpError)&&p&&e.networkErrorRetry;return{preferredAudioLabel:f,preferredAudioLanguage:d,preferredVariantRole:l,streaming:{bufferingGoal:(g(e.bufferingGoalInMs)||0)/1e3,rebufferingGoal:(g(e.rebufferingGoalInMs)||0)/1e3,bufferBehind:(g(e.bufferBehindInMs)||0)/1e3,retryParameters:{connectionTimeout:g(e.httpTimeoutInMs),stallTimeout:g(e.httpStallTimeoutInMs),maxAttempts:g(e.maxHttpRetries),baseDelay:g(e.httpRetryDelayInMs),backoffFactor:g(e.httpRetryBackoffFactor),fuzzFactor:g(e.httpRetryDelayFuzzFactor,"float")},durationBackoff:0,maxDisabledTime:He()},abr:{defaultBandwidthEstimate:u&&1e6*u||void 0,bandwidthDowngradeTarget:g(e.qualityDowngradeFactor,"float"),bandwidthUpgradeTarget:g(e.qualityUpgradeFactor,"float")},manifest:{retryParameters:{maxAttempts:g(m?null===(s=e.networkErrorRetry)||void 0===s?void 0:s.maxHttpRetries:e.maxHttpRetries),backoffFactor:g(m?null===(c=e.networkErrorRetry)||void 0===c?void 0:c.httpRetryBackoffFactor:e.httpRetryBackoffFactor)}}}},e.prototype.updateAvailableTracks=function(){this.player?this.availablePlaybackTracks.value=Array.from(new Set(this.player.getVariantTracks().filter(function(e){return E(e)}).map(function(e){return e.label}))):this.availablePlaybackTracks.value=[]},e.prototype.updateAvailableTrackVariants=function(){var e;if(this.player){var t=this.player.getVariantTracks().filter(E);if(this.availableTrackVariants.value=Array.from(new Set(t.map(function(e){var t;return JSON.stringify({language:e.language,role:null===(t=e.roles)||void 0===t?void 0:t[0],label:e.label})}))).map(function(e){return JSON.parse(e)}),(null===(e=v.killswitches)||void 0===e?void 0:e.isFallbackDefaultTrackSettingsFixEnabled)||this.defaultTrackVariantParams){var n=t.find(function(e){return e.active&&e.label});n&&this.updateCurrentTrack(n)}}else this.availableTrackVariants.value=[]},e.prototype.addEventListeners=function(e){var t,n,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,y=this;null===(t=this.player)||void 0===t||t.addEventListener("error",this.playerErrorListener),null===(n=this.player)||void 0===n||n.addEventListener("unloading",this.playerUnloadingListener),null===(i=this.player)||void 0===i||i.addEventListener("buffering",this.playerBufferingListener),this.startupBufferWatcherActive||(null===(r=this.videoElement)||void 0===r||r.addEventListener("progress",this.bufferProgressWatcher),this.startupBufferWatcherActive=!0),null===(o=this.player)||void 0===o||o.addEventListener("trackschanged",this.playerTracksChangedListener),(null===(s=v.killswitches)||void 0===s?void 0:s.isEnableNSByDefaultsShakaConfigEnabled)||null===(c=this.player)||void 0===c||c.addEventListener("streaming",this.playerStreamingListener),this.httpErrRetryConfigurator=new Fe(this.player,this.heuristicSettings,function(e){return y.engineStats.value=(0,a.__assign)((0,a.__assign)({},y.engineStats.value),{networkErrorRecoveringRetries:e})},e),null===(d=this.player)||void 0===d||d.addEventListener("downloadfailed",this.playerDownloadFailedListener),null===(l=this.player)||void 0===l||l.addEventListener("downloadheadersreceived",this.playerDownloadHeadersReceivedListener),this.pbTrackListenerRemover=this.playbackTrack.subscribe(function(e){var t;e&&(y.engineState.value||(y.engineState.value="SWITCHING_TRACK"),y.trySwitchTrack(e),null===(t=y.altTrackBufferMonitor)||void 0===t||t.afterTrackSwitched(e),y.trySetPlayerReadyState(!1))}),(null===(u=v.killswitches)||void 0===u?void 0:u.isRemovingShakaEngineListenersEnabled)?null===(f=this.player)||void 0===f||f.addEventListener("segmentappended",this.playerSegmentAppendedListener):(_=this.player,h=this.engineStats,b="",g=void 0,_.addEventListener("segmentappended",function(e){var t,n,i=JSON.stringify(null===(n=null===(t=_.getBufferedInfo)||void 0===t?void 0:t.call(_))||void 0===n?void 0:n.total);b!==i&&(b=i,g=Date.now(),h.value=(0,a.__assign)((0,a.__assign)({},h.value),{lastProgressTimestamp:g}))})),null===(p=this.player)||void 0===p||p.addEventListener("stalldetected",this.playerStallDetectedListener),null===(m=this.videoElement)||void 0===m||m.addEventListener("playing",this.playingListner)},e.prototype.removeEventListeners=function(){var e,t,n,a,i,r,o,s,c,d;null===(e=this.player)||void 0===e||e.removeEventListener("error",this.playerErrorListener),null===(t=this.player)||void 0===t||t.removeEventListener("unloading",this.playerUnloadingListener),null===(n=this.player)||void 0===n||n.removeEventListener("buffering",this.playerBufferingListener),null===(a=this.player)||void 0===a||a.removeEventListener("trackschanged",this.playerTracksChangedListener),(null===(i=v.killswitches)||void 0===i?void 0:i.isEnableNSByDefaultsShakaConfigEnabled)||null===(r=this.player)||void 0===r||r.removeEventListener("streaming",this.playerStreamingListener),null===(o=this.player)||void 0===o||o.removeEventListener("downloadfailed",this.playerDownloadFailedListener),null===(s=this.player)||void 0===s||s.removeEventListener("downloadheadersreceived",this.playerDownloadHeadersReceivedListener),null===(c=this.player)||void 0===c||c.removeEventListener("segmentappended",this.playerSegmentAppendedListener),null===(d=this.player)||void 0===d||d.removeEventListener("stalldetected",this.playerStallDetectedListener)},e.prototype.shouldStopLoggingResourceTelemetry=function(){var e,t;return(null===(e=v.killswitches)||void 0===e?void 0:e.isResourceTimingSegmentMissingInfoFixEnabled)?!!(null===(t=this.resourceTimingManager)||void 0===t?void 0:t.isResourceTelemetryCalculated):this.hasReachedPlaybackReadyState},e.prototype.triggerPlaybackReady=function(){var e;this.playbackReady.value={isPlaybackReady:!0},(null===(e=v.killswitches)||void 0===e?void 0:e.isPlaybackReadyDisposeFixEnabled)&&(this.hasCurrentEngineReachedPlaybackReadyState=!0),this.hasReachedPlaybackReadyState=!0},e.prototype.trySwitchTrack=function(e,t){var n,a,i,r,o=null===(n=v.killswitches)||void 0===n?void 0:n.isEnableNSByDefaultsShakaConfigEnabled;if(e&&this.player&&this.previousTrackUsed!==e&&(o||this.streamingStarted)){if(!o||this.player.getManifest()&&(null===(a=this.player.getVariantTracks())||void 0===a?void 0:a.length)>0){this.previousTrackUsed=e;var s=this.getPreRollBufferInSec();null===(i=this.player)||void 0===i||i.selectVariantsByLabel(e,!0,s),D(function(){return"[trySwitchTrack] selectVariantsByLabel(".concat(e,")")})}else{if(!o||this.previousTrackUsed||e===this.defaultTrackLabel)return;this.player.configure({preferredAudioLabel:e}),this.previousTrackUsed=e,D(function(){return"[trySwitchTrack] shaka.configure(preferredAudioLabel: ".concat(e,")")})}this.currentTrackVariant.value={label:e,params:t},this.playbackTrack.value&&this.defaultTrackLabel&&this.playbackTrack.value!==this.defaultTrackLabel&&(null===(r=this.startupResourceManager)||void 0===r||r.reset())}},e.prototype.onPlayerError=function(e,t){var n,a,r=this;if(!this.disposed&&e)if(e instanceof f().util.Error){var s=function(e){var t,n,a=ke.get(null===(t=e.code)||void 0===t?void 0:t.toString());if(a){if("HTTP_ERROR"===a)return C()?Ae:Le;if("HTTP_STATUS_"!==a)return a;if("HTTP_STATUS_"===a&&(null===(n=e.data)||void 0===n?void 0:n.length)>1)return a+e.data[1]}return"UNKNOWN_ERROR"}(e);if(function(e){return"RESTRICTIONS_CANNOT_BE_MET"===e}(s)&&!t)return void(this.lazyErrHandlingTimeoutId=window.setTimeout(function(){return r.onPlayerError(e,!0)},1e3));e.code===f().util.Error.Code.TIMEOUT&&this.saveTimeoutInformation(e);var c={engine:"Shaka",errorName:s,isFatal:!1,message:Ue(e,s),isHTTPStatusError:s.includes("HTTP_STATUS"),rawData:"UNKNOWN_ERROR"===s?["Code: "+e.code]:null!==(n=this.getRawData(e))&&void 0!==n?n:void 0,isExpected:Te(s)};(null===(a=v.killswitches)||void 0===a?void 0:a.isByteStreamTypeNotSupportedExpectedFixEnabled)&&!c.isExpected&&Pe.find(function(e){return-1!==c.message.indexOf(e)})&&(c.isExpected=!0),this.error.value=c}else{var d=(0,o.a)(e);d.name===i.a?this.error.value={engine:"Shaka",errorName:"GET_REQUEST_PARAMETERS_FAILED",isFatal:!1,message:d.message,isExpected:!1}:this.error.value={engine:"Shaka",errorName:"UNKNOWN_ERROR",isFatal:!1,message:"",rawData:[d.name,d.message],isExpected:!1}}},e.prototype.getRawData=function(e){return function(e){var t;if(null===(t=v.killswitches)||void 0===t?void 0:t.isRawDataDisabled)return[];if(!(e.data&&e.data instanceof Array))return x(e.data);for(var n=[],a=0,i=e.data;a<i.length;a++){var r=i[a];r instanceof Error?n.push(x(r.message)):n.push(x(r))}return n}(e)},e.prototype.isAutoplayError=function(e){return"NotAllowedError"===e.name&&!0===this.autoplay},e.prototype.raiseAutoPlayErrorEvent=function(){var e,t;null===(t=null===(e=this.player)||void 0===e?void 0:e.getMediaElement())||void 0===t||t.dispatchEvent(new Event("autoplayfailed",{cancelable:!0}))},e.prototype.setUpPreparser=function(e,t,n,a,i){var r,o,c=this.statsPreParser=new je;t&&(c=c.nextParser(new Be(t))),this.resourceTimingManager&&(c=c.nextParser(new Ge(this.resourceTimingManager)));var d=new Se;c=c.nextParser(d);var l=null==n?void 0:n.videoManifestPostBody;if(l&&c.nextParser(new ze(l)),this.startupResourceManager=new Ne(e,d,this.playbackReady,this.defaultTrackLabel,null==n?void 0:n.minVideoBandwidth,this.playbackTrack,a,i),null===(r=v.killswitches)||void 0===r?void 0:r.isShakaInstanceIdMapEnabled){this.instanceId=(0,s.a)();var u=null===(o=this.player)||void 0===o?void 0:o.getNetworkingEngine();u&&this.instanceId?(this.requestHeaderFilter=new fe(this.instanceId,u),this.requestHeaderFilter.register(),this.logger.warn("setUpPreparser","registered instanceIdfilter, ".concat(this.instanceId))):this.logger.warn("setUpPreparser","cannot registered instanceIdfilter: NetworkEngine missing")}pe.register(this.statsPreParser,this.instanceId)},e.prototype.isPlaybackReady=function(e){var t,n=!((null===(t=v.killswitches)||void 0===t?void 0:t.isPlaybackReadyDisposeFixEnabled)?this.hasCurrentEngineReachedPlaybackReadyState:this.hasReachedPlaybackReadyState)&&!(null==e?void 0:e.buffering);return!!n&&this.checkPlaybackReadyPolicy("isPlaybackReady",n)},e.prototype.checkPlaybackReadyPolicy=function(e,t){var n,a=this.isAVBufferInSync();this.updatePrePlaybackReadyStats(a);var i=t&&a||!1;return this.logger.debug("checkPlaybackReadyPolicy","[PlaybackReadyWatch] ".concat(e,": avSyncPolicy=").concat(a,",shakaBufferPolicy=").concat(t,",readystate=").concat(null===(n=this.videoElement)||void 0===n?void 0:n.readyState)),i&&(this.logger.debug("checkPlaybackReadyPolicy","[PlaybackReadyWatch] ".concat(e,": playback ready detected")),this.updatePostPlaybackReadyStats()),i},e.prototype.getEngineBufferingStats=function(){var e,t,n=(null===(e=this.player)||void 0===e?void 0:e.getBufferedInfo)&&(null===(t=this.player)||void 0===t?void 0:t.getBufferedInfo());return{audioBufferedMs:1e3*S(null==n?void 0:n.audio[0]),videoBufferedMs:1e3*S(null==n?void 0:n.video[0])}},e.prototype.isAVBufferInSync=function(e){var t;return!(!this.player||!this.videoElement)&&function(e,t,n,a){var i,r,o,s,c,d,l,u,f,p,m=null===(i=e.getManifest())||void 0===i?void 0:i.variants[0],_=e.getBufferedInfo&&e.getBufferedInfo(),h=void 0!==(null===(r=null==m?void 0:m.audio)||void 0===r?void 0:r.id),v=void 0!==(null===(o=null==m?void 0:m.video)||void 0===o?void 0:o.id);if(!v&&!h)throw new Error("unexpected non A/V manifest detected");var y=0,S=(null===(s=null==_?void 0:_.audio[0])||void 0===s?void 0:s.end)||0,D=(null===(c=null==_?void 0:_.video[0])||void 0===c?void 0:c.end)||0,I=!1;return a?(y=(null!==(d=null==t?void 0:t.currentTime)&&void 0!==d?d:0)+(null!==(l=g(n))&&void 0!==l?l:0)/1e3,I=(!h||S>=y)&&(!v||D>=y)):I=(!h||S>0)&&(!v||D>0),a&&(null==b||b.info("isAVBufferInSync","".concat(I,". timepos: ").concat(null!==(u=null==t?void 0:t.currentTime)&&void 0!==u?u:0," ")+"targetime: ".concat(y," ")+"video: ".concat((null===(f=null==_?void 0:_.video[0])||void 0===f?void 0:f.end)||0," "),"audio: ".concat((null===(p=null==_?void 0:_.audio[0])||void 0===p?void 0:p.end)||0))),I}(this.player,this.videoElement,null===(t=this.heuristicSettings)||void 0===t?void 0:t.rebufferingGoalInMs,e)},e.prototype.updatePostPlaybackReadyStats=function(){var e,t=y({},this.getEngineBufferingStats(),this.engineStats.value);t=y({},null===(e=this.statsPreParser)||void 0===e?void 0:e.stop(),t),this.engineStats.value=t},e.prototype.getPreRollBufferInSec=function(){var e,t,n,a=g(null===(e=this.heuristicSettings)||void 0===e?void 0:e.preRollInWallClockMs);return(null===(t=this.videoElement)||void 0===t?void 0:t.playbackRate)&&a?a*(null===(n=this.videoElement)||void 0===n?void 0:n.playbackRate)/1e3:a?a/1e3:0},e.prototype.updateCurrentTrack=function(e){var t,n;if(!(null===(t=v.killswitches)||void 0===t?void 0:t.isFallbackDefaultTrackSettingsFixEnabled)||!e.label||(null===(n=this.currentTrackVariant.value)||void 0===n?void 0:n.label)!==e.label){var a=e.label,i=this.isTrackPresent(void 0,void 0,this.defaultTrackLabel),r=this.currentTrackVariant.value,o={label:a};this.defaultTrackLanguage&&this.defaultTrackRole&&this.defaultTrackVariantParams?function(e,t,n){return e.language.toLowerCase()===t.toLowerCase()&&e.roles.includes(n)}(e,this.defaultTrackLanguage,this.defaultTrackRole)?(o.params=this.defaultTrackVariantParams,this.defaultTrackVariantParams=void 0,this.currentTrackVariant.value=o):(r&&r.label!==a&&this.isTrackPresent(void 0,void 0,r.label)?this.trySwitchTrack(r.label,r.params):a!==this.defaultTrackLabel&&i?this.trySwitchTrack(this.defaultTrackLabel):this.currentTrackVariant.value=o,this.error.value=(0,c.c)("Shaka",this.defaultTrackVariantParams)):this.currentTrackVariant.value=o,this.isPlaybackTrackSettingFixEnabled&&"EnhancedAudio"!==a&&(this.playbackTrack.value=void 0),this.previousTrackUsed=a,this.trySetPlayerReadyState()}},e.prototype.saveTimeoutInformation=function(e){try{if(Array.isArray(e.data)&&e.data.length>=2){var t=new URL(e.data[0]),n=e.data[1];if(t&&n){var a=t.searchParams.get("segmentTime"),i=t.searchParams.get("kid"),r=t.searchParams.get("part"),o=t.searchParams.get("track"),s=t.searchParams.get("quality"),c="1"===t.searchParams.get("enableCdn");this.logger.error("saveTimeoutInformation","A request of type ".concat(n," has failed. SegmentTime: ").concat(a,", Kid: ").concat(i,", Part: ").concat(r,", Track: ").concat(o,", Quality: ").concat(s,", EnableCdn: ").concat(c))}}}catch(e){this.logger.error("saveTimeoutInformation","Unexpected error: ".concat(e))}},e.prototype.trySetPlayerReadyState=function(e){var t,n;void 0===e&&(e=!0),(null===(t=v.killswitches)||void 0===t?void 0:t.isEngineStatePlayerReadyFixEnabled)?((null===(n=v.killswitches)||void 0===n?void 0:n.isPlaybackReadyDisposeFixEnabled)?this.hasCurrentEngineReachedPlaybackReadyState:this.hasReachedPlaybackReadyState)&&(this.engineState.value="PLAYER_READY"):e&&(this.engineState.value="PLAYER_READY")},e}()}
,3766:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a,i=n(0),r=void 0!==(null===(a=window.crypto)||void 0===a?void 0:a.subtle),o={name:"AES-CBC",length:128},s=function(){function e(){if(!r)throw new Error("AESDecryptor is not available in this platform")}return e.isSupported=function(){return r},e.prototype.registerKey=function(e){return window.crypto.subtle.importKey("raw",e,o,!1,["decrypt"])},e.prototype.decrypt=function(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(a){return[2,window.crypto.subtle.decrypt({name:"AES-CBC",iv:n},t,e)]})})},e}()}
}]),define("shakaengine",[],{});